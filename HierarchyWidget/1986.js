"use strict";(self.webpackChunkde_lmw_HierarchyWidget=self.webpackChunkde_lmw_HierarchyWidget||[]).push([[1986],{1986:(e,t,r)=>{r.r(t),r.d(t,{Aggregate:()=>Ir,AggregateColumn:()=>_t,AggregateColumnDirective:()=>f,AggregateColumnsDirective:()=>y,AggregateDirective:()=>c,AggregateRow:()=>Ht,AggregatesDirective:()=>u,Column:()=>w,ColumnChooser:()=>Vr,ColumnDirective:()=>a,ColumnMenu:()=>xr,ColumnsDirective:()=>s,CommandColumn:()=>Mr,ContextMenu:()=>Cr,ContextMenuItems:()=>Dt,DataManipulation:()=>Bt,DetailRow:()=>Or,Edit:()=>Dr,EditSettings:()=>Kt,ExcelExport:()=>mr,Filter:()=>yr,FilterSettings:()=>P,Freeze:()=>qr,InfiniteScroll:()=>Br,InfiniteScrollSettings:()=>ir,Inject:()=>n.Inject,LoadingIndicator:()=>b,Logger:()=>V,Page:()=>vr,PageSettings:()=>jt,PdfExport:()=>Sr,Predicate:()=>O,Render:()=>Vt,Reorder:()=>lr,Resize:()=>pr,RowDD:()=>hr,RowDropSettings:()=>ur,SearchSettings:()=>At,Selection:()=>Mt,SelectionSettings:()=>Ut,Sort:()=>Rr,SortDescriptor:()=>Jt,SortSettings:()=>Xt,StackedColumn:()=>R,StackedColumnDirective:()=>l,StackedColumnsDirective:()=>p,Toolbar:()=>wr,ToolbarItem:()=>bt,TreeClipboard:()=>pt,TreeGrid:()=>ar,TreeGridColumn:()=>I,TreeGridComponent:()=>dr,TreeVirtual:()=>Ur,TreeVirtualRowModelGenerator:()=>fr,VirtualScroll:()=>kr,actionBegin:()=>_,actionComplete:()=>G,ariaColIndex:()=>at,ariaRowIndex:()=>dt,autoCol:()=>Ke,batchAdd:()=>Re,batchCancel:()=>Ie,batchDelete:()=>we,batchEditFormRendered:()=>Be,batchSave:()=>De,beforeBatchAdd:()=>Ce,beforeBatchCancel:()=>Ve,beforeBatchDelete:()=>xe,beforeBatchSave:()=>be,beforeCopy:()=>pe,beforeDataBound:()=>F,beforeExcelExport:()=>X,beforePaste:()=>he,beforePdfExport:()=>$,beforeStartEdit:()=>qe,beginAdd:()=>fe,beginEdit:()=>ge,cellEdit:()=>ve,cellSave:()=>me,cellSaved:()=>Se,checkboxChange:()=>W,collapsed:()=>re,collapsing:()=>ie,content:()=>et,contextMenuClick:()=>le,contextMenuOpen:()=>de,crudAction:()=>ue,dataBound:()=>j,dataColIndex:()=>ot,dataListener:()=>ke,dataRowIndex:()=>st,dataStateChange:()=>H,destroy:()=>Ne,detailDataBound:()=>Te,doubleTap:()=>Pe,expanded:()=>ee,expanding:()=>te,extendArray:()=>It,findChildrenRecords:()=>vt,findParentRecords:()=>mt,frozenContent:()=>$e,frozenHeader:()=>Ze,frozenLeft:()=>nt,frozenRight:()=>it,getExpandStatus:()=>St,getParentData:()=>xt,getPlainData:()=>Rt,headerContent:()=>Ye,indexModifier:()=>Ue,isCheckboxcolumn:()=>ft,isCountRequired:()=>gt,isFilterChildHierarchy:()=>yt,isHidden:()=>Ct,isOffline:()=>wt,isRemoteData:()=>ut,keyPressed:()=>Me,leftRight:()=>rt,load:()=>T,localPagedExpandCollapse:()=>oe,movableContent:()=>Je,movableHeader:()=>Xe,pagingActions:()=>ae,printGridInit:()=>se,queryCellInfo:()=>z,recordDoubleClick:()=>ye,remoteExpand:()=>ne,resizeStop:()=>Z,rowDataBound:()=>L,rowDeselected:()=>Y,rowDeselecting:()=>We,rowDrag:()=>Le,rowDragStart:()=>Fe,rowDragStartHelper:()=>je,rowDrop:()=>ze,rowDropped:()=>Qe,rowSelected:()=>K,rowSelecting:()=>Q,rowdraging:()=>Ge,rowsAdd:()=>_e,rowsRemove:()=>He,savePreviousRowPosition:()=>ce,table:()=>tt,toolbarClick:()=>J,treeGridDetails:()=>B,updateData:()=>Oe,virtualActionArgs:()=>Ae,virtualColumnIndex:()=>Ee});var i,n=r(5313),o=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},i(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.moduleName="column",t.complexTemplate={"filter.itemTemplate":"filter.itemTemplate"},t}(n.ComplexBase),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.propertyName="columns",t.moduleName="columns",t}(n.ComplexBase),d=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.moduleName="stackedColumn",t.complexTemplate={"filter.itemTemplate":"filter.itemTemplate"},t}(n.ComplexBase),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.propertyName="columns",t.moduleName="stackedColumns",t}(n.ComplexBase),h=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.moduleName="aggregate",t}(n.ComplexBase),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.propertyName="aggregates",t.moduleName="aggregates",t}(n.ComplexBase),g=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.moduleName="aggregateColumn",t}(n.ComplexBase),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.propertyName="columns",t.moduleName="aggregateColumns",t}(n.ComplexBase),m=r(5095),S=r(2471),v=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),w=function(){function e(e){this.allowEditing=!0,this.edit={},this.disableHtmlEncode=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.allowFiltering=!0,this.allowSorting=!0,this.allowResizing=!0,this.filter={},(0,S.merge)(this,e)}return e.prototype.setProperties=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)this[t[parseInt(r.toString(),10)]]=e[t[parseInt(r.toString(),10)]],this.parent&&this.parent.isReact&&"template"===t[parseInt(r.toString(),10)]&&this.parent.clipboardModule.treeGridParent.renderModule.refreshReactColumnTemplateByUid(this.uid)},e}(),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([(0,S.Property)(null)],t.prototype,"columns",void 0),t}(w),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t}(I),x=r(2580),C=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([(0,S.Property)("Spinner")],t.prototype,"indicatorType",void 0),t}(S.ChildProperty),D=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),M=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return D(t,e),M([(0,S.Property)()],t.prototype,"field",void 0),M([(0,S.Property)()],t.prototype,"operator",void 0),M([(0,S.Property)()],t.prototype,"value",void 0),M([(0,S.Property)()],t.prototype,"matchCase",void 0),M([(0,S.Property)()],t.prototype,"ignoreAccent",void 0),M([(0,S.Property)()],t.prototype,"predicate",void 0),M([(0,S.Property)({})],t.prototype,"actualFilterValue",void 0),M([(0,S.Property)({})],t.prototype,"actualOperator",void 0),M([(0,S.Property)()],t.prototype,"type",void 0),M([(0,S.Property)()],t.prototype,"ejpredicate",void 0),M([(0,S.Property)()],t.prototype,"uid",void 0),M([(0,S.Property)()],t.prototype,"isForeignKey",void 0),t}(S.ChildProperty),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return D(t,e),M([(0,S.Collection)([],O)],t.prototype,"columns",void 0),M([(0,S.Property)("FilterBar")],t.prototype,"type",void 0),M([(0,S.Property)()],t.prototype,"mode",void 0),M([(0,S.Property)(!0)],t.prototype,"showFilterBarStatus",void 0),M([(0,S.Property)(1500)],t.prototype,"immediateModeDelay",void 0),M([(0,S.Property)()],t.prototype,"operators",void 0),M([(0,S.Property)(!1)],t.prototype,"ignoreAccent",void 0),M([(0,S.Property)("Parent")],t.prototype,"hierarchyMode",void 0),t}(S.ChildProperty),E=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E(t,e),function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([(0,S.Property)("Both")],t.prototype,"wrapMode",void 0),t}(S.ChildProperty),N=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),k="https://ej2.syncfusion.com/documentation/treegrid",U="https://ej2.syncfusion.com/documentation",q=!1,V=function(e){function t(t){return x.Grid.Inject(x.Logger),e.call(this,t)||this}return N(t,e),t.prototype.getModuleName=function(){return"logger"},t.prototype.log=function(e,t){e instanceof Array||(e=[e]);for(var r=e,i=0;i<r.length;i++){var n=x.detailLists[r[parseInt(i.toString(),10)]],o=n.check(t,this.parent);if(o.success){var a=n.generateMessage(t,this.parent,o.options);a=a.replace("EJ2Grid","EJ2TreeGrid").replace("* Hierarchy Grid","").replace("* Grouping",""),q&&"primary_column_missing"===r[parseInt(i.toString(),10)]&&(a=a.replace("Editing","Row DragAndDrop"),q=!1);var s=a.indexOf("https"),d=a.substring(s);"module_missing"===r[parseInt(i.toString(),10)]?a=a.replace(d,k+"/modules"):"primary_column_missing"===r[parseInt(i.toString(),10)]||"selection_key_missing"===r[parseInt(i.toString(),10)]?a=a.replace(d,U+"/api/treegrid/column/#isprimarykey"):"grid_remote_edit"===r[parseInt(i.toString(),10)]?a=a.replace(d,k+"/edit"):"virtual_height"===r[parseInt(i.toString(),10)]?a=a.replace(d,k+"/virtual"):"check_datasource_columns"===r[parseInt(i.toString(),10)]?a=a.replace(d,k+"/columns"):"locale_missing"===r[parseInt(i.toString(),10)]&&(a=a.replace(d,k+"/global-local/#localization")),"datasource_syntax_mismatch"===r[parseInt(i.toString(),10)]&&((0,S.isNullOrUndefined)(this.treeGridObj)||(0,S.isNullOrUndefined)(this.treeGridObj.dataStateChange))||console[n.logType](a)}}},t.prototype.treeLog=function(e,t,r){this.treeGridObj=r,e instanceof Array||(e=[e]);var i=e;r.allowRowDragAndDrop&&!r.columns.filter((function(e){return e.isPrimaryKey})).length&&(q=!0,this.log("primary_column_missing",t));for(var n=0;n<i.length;n++){var o=B[i[parseInt(n.toString(),10)]],a=o.check(t,r);if(a.success){var s=o.generateMessage(t,r,a.options);console[o.logType](s)}}},t}(x.Logger),B={mapping_fields_missing:{type:"mapping_fields_missing",logType:"error",check:function(e,t){var r={success:!1};return((0,S.isNullOrUndefined)(t.idMapping)&&(0,S.isNullOrUndefined)(t.childMapping)&&(0,S.isNullOrUndefined)(t.parentIdMapping)||!(0,S.isNullOrUndefined)(t.idMapping)&&(0,S.isNullOrUndefined)(t.parentIdMapping)||(0,S.isNullOrUndefined)(t.idMapping)&&!(0,S.isNullOrUndefined)(t.parentIdMapping))&&(r={success:!0}),r},generateMessage:function(){return"[EJ2TreeGrid.Error]: MAPPING FIELDS MISSING \nOne of the following fields is missing. It is required for the hierarchical relationship of records in TreeGrid:\n* childMapping\n* idMapping\n* parentIdMapping\nRefer to the following documentation links for more details.\n"+U+"/api/treegrid#childmapping\n"+U+"/api/treegrid#idmapping\n"+U+"/api/treegrid#$parentidmapping"}}},T="load",L="rowDataBound",j="dataBound",z="queryCellInfo",F="beforeDataBound",_="actionBegin",H="dataStateChange",G="actionComplete",Q="rowSelecting",K="rowSelected",W="checkboxChange",Y="rowDeselected",J="toolbarClick",X="beforeExcelExport",$="beforePdfExport",Z="resizeStop",ee="expanded",te="expanding",re="collapsed",ie="collapsing",ne="remoteExpand",oe="localPagedExpandCollapse",ae="pagingActions",se="printGrid-Init",de="contextMenuOpen",le="contextMenuClick",pe="beforeCopy",he="beforePaste",ce="savePreviousRowPosition",ue="crudAction",ge="beginEdit",fe="beginAdd",ye="recordDoubleClick",me="cellSave",Se="cellSaved",ve="cellEdit",we="batchDelete",Ie="batchCancel",Re="batchAdd",xe="beforeBatchDelete",Ce="beforeBatchAdd",be="beforeBatchSave",De="batchSave",Me="key-pressed",Oe="update-data",Pe="double-tap",Ee="virtualColumnIndex",Ae="virtual-action-args",Ne="destroy",ke="data-listener",Ue="index-modifier",qe="edit-form",Ve="before-batch-cancel",Be="batcheditform-rendered",Te="detailDataBound",Le="rowDrag",je="rowDragStartHelper",ze="rowDrop",Fe="rowDragStart",_e="rows-add",He="rows-remove",Ge="row-draging",Qe="row-dropped",Ke="auto-col",We="rowDeselecting",Ye="e-headercontent",Je="e-movablecontent",Xe="e-movableheader",$e="e-frozencontent",Ze="e-frozenheader",et="e-content",tt="e-table",rt="Left-Right",it="frozen-right",nt="frozen-left",ot="data-colindex",at="aria-colindex",st="data-rowindex",dt="aria-rowindex",lt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),pt=function(e){function t(t,r){var i=e.call(this,t.grid,r)||this;return i.treeCopyContent="",i.copiedUniqueIdCollection=[],i.treeGridParent=t,i.serviceLocator=r,i}return lt(t,e),t.prototype.setCopyData=function(t){var r="copyContent",i="getCopyData",n=this.treeGridParent.getCurrentViewRecords();if(""===window.getSelection().toString()){this.clipBoardTextArea.value=this[""+r]="";var o=this.treeGridParent.grid.getRows();if("Cell"!==this.treeGridParent.selectionSettings.mode){for(var a=this.treeGridParent.getSelectedRowIndexes().sort((function(e,t){return e-t})),s=0;s<a.length;s++)if(s>0&&(this.treeCopyContent+="\n"),!o[a[parseInt(s.toString(),10)]].classList.contains("e-summaryrow")){var d=[].slice.call(o[a[parseInt(s.toString(),10)]].querySelectorAll(".e-rowcell")),l=this.treeGridParent.getSelectedRecords()[parseInt(s.toString(),10)].uniqueID;-1===this.copiedUniqueIdCollection.indexOf(l)&&("Parent"!==this.treeGridParent.copyHierarchyMode&&"Both"!==this.treeGridParent.copyHierarchyMode||this.parentContentData(n,a[parseInt(s.toString(),10)],o,t,s),this[""+i](d,!1,"\t",t),this.treeCopyContent+=this[""+r],this.copiedUniqueIdCollection.push(l),this[""+r]="","Child"!==this.treeGridParent.copyHierarchyMode&&"Both"!==this.treeGridParent.copyHierarchyMode||this.childContentData(n,a[parseInt(s.toString(),10)],o,t))}if(t){var p=[];for(s=0;s<this.treeGridParent.getVisibleColumns().length;s++)p[parseInt(s.toString(),10)]=this.treeGridParent.getVisibleColumns()[parseInt(s.toString(),10)].headerText;this[""+i](p,!1,"\t",t),this.treeCopyContent=this[""+r]+"\n"+this.treeCopyContent}var h={data:this.treeCopyContent,cancel:!1};if(this.treeGridParent.trigger(pe,h),h.cancel)return;this.clipBoardTextArea.value=this[""+r]=h.data,S.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0,this.copiedUniqueIdCollection=[],this.treeCopyContent=""}else e.prototype.setCopyData.call(this,t)}},t.prototype.parentContentData=function(e,t,r,i,n){var o="copyContent",a="parentItem",s="uniqueID";if(!(0,S.isNullOrUndefined)(e[parseInt(t.toString(),10)][""+a]))for(var d=e[parseInt(t.toString(),10)][""+a].level,l=0;l<d+1;l++)for(var p=0;p<e.length;p++)if(!(0,S.isNullOrUndefined)(e[parseInt(t.toString(),10)][""+a])&&e[parseInt(p.toString(),10)][""+s]===e[parseInt(t.toString(),10)][""+a][""+s]){t=p;var h=[].slice.call(r[parseInt(t.toString(),10)].querySelectorAll(".e-rowcell")),c=e[parseInt(p.toString(),10)][""+s];if(-1===this.copiedUniqueIdCollection.indexOf(c)){this.getCopyData(h,!1,"\t",i),this.treeCopyContent=n>0?this.treeCopyContent+this[""+o]+"\n":this[""+o]+"\n"+this.treeCopyContent,this.copiedUniqueIdCollection.push(c),this[""+o]="";break}}},t.prototype.copy=function(t){e.prototype.copy.call(this,t)},t.prototype.paste=function(t,r,i){e.prototype.paste.call(this,t,r,i)},t.prototype.getModuleName=function(){return"clipboard"},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t.prototype.childContentData=function(e,t,r,i){var n="copyContent",o="uniqueID";if(e[parseInt(t.toString(),10)].hasChildRecords)for(var a=e[parseInt(t.toString(),10)].childRecords,s=0;s<a.length;s++)for(var d=0;d<e.length;d++)if(!(0,S.isNullOrUndefined)(a[parseInt(s.toString(),10)][""+o])&&e[parseInt(d.toString(),10)][""+o]===a[parseInt(s.toString(),10)][""+o]){if(!(0,S.isNullOrUndefined)(r[parseInt(d.toString(),10)])&&!r[parseInt(d.toString(),10)].classList.contains("e-summaryrow")){var l=[].slice.call(r[parseInt(d.toString(),10)].querySelectorAll(".e-rowcell")),p=e[parseInt(d.toString(),10)][""+o];-1===this.copiedUniqueIdCollection.indexOf(p)&&(this.getCopyData(l,!1,"\t",i),this.treeCopyContent+="\n"+this[""+n],this[""+n]="",this.copiedUniqueIdCollection.push(p),this.childContentData(e,d,r,i))}break}},t}(x.Clipboard),ht=r(6578),ct=r(6816);function ut(e){if(e.dataSource instanceof ct.DataManager){var t=e.dataSource.adaptor;return t instanceof ct.ODataAdaptor||t instanceof ct.WebApiAdaptor||t instanceof ct.WebMethodAdaptor||t instanceof ct.CacheAdaptor||t instanceof ct.UrlAdaptor}return!1}function gt(e){return!(!e.dataSource||!("result"in e.dataSource))}function ft(e){for(var t=0;t<e.columns.length;t++)if(e.columns[parseInt(t.toString(),10)].showCheckbox)return!0;return!1}function yt(e){return!(((0,S.isNullOrUndefined)(e.grid.searchSettings.key)||""===e.grid.searchSettings.key||"Child"!==e.searchSettings.hierarchyMode&&"None"!==e.searchSettings.hierarchyMode)&&(!e.allowFiltering||!e.grid.filterSettings.columns.length||"Child"!==e.filterSettings.hierarchyMode&&"None"!==e.filterSettings.hierarchyMode))}function mt(e){for(var t=[],r=0,i=Object.keys(e).length;r<i;r++)(0,x.getObject)("hasChildRecords",e[parseInt(r.toString(),10)])&&t.push(e[parseInt(r.toString(),10)]);return t}function St(e,t,r){var i,n=(0,S.isNullOrUndefined)(t.parentItem)?null:xt(e,t.parentItem.uniqueID);return null==n||(!e.initialRender||(0,S.isNullOrUndefined)(n[e.expandStateMapping])||n[e.expandStateMapping]?!1!==n.expanded&&(!n.parentItem||((i=xt(e,n.parentItem.uniqueID))&&e.initialRender&&!(0,S.isNullOrUndefined)(i[e.expandStateMapping])&&!i[e.expandStateMapping]?(i.expanded=!1,!1):(!i||!1!==i.expanded)&&(!i||St(e,i,r)))):(n.expanded=!1,!1))}function vt(e){var t=[];if((0,S.isNullOrUndefined)(e)||!e.hasChildRecords&&!(0,S.isNullOrUndefined)(e.childRecords)&&!e.childRecords.length)return[];if(!(0,S.isNullOrUndefined)(e.childRecords))for(var r=e.childRecords.filter((function(e){return!e.isSummaryRow})),i=0,n=Object.keys(r).length;i<n;i++)t.push(r[parseInt(i.toString(),10)]),(r[parseInt(i.toString(),10)].hasChildRecords||!(0,S.isNullOrUndefined)(r[parseInt(i.toString(),10)].childRecords)&&r[parseInt(i.toString(),10)].childRecords.length)&&(t=t.concat(vt(r[parseInt(i.toString(),10)])));return t}function wt(e){if(ut(e)){var t=e.dataSource;return!(0,S.isNullOrUndefined)(t.ready)}return!0}function It(e){for(var t,r,i=[],n=0;e&&n<e.length;n++){r=Object.keys(e[parseInt(n.toString(),10)]),t={};for(var o=0;o<r.length;o++)t[r[parseInt(o.toString(),10)]]=e[parseInt(n.toString(),10)][r[parseInt(o.toString(),10)]];i.push(t)}return i}function Rt(e){return delete e.hasChildRecords,delete e.childRecords,delete e.index,delete e.parentItem,delete e.level,delete e.taskData,delete e.uniqueID,e}function xt(e,t,r){return r?e.uniqueIDFilterCollection[""+t]:e.uniqueIDCollection[""+t]}function Ct(e){var t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility}var bt,Dt,Mt=function(){function e(e){this.parent=e,this.selectedItems=[],this.selectedIndexes=[],this.filteredList=[],this.searchingRecords=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"selection"},e.prototype.addEventListener=function(){this.parent.on("dataBoundArg",this.headerCheckbox,this),this.parent.on("columnCheckbox",this.columnCheckbox,this),this.parent.on("updateGridActions",this.updateGridActions,this),this.parent.grid.on("colgroup-refresh",this.headerCheckbox,this),this.parent.on("checkboxSelection",this.checkboxSelection,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("dataBoundArg",this.headerCheckbox),this.parent.off("columnCheckbox",this.columnCheckbox),this.parent.grid.off("colgroup-refresh",this.headerCheckbox),this.parent.off("checkboxSelection",this.checkboxSelection),this.parent.off("updateGridActions",this.updateGridActions))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.checkboxSelection=function(e){var t,r=(0,x.getObject)("target",e),i=(0,x.parentsUntil)(r,"e-checkbox-wrapper");if(i&&i.querySelectorAll(".e-treecheckselect").length>0){t=i.querySelector('input[type="checkbox"]');var n=[];n.push(r.closest("tr").rowIndex),this.selectCheckboxes(n),this.triggerChkChangeEvent(t,t.nextElementSibling.classList.contains("e-check"),r.closest("tr"))}else if(i&&i.querySelectorAll(".e-treeselectall").length>0&&this.parent.autoCheckHierarchy){var o=!i.querySelector(".e-frame").classList.contains("e-check")&&!i.querySelector(".e-frame").classList.contains("e-stop");this.headerSelection(o),t=i.querySelector('input[type="checkbox"]'),this.triggerChkChangeEvent(t,o,r.closest("tr"))}},e.prototype.triggerChkChangeEvent=function(e,t,r){var i=this.parent.getCurrentViewRecords()[r.rowIndex],n={checked:t,target:e,rowElement:r,rowData:e.classList.contains("e-treeselectall")?this.parent.getCheckedRecords():i};this.parent.trigger(W,n)},e.prototype.getCheckboxcolumnIndex=function(){for(var e,t,r=this.parent.stackedHeader?this.parent.columnModel:this.parent.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].showCheckbox&&(e=r[parseInt(i.toString(),10)].uid);for(var n=this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv").length,o=0;o<n;o++)this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv")[parseInt(o.toString(),10)].getAttribute("e-mappinguid")===e&&(t=o);return t},e.prototype.headerCheckbox=function(){if(this.columnIndex=this.getCheckboxcolumnIndex(),this.columnIndex>-1&&0===this.parent.getHeaderContent().querySelectorAll(".e-treeselectall").length){var e=this.parent.getHeaderContent().querySelectorAll(".e-headercelldiv")[this.columnIndex],t=this.parent.createElement("input",{className:"e-treeselectall",attrs:{type:"checkbox"}});(r=(0,ht.createCheckBox)(this.parent.createElement,!1,{checked:!1,label:" "})).classList.add("e-hierarchycheckbox"),r.insertBefore(t.cloneNode(),r.firstChild),(0,S.isNullOrUndefined)(e)||e.insertBefore(r,e.firstChild),this.parent.autoCheckHierarchy&&this.headerSelection()}else if(this.columnIndex>-1&&this.parent.getHeaderContent().querySelectorAll(".e-treeselectall").length>0){var r,i=(r=this.parent.getHeaderContent().querySelectorAll(".e-checkbox-wrapper")[0]).querySelector(".e-frame").classList.contains("e-check");this.parent.autoCheckHierarchy&&i&&this.headerSelection(i)}},e.prototype.renderColumnCheckbox=function(e){var t=this.parent.createElement("input",{className:"e-treecheckselect",attrs:{type:"checkbox","aria-label":"checkbox"}}),r=e.data;e.cell.classList.add("e-treegridcheckbox"),e.cell.setAttribute("aria-label","checkbox");var i=!(0,S.isNullOrUndefined)(r.checkboxState)&&"uncheck"!==r.checkboxState,n=(0,ht.createCheckBox)(this.parent.createElement,!1,{checked:i,label:" "});if(n.classList.add("e-hierarchycheckbox"),this.parent.allowTextWrap&&(n.querySelector(".e-frame").style.width="18px"),"indeterminate"===r.checkboxState){var o=n.querySelectorAll(".e-frame")[0];(0,S.removeClass)([o],["e-check","e-stop","e-uncheck"]),n.querySelector(".e-frame").classList.add("e-stop")}return n.insertBefore(t.cloneNode(),n.firstChild),n},e.prototype.columnCheckbox=function(e){var t=this.renderColumnCheckbox(e),r=e.cell.querySelector(".e-treecolumn-container");if((0,S.isNullOrUndefined)(r)){var i=this.parent.createElement("span",{className:"e-treecheckbox"}),n=e.cell.innerHTML;e.cell.innerHTML="",i.innerHTML=n;var o=this.parent.createElement("div",{className:"e-treecheckbox-container"});o.appendChild(t),o.appendChild(i),e.cell.appendChild(o)}else e.cell.querySelector(".e-hierarchycheckbox")||r.insertBefore(t,r.querySelectorAll(".e-treecell")[0])},e.prototype.selectCheckboxes=function(e){for(var t=0;t<e.length;t++){var r=this.parent.getCurrentViewRecords()[e[parseInt(t.toString(),10)]],i=xt(this.parent,r.uniqueID),n="uncheck"===(r=i).checkboxState?"check":"uncheck";r.checkboxState=n;for(var o=Object.keys(r),a=0;a<o.length;a++)Object.prototype.hasOwnProperty.call(i,o[parseInt(a.toString(),10)])&&(i[o[parseInt(a.toString(),10)]]=r[o[parseInt(a.toString(),10)]]);this.traverSelection(r,n,!1),this.parent.autoCheckHierarchy&&this.headerSelection()}},e.prototype.traverSelection=function(e,t,r){var i=0;if(this.updateSelectedItems(e,t),!r&&e.parentItem&&this.parent.autoCheckHierarchy&&this.updateParentSelection(e.parentItem),e.childRecords&&this.parent.autoCheckHierarchy){var n=e.childRecords;!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(n=this.getFilteredChildRecords(n)),i=n.length;for(var o=0;o<i;o++)n[parseInt(o.toString(),10)].isSummaryRow||(n[parseInt(o.toString(),10)].hasChildRecords?this.traverSelection(n[parseInt(o.toString(),10)],t,!0):this.updateSelectedItems(n[parseInt(o.toString(),10)],t))}},e.prototype.getFilteredChildRecords=function(e){var t=this;return e.filter((function(e){return t.parent.filterModule.filteredResult.indexOf(e)>-1}))},e.prototype.updateParentSelection=function(e){var t,r=[],i=xt(this.parent,e.uniqueID);i&&i.childRecords&&(r=i.childRecords),!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.parent.autoCheckHierarchy&&(r=this.getFilteredChildRecords(r)),t=r&&r.length;var n=0,o=0;if(!(0,S.isNullOrUndefined)(i)){for(var a=0;a<r.length;a++){var s=xt(this.parent,r[parseInt(a.toString(),10)].uniqueID);(0,S.isNullOrUndefined)(s)||("indeterminate"===s.checkboxState?n++:"check"===s.checkboxState&&o++)}n>0||o>0&&o!==t?i.checkboxState="indeterminate":(0!==o||i.hasFilteredChildRecords&&!(0,S.isNullOrUndefined)(i.hasFilteredChildRecords)||(0,S.isNullOrUndefined)(this.parent.dataResults.actionArgs)||"searching"!==this.parent.dataResults.actionArgs.requestType&&"filtering"!==this.parent.dataResults.actionArgs.requestType||"check"!==i.checkboxState)&&(0===o&&0===n||0===o&&i.hasFilteredChildRecords&&!(0,S.isNullOrUndefined)(this.parent.dataResults.actionArgs)&&("searching"===this.parent.dataResults.actionArgs.requestType||"filtering"===this.parent.dataResults.actionArgs.requestType)&&"check"===i.checkboxState)?i.checkboxState="uncheck":i.checkboxState="check",this.updateSelectedItems(i,i.checkboxState),i.parentItem&&this.updateParentSelection(i.parentItem)}},e.prototype.headerSelection=function(e){var t,r,i=this,n=!1;if(!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0){var o=this.parent.filterModule.filteredResult;0===this.filteredList.length&&(this.filteredList=o),this.parent.grid.searchSettings.key.length?this.searchingRecords=o:this.filteredList!==o?(this.filteredList=o,n=!0):n=!1}if(this.filteredList.length>0&&(this.parent.filterSettings.columns.length||!this.filteredList.length||this.parent.grid.searchSettings.key.length||(this.filteredList=[]),this.searchingRecords.length&&!(0,S.isNullOrUndefined)(e)&&(this.filteredList=this.searchingRecords)),r=!(0,S.isNullOrUndefined)(this.parent.filterModule)&&0===this.parent.filterModule.filteredResult.length&&0===this.parent.getCurrentViewRecords().length&&this.parent.filterSettings.columns.length>0||!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.filteredList.length>0?this.filteredList:this.parent.flatData,r=ut(this.parent)?this.parent.getCurrentViewRecords():r,!(0,S.isNullOrUndefined)(e))for(var a=0;a<r.length;a++)if(e){if("check"===r[parseInt(a.toString(),10)].checkboxState)continue;if(n)continue;r[parseInt(a.toString(),10)].checkboxState="check",this.updateSelectedItems(r[parseInt(a.toString(),10)],r[parseInt(a.toString(),10)].checkboxState)}else this.selectedItems.indexOf(r[parseInt(a.toString(),10)])>-1&&(r[parseInt(a.toString(),10)].checkboxState="uncheck",this.updateSelectedItems(r[parseInt(a.toString(),10)],r[parseInt(a.toString(),10)].checkboxState),this.parent.autoCheckHierarchy&&this.updateParentSelection(r[parseInt(a.toString(),10)]));!1===e&&this.parent.enableVirtualization&&(this.selectedItems=[],this.selectedIndexes=[],r.filter((function(e){e.checkboxState="uncheck",i.updateSelectedItems(e,e.checkboxState)}))),t=this.selectedItems.length;var s=this.parent.getHeaderContent().querySelectorAll(".e-frame")[0];t>0&&r.length>0?t===r.length||e?((0,S.removeClass)([s],["e-stop"]),s.classList.add("e-check")):((0,S.removeClass)([s],["e-check"]),s.classList.add("e-stop")):(0,S.removeClass)([s],["e-check","e-stop"])},e.prototype.updateSelectedItems=function(e,t){var r,i,n=this.parent.grid.currentViewData.filter((function(t){return t.uniqueID===e.uniqueID})),o=this.parent.grid.currentViewData.indexOf(n[0]),a=xt(this.parent,e.uniqueID),s=this.parent.getRows()[parseInt(o.toString(),10)];if(o>-1){var d=void 0;(this.parent.frozenRows||this.parent.getFrozenColumns())&&(d=this.parent.getDataRows()[parseInt(o.toString(),10)]),i=s.querySelectorAll(".e-hierarchycheckbox .e-frame")[0]?s.querySelectorAll(".e-hierarchycheckbox .e-frame")[0]:d.querySelectorAll(".e-hierarchycheckbox .e-frame")[0],(0,S.isNullOrUndefined)(i)||(0,S.removeClass)([i],["e-check","e-stop","e-uncheck"])}if(r=a,(0,S.isNullOrUndefined)(r)&&(r=e),r.checkboxState=t,"check"===t&&(0,S.isNullOrUndefined)(e.isSummaryRow))-1!==o&&-1===this.selectedIndexes.indexOf(o)&&this.selectedIndexes.push(o),-1===this.selectedItems.indexOf(r)&&-1!==o&&!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(r),-1===this.selectedItems.indexOf(r)&&(this.parent.enableVirtualization||this.parent.allowPaging)&&!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0&&this.selectedItems.push(r),-1!==this.selectedItems.indexOf(r)||(0,S.isNullOrUndefined)(this.parent.filterModule)||0!==this.parent.filterModule.filteredResult.length||this.selectedItems.push(r),-1===this.selectedItems.indexOf(r)&&(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.selectedItems.push(r);else if(("uncheck"===t||"indeterminate"===t)&&(0,S.isNullOrUndefined)(e.isSummaryRow)){var l=this.selectedItems.indexOf(r);if(-1!==l&&this.selectedItems.splice(l,1),-1!==this.selectedIndexes.indexOf(o)){var p=this.selectedIndexes.indexOf(o);this.selectedIndexes.splice(p,1)}}var h="indeterminate"===t?"e-stop":"e-"+t;o>-1&&!(0,S.isNullOrUndefined)(i)&&(i.classList.add(h),s.querySelector(".e-treecheckselect").setAttribute("aria-checked","check"===t?"true":"uncheck"===t?"false":"mixed"))},e.prototype.updateGridActions=function(e){var t,r,i=this,n=e.requestType;if(ft(this.parent)&&this.parent.autoCheckHierarchy)if("sorting"===n||"paging"===n){var o=this.parent.grid.getRows();r=(t=this.parent.getCurrentViewRecords()).length,this.selectedIndexes=[];for(var a=0;a<r;a++)o[parseInt(a.toString(),10)].classList.contains("e-summaryrow")||this.updateSelectedItems(t[parseInt(a.toString(),10)],t[parseInt(a.toString(),10)].checkboxState)}else if("delete"===n||"add"===e.action){var s=[];for("delete"===n?s=e.data:s.push(e.data),a=0;a<s.length;a++){if("delete"===n){var d=this.parent.flatData.indexOf(s[parseInt(a.toString(),10)]),l=this.selectedIndexes.indexOf(d);this.selectedIndexes.splice(l,1),this.updateSelectedItems(s[parseInt(a.toString(),10)],"uncheck")}(0,S.isNullOrUndefined)(s[parseInt(a.toString(),10)].parentItem)||this.updateParentSelection(s[parseInt(a.toString(),10)].parentItem)}}else"add"===e.requestType&&this.parent.autoCheckHierarchy?e.data.checkboxState="uncheck":("filtering"===n||"searching"===n||"refresh"===n&&!ut(this.parent))&&(this.selectedItems=[],this.selectedIndexes=[],(t=!(0,S.isNullOrUndefined)(this.parent.filterModule)&&this.parent.filterModule.filteredResult.length>0?this.parent.filterModule.filteredResult:this.parent.flatData).forEach((function(e){if(i.parent.enableVirtualization){e.hasChildRecords&&e.childRecords.length>0?i.updateParentSelection(e):i.updateSelectedItems(e,e.checkboxState);var t=vt(e);t=i.getFilteredChildRecords(t);for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)].hasChildRecords?i.updateParentSelection(t[parseInt(r.toString(),10)]):t[parseInt(r.toString(),10)].hasChildRecords||(0,S.isNullOrUndefined)(t[parseInt(r.toString(),10)])||i.updateSelectedItems(t[parseInt(r.toString(),10)],t[parseInt(r.toString(),10)].checkboxState)}else e.hasChildRecords?i.updateParentSelection(e):i.updateSelectedItems(e,e.checkboxState)})),this.headerSelection())},e.prototype.getCheckedrecords=function(){return this.selectedItems},e.prototype.getCheckedRowIndexes=function(){return this.selectedIndexes},e}(),Ot=function(){function e(e){this.parent=e,x.Grid.Inject(x.Print),this.addEventListener()}return e.prototype.getModuleName=function(){return"print"},e.prototype.addEventListener=function(){this.parent.grid.on(se,this.printTreeGrid,this)},e.prototype.removeEventListener=function(){this.parent.grid.off(se,this.printTreeGrid)},e.prototype.printTreeGrid=function(e){var t=(0,x.getObject)("printgrid",e),r=(0,x.getObject)("element",e);t.addEventListener(z,this.parent.grid.queryCellInfo),t.addEventListener(L,this.parent.grid.rowDataBound),t.addEventListener(F,this.parent.grid.beforeDataBound),(0,S.addClass)([r],"e-treegrid")},e.prototype.print=function(){this.parent.grid.print()},e.prototype.destroy=function(){this.removeEventListener()},e}(),Pt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Et=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pt(t,e),Et([(0,S.Property)()],t.prototype,"fields",void 0),Et([(0,S.Property)(!1)],t.prototype,"ignoreCase",void 0),Et([(0,S.Property)("contains")],t.prototype,"operator",void 0),Et([(0,S.Property)()],t.prototype,"key",void 0),Et([(0,S.Property)()],t.prototype,"hierarchyMode",void 0),t}(S.ChildProperty),Nt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),kt=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),kt([(0,S.Property)("Row")],t.prototype,"mode",void 0),kt([(0,S.Property)("Flow")],t.prototype,"cellSelectionMode",void 0),kt([(0,S.Property)("Single")],t.prototype,"type",void 0),kt([(0,S.Property)(!1)],t.prototype,"persistSelection",void 0),kt([(0,S.Property)("Default")],t.prototype,"checkboxMode",void 0),kt([(0,S.Property)(!1)],t.prototype,"checkboxOnly",void 0),kt([(0,S.Property)(!0)],t.prototype,"enableToggle",void 0),t}(S.ChildProperty),qt=r(995),Vt=function(){function e(e){this.parent=e,this.templateResult=null,this.parent.grid.on("template-result",this.columnTemplateResult,this),this.parent.grid.on("reactTemplateRender",this.reactTemplateRender,this)}return e.prototype.RowModifier=function(e){if(e.data){var t=e.data,r=t.parentItem;if(!(0,S.isNullOrUndefined)(t.parentItem)&&!yt(this.parent)&&(!this.parent.allowPaging||"Root"===this.parent.pageSettings.pageSizeMode||ut(this.parent)&&!wt(this.parent))&&(this.parent.initialRender&&(!(0,S.isNullOrUndefined)(r[this.parent.expandStateMapping])&&!r[this.parent.expandStateMapping]||this.parent.enableCollapseAll)||!St(this.parent,e.data,this.parent.grid.getCurrentViewRecords()))&&!(0,S.isNullOrUndefined)(e.row)){e.row.style.display="none";var i=this.parent.grid.getRowsObject();this.parent.grid.isFrozenGrid()||(0,S.isNullOrUndefined)(e.row.getAttribute("data-uid"))||(i.filter((function(t){return t.uid===e.row.getAttribute("data-uid")}))[0].visible=!1)}if(ut(this.parent)&&!wt(this.parent)){var n=this.parent,o=this.parent.getCurrentViewRecords().filter((function(e){return(0,S.getValue)(n.idMapping,e)===(0,S.getValue)(n.parentIdMapping,t)}));if(o.length>0&&!o[0].isSummaryRow&&!(0,S.isNullOrUndefined)(e.row)){var a=o[0].expanded?"table-row":"none";e.row.setAttribute("style","display: "+a+";")}}if((0,x.getObject)("isSummaryRow",e.data)&&(0,S.addClass)([e.row],"e-summaryrow"),(0,S.isNullOrUndefined)(e.row)||(e.row.querySelector(".e-treegridexpand")?e.row.setAttribute("aria-expanded","true"):e.row.querySelector(".e-treegridcollapse")&&e.row.setAttribute("aria-expanded","false"),this.parent.enableCollapseAll&&this.parent.initialRender&&((0,S.isNullOrUndefined)(t.parentItem)||(e.row.style.display="none"))),this.parent.rowDragAndDropModule&&this.parent.grid.rowDragAndDropModule&&(this.parent.grid.rowDragAndDropModule.dragStartData||this.parent.rowDragAndDropModule.draggedRecord)&&this.parent.getContentTable().scrollHeight<=this.parent.getContent().clientHeight&&(this.parent.getVisibleRecords()[this.parent.getVisibleRecords().length-1].uniqueID!==e.data.uniqueID||(0,S.isNullOrUndefined)(e.row)||e.row.cells[0].classList.contains("e-lastrowcell")||this.parent.lastRowBorder(e.row,!0)),this.parent.isReact){var s=this;s.parent.renderReactTemplates((function(){s.parent.trigger(L,e)}))}else this.parent.trigger(L,e)}},e.prototype.cellRender=function(e){if(e.data){var t,r,i=this.parent.grid,n=e.data,o=(0,S.isNullOrUndefined)(n.filterLevel)?n.level:n.filterLevel,a=0,s=this.parent.getColumnByUid(e.column.uid),d=n.isSummaryRow,l=this.parent.getFrozenColumns();if(t=(0,S.isNullOrUndefined)(n.parentItem)?n.index:n.parentItem.index,(this.parent.enableColumnVirtualization&&!this.parent.initialRender?this.parent.getVirtualColIndexByUid(e.column.uid):i.getColumnIndexByUid(e.column.uid))!==this.parent.treeColumnIndex||"add"!==e.requestType&&"rowDragAndDrop"!==e.requestType&&"delete"!==e.requestType&&!(0,S.isNullOrUndefined)(e.cell.querySelector(".e-treecell")))this.templateResult&&(this.templateResult=null);else{for(var p=(0,S.createElement)("div",{className:"e-treecolumn-container"}),h=(0,S.createElement)("span",{className:"e-icons e-none",styles:"width: 10px; display: inline-block"}),c=0;c<o;c++)a+=10,p.appendChild(h.cloneNode());var u=(0,S.isNullOrUndefined)(n.hasFilteredChildRecords)?n.hasChildRecords:n.hasFilteredChildRecords;if(u&&!(0,S.isNullOrUndefined)(n.childRecords)&&(u=this.parent.isFromGantt&&!this.parent.loadChildOnDemand?n.hasChildRecords:!(0===n.childRecords.length)),u){(0,S.addClass)([e.cell],"e-treerowcell"),e.cell.setAttribute("aria-expanded",n.expanded?"true":"false");var g,f=(0,S.createElement)("span",{className:"e-icons"});g=this.parent.initialRender?n.expanded&&((0,S.isNullOrUndefined)(n[this.parent.expandStateMapping])||n[this.parent.expandStateMapping])&&!this.parent.enableCollapseAll:!(!n.expanded||!St(this.parent,n,this.parent.grid.getCurrentViewRecords())),(0,S.addClass)([f],g?"e-treegridexpand":"e-treegridcollapse"),a+=18,p.appendChild(f),h.style.width="4px",a+=7,p.appendChild(h.cloneNode())}else(o||!o&&!n.level)&&(a+=20,p.appendChild(h.cloneNode()),p.appendChild(h.cloneNode()));r=(0,S.createElement)("span",{className:"e-treecell"}),this.parent.allowTextWrap&&(r.style.width="Calc(100% - "+a+"px)"),(0,S.addClass)([e.cell],"e-gridrowindex"+t+"level"+n.level),this.updateTreeCell(e,r),p.appendChild(r),e.cell.appendChild(p)}if(i.getFrozenLeftColumnsCount()>0||i.getFrozenRightColumnsCount()>0){var y=i.getFrozenRightColumns(),m=i.getFrozenLeftColumns(),v=i.getMovableColumns();(y.length>0&&y[0].field===e.column.field||m.length>0&&m[0].field===e.column.field||v.length>0&&v[0].field===e.column.field)&&(0,S.addClass)([e.cell],"e-gridrowindex"+t+"level"+n.level)}else(l>this.parent.treeColumnIndex&&l>0&&i.getColumnIndexByUid(e.column.uid)===l||l<this.parent.treeColumnIndex&&l>0&&(i.getColumnIndexByUid(e.column.uid)===l||i.getColumnIndexByUid(e.column.uid)===l-1)||l===this.parent.treeColumnIndex&&l>0&&i.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex-1)&&(0,S.addClass)([e.cell],"e-gridrowindex"+t+"level"+n.level);if(!(0,S.isNullOrUndefined)(s)&&s.showCheckbox&&(this.parent.notify("columnCheckbox",e),this.parent.allowTextWrap)){var w=e.cell.querySelectorAll(".e-frame")[0];a+=parseInt(w.style.width,16),a+=10,(r=i.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex?e.cell.querySelector(".e-treecell"):e.cell.querySelector(".e-treecheckbox")).style.width="Calc(100% - "+a+"px)"}if(d){(0,S.addClass)([e.cell],"e-summarycell");var I=(0,x.getObject)(e.column.field,e.data);I=(0,S.isNullOrUndefined)(I)?null:I,null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML=I:e.column.template?e.cell.innerHTML=null:e.cell.innerHTML=I}this.parent.args=e,((0,S.isNullOrUndefined)(this.parent.rowTemplate)&&!this.parent.isReact||this.parent.isReact&&!e.column.template)&&this.parent.trigger(z,e)}},e.prototype.updateTreeCell=function(e,t){var r=(0,S.getValue)("columnModel",this.parent)[this.parent.treeColumnIndex],i="templateFn",n=e.column.index;(0,S.isNullOrUndefined)(r.field)&&e.cell.setAttribute("data-colindex",n+""),r.field!==e.column.field||(0,S.isNullOrUndefined)(r.template)||(e.column.template=r.template,e.column[""+i]=(0,x.templateCompiler)(e.column.template),e.cell.classList.add("e-templatecell"));var o=null!=e.cell.querySelector(".e-treecell")?e.cell.querySelector(".e-treecell").innerHTML:e.cell.innerHTML;if("object"==typeof e.column.template&&this.templateResult)(0,x.appendChildren)(t,this.templateResult),this.templateResult=null,e.cell.innerHTML="";else if(e.cell.classList.contains("e-templatecell")){var a=e.cell.children.length,s=this.parent.element.id+e.column.uid;if(r.field!==e.column.field||(0,S.isNullOrUndefined)(r.template))for(;0<a;a=e.cell.children.length)t.appendChild(e.cell.children[parseInt((0).toString(),10)]);else{var d="portals";if(this.parent.isReact&&"string"!=typeof e.column.template){e.column[""+i](e.data,this.parent,"columnTemplate",s,null,null,t),(0,S.isNullOrUndefined)(this.parent.grid[""+d])&&(this.parent.grid[""+d]=this.parent[""+d]),this.parent.notify("renderReactTemplate",this.parent[""+d]);var l=this;l.parent.renderReactTemplates((function(){l.parent.trigger(z,e)}))}else{var p=e.column[""+i]((0,x.extend)({index:""},e.data),this.parent,"template",s,this.parent.isStringTemplate);(0,x.appendChildren)(t,p)}delete e.column.template,delete e.column[""+i],e.cell.innerHTML=""}}else t.innerHTML=o,e.cell.innerHTML=""},e.prototype.refreshReactColumnTemplateByUid=function(e){var t=this;this.parent.isReact&&this.parent.clearTemplate(["columnTemplate"],void 0,(function(){for(var r=t.parent.grid.getRowsObject(),i=t.parent.grid.getIndentCount(),n=t.parent.grid.getNormalizedColumnIndex(e),o=0;o<r.length;o++)if(r[parseInt(o.toString(),10)].isDataRow&&!(0,S.isNullOrUndefined)(r[parseInt(o.toString(),10)].index)){var a=r[parseInt(o.toString(),10)].cells[parseInt(n.toString(),10)],s=new x.CellRenderer(t.parent.grid,t.parent.grid.serviceLocator),d=t.parent.getCellFromIndex(r[parseInt(o.toString(),10)].index,n-i);s.refreshTD(d,a,r[parseInt(o.toString(),10)].data,{index:r[parseInt(o.toString(),10)].index});var l=t.parent.getRows()[parseInt(o.toString(),10)].cells[parseInt(n.toString(),10)];t.cellRender({data:r[parseInt(o.toString(),10)].data,cell:l,column:a.column})}}))},e.prototype.columnTemplateResult=function(e){this.templateResult=e.template},e.prototype.reactTemplateRender=function(e,t){var r="portals";this.parent[""+r]=e,this.parent.notify("renderReactTemplate",this.parent[""+r]),this.parent.renderReactTemplates(t)},e.prototype.destroy=function(){this.parent.grid.off("template-result",this.columnTemplateResult),this.parent.grid.off("reactTemplateRender",this.reactTemplateRender)},e}(),Bt=function(){function e(e){this.addedRecords="addedRecords",this.parent=e,this.parentItems=[],this.taskIds=[],this.hierarchyData=[],this.storedIndex=-1,this.sortedData=[],this.isSortAction=!1,this.addEventListener(),this.dataResults={},this.isSelfReference=!(0,S.isNullOrUndefined)(this.parent.parentIdMapping)}return e.prototype.addEventListener=function(){this.parent.on("updateRemoteLevel",this.updateParentRemoteData,this),this.parent.grid.on("sorting-begin",this.beginSorting,this),this.parent.on("updateAction",this.updateData,this),this.parent.on(ne,this.collectExpandingRecs,this),this.parent.on("dataProcessor",this.dataProcessor,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ne,this.collectExpandingRecs),this.parent.off("updateRemoteLevel",this.updateParentRemoteData),this.parent.off("updateAction",this.updateData),this.parent.off("dataProcessor",this.dataProcessor),this.parent.grid.off("sorting-begin",this.beginSorting))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.isRemote=function(){return this.parent.dataSource instanceof ct.DataManager},e.prototype.convertToFlatData=function(e){var t=this;if(this.parent.flatData=0!==Object.keys(e).length||this.parent.dataSource instanceof ct.DataManager?[]:this.parent.dataSource,this.parent.parentData=[],ut(this.parent)&&!wt(this.parent)&&e instanceof ct.DataManager&&!(e instanceof Array)){var r=this.parent.dataSource;if(this.parent.parentIdMapping){if(this.parent.query=(0,S.isNullOrUndefined)(this.parent.query)?new ct.Query:this.parent.query,this.parent.parentIdMapping){var i=this.parent.query.params.filter((function(e){return"IdMapping"===e.key}));this.parent.initialRender&&!i.length&&(this.parent.query.where(this.parent.parentIdMapping,"equal",null),this.parent.query.addParams("IdMapping",this.parent.idMapping))}if(!this.parent.hasChildMapping){var n=this.parent.query.clone();n.queries=[],(n=n.select([this.parent.parentIdMapping])).isCountRequired=!0,r.executeQuery(n).then((function(e){t.parentItems=ct.DataUtil.distinct(e.result,t.parent.parentIdMapping,!1),0==(e.result?0:1)&&((0,S.setValue)("grid.contentModule.isLoaded",!0,t.parent),(0,S.isNullOrUndefined)(t.zerothLevelData)||((0,S.setValue)("cancel",!1,t.zerothLevelData),(0,S.getValue)("grid.renderModule",t.parent).dataManagerSuccess(t.zerothLevelData),t.zerothLevelData=null),t.parent.grid.hideSpinner())}))}}}else e instanceof Array&&this.convertJSONData(e)},e.prototype.convertJSONData=function(e){if(this.hierarchyData=[],this.taskIds=[],this.parent.idMapping)for(var t=Object.keys(e),r=0;r<t.length;r++){var i=e[parseInt(r.toString(),10)];this.hierarchyData.push((0,S.extend)({},i)),(0,S.isNullOrUndefined)(i[this.parent.idMapping])||this.taskIds.push(i[this.parent.idMapping])}else this.hierarchyData=e;if(this.isSelfReference){var n=[],o=new ct.DataManager(this.hierarchyData).executeLocal((new ct.Query).group(this.parent.parentIdMapping));for(r=0;r<o.length;r++){var a=o[parseInt(r.toString(),10)],s=this.taskIds.indexOf(a.key);if(!(0,S.isNullOrUndefined)(a.key)&&s>-1){var d=a.items;this.hierarchyData[parseInt(s.toString(),10)][this.parent.childMapping]=d}else n.push.apply(n,a.items)}this.hierarchyData=this.selfReferenceUpdate(n)}if(Object.keys(this.hierarchyData).length)this.createRecords(this.hierarchyData);else{var l=!(this.parent.dataSource instanceof ct.DataManager)&&this.parent.isGantt;this.parent.flatData=l?this.parent.dataSource:[]}this.storedIndex=-1},e.prototype.selfReferenceUpdate=function(e){for(var t=[];this.hierarchyData.length>0&&e.length>0;){var r=e.indexOf(this.hierarchyData[0]);-1===r?this.hierarchyData.shift():(t.push(this.hierarchyData.shift()),e.splice(r,1))}return t},e.prototype.updateParentRemoteData=function(e){var t="actionArgs";ut(this.parent)&&this.parent.enableVirtualization&&"virtualscroll"===e[""+t].requestType&&this.parent.hideSpinner();var r=e.result;if(ut(this.parent)&&this.parent.enableVirtualization&&("virtualscroll"===e[""+t].requestType||"clearFilter"===e[""+t].action||""===e[""+t].searchString)&&(this.parent.query.expands=[]),this.parent.hasChildMapping||this.parentItems.length||this.parent.loadChildOnDemand)if(this.parent.loadChildOnDemand)(0,S.isNullOrUndefined)(r)||this.parent.loadChildOnDemand&&gt(this.parent)&&!(0,S.isNullOrUndefined)(this.parent.dataResults.expandRecord)||ut(this.parent)&&this.parent.loadChildOnDemand&&e[""+t].isExpandCollapse&&this.parent.enableVirtualization||this.convertToFlatData(r);else for(var i=function(e){if(gt(n.parent)&&r[parseInt(e.toString(),10)].hasChildRecords&&n.parent.initialRender&&(r[parseInt(e.toString(),10)].expanded=!1),ut(n.parent)&&n.parent.enableVirtualization){var t=[],i=n.parent;r.filter((function(n){n[""+i.parentIdMapping]===r[parseInt(e.toString(),10)][""+i.idMapping]&&t.push(n)})),t.length?r[parseInt(e.toString(),10)].expanded=!0:r[parseInt(e.toString(),10)].hasChildRecords&&(r[parseInt(e.toString(),10)].expanded=!1)}(0,S.isNullOrUndefined)(r[parseInt(e.toString(),10)].index)&&(r[parseInt(e.toString(),10)].taskData=(0,S.extend)({},r[parseInt(e.toString(),10)]),r[parseInt(e.toString(),10)].uniqueID=(0,x.getUid)(n.parent.element.id+"_data_"),(0,S.setValue)("uniqueIDCollection."+r[parseInt(e.toString(),10)].uniqueID,r[parseInt(e.toString(),10)],n.parent),r[parseInt(e.toString(),10)].level=0,ut(n.parent)&&n.parent.enableVirtualization&&r[parseInt(e.toString(),10)][""+n.parent.parentIdMapping]&&0===r[parseInt(e.toString(),10)].level&&(r[parseInt(e.toString(),10)].level=r[parseInt(e.toString(),10)].level+1),r[parseInt(e.toString(),10)].index=Math.ceil(1e3*Math.random()),(r[parseInt(e.toString(),10)][n.parent.hasChildMapping]||-1!==n.parentItems.indexOf(r[parseInt(e.toString(),10)][n.parent.idMapping]))&&(r[parseInt(e.toString(),10)].hasChildRecords=!0),r[parseInt(e.toString(),10)].checkboxState="uncheck")},n=this,o=0;o<r.length;o++)i(o);else this.zerothLevelData=e,(0,S.setValue)("cancel",!0,e);if(ut(this.parent)&&this.parent.loadChildOnDemand&&e[""+t].isExpandCollapse&&this.parent.enableVirtualization||ut(this.parent)&&this.parent.enableVirtualization&&!this.parent.loadChildOnDemand?e.result=r:e.result=this.parent.loadChildOnDemand?this.parent.flatData:r,ut(this.parent)&&this.parent.enableVirtualization&&this.parent.loadChildOnDemand&&this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){var a=e.query.queries.filter((function(e){return"onAggregates"===e.fn}));e.result=this.parent.summaryModule.calculateSummaryValue(a,this.parent.flatData,!0)}this.parent.notify("updateResults",e)},e.prototype.collectExpandingRecs=function(e,t){var r,i=this.parent.getRows();if(this.parent.rowTemplate){var n=this.parent.getContentTable().rows;i=[].slice.call(n)}if(e.rows.length>0){t||(e.record.expanded=!0);for(var o=0;o<e.rows.length;o++){if(e.rows[parseInt(o.toString(),10)].style.display="table-row",this.parent.loadChildOnDemand){var a,s=e.rows[parseInt(o.toString(),10)].getElementsByClassName("e-treegridcollapse")[0];r=this.parent.rowTemplate?this.parent.grid.getCurrentViewRecords()[e.rows[parseInt(o.toString(),10)].rowIndex]:this.parent.grid.getRowObjectFromUID(e.rows[parseInt(o.toString(),10)].getAttribute("data-Uid")).data,!(0,S.isNullOrUndefined)(s)&&r.expanded&&((0,S.addClass)([s],"e-treegridexpand"),(0,S.removeClass)([s],"e-treegridcollapse")),(a=i.filter((function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))}))).length&&r.expanded&&this.collectExpandingRecs({record:r,rows:a,parentRow:e.parentRow},!0)}var d=e.rows[parseInt(o.toString(),10)].querySelector(".e-detailrowcollapse");(0,S.isNullOrUndefined)(d)||this.parent.grid.detailRowModule.expand(d)}}else this.fetchRemoteChildData({action:e.name,record:e.record,rows:e.rows,parentRow:e.parentRow})},e.prototype.fetchRemoteChildData=function(e){var t=this,r={row:e.parentRow,data:e.record},i=this.parent.dataSource,n=this.parent.grid.getDataModule().generateQuery(),o=n.queries.filter((function(e){return"onPage"!==e.fn&&"onWhere"!==e.fn}));if(n.queries=o,n.isCountRequired=!0,this.parent.enableVirtualization&&"remoteExpand"===e.action)n.take(this.parent.pageSettings.pageSize),(a=[]).push("ExpandingAction",parseInt(e.record[this.parent.idMapping],10).toString()),n.expand(a);else if(this.parent.enableVirtualization&&"collapse"===e.action){var a;n.take(this.parent.grid.pageSettings.pageSize),(a=[]).push("CollapsingAction",parseInt(e.record[this.parent.idMapping],10).toString()),n.expand(a)}if(n.where(this.parent.parentIdMapping,"equal",e.record[this.parent.idMapping]),"remoteExpand"===e.action&&this.parent.grid.filterModule&&this.parent.grid.filterModule.value){var s=this.parent.grid.getDataModule().generateQuery().queries.filter((function(e){return"onPage"!==e.fn&&void 0!==e.e.predicates}));n.queries.push(s[0])}(0,qt.showSpinner)(this.parent.element),i.executeQuery(n).then((function(i){var n,o="remoteExpandedData",a="remoteCollapsedData",s=t.parent.grid.currentViewData.slice(),d=t.parent.idMapping;if(t.parent.isGantt&&!t.parent.loadChildOnDemand&&t.parent.hasChildMapping){for(var l=0;l<t.parent.grid.currentViewData.length;l++)if(e.record[d]===t.parent.grid.currentViewData[l][d]){n=l;break}}else n=s.indexOf(e.record);if(t.parent.enableVirtualization&&("collapse"===e.action||"remoteExpand"===e.action))for(s=[],l=0;l<n;l++)s.push(t.parent.grid.currentViewData[parseInt(l.toString(),10)]);-1===n&&t.parent.grid.getRowsObject().forEach((function(t){t.data.uniqueID===e.record.uniqueID&&(n=t.index)}));var p=(0,x.getObject)("actual.nextLevel",i),h=i.result,c=[];if("remoteExpand"===e.action&&t.parent.grid.filterModule&&t.parent.grid.filterModule.value){for(l=0;l<s.length;l++)Object.prototype.hasOwnProperty.call(s[parseInt(l.toString(),10)],t.parent.parentIdMapping)&&null!==s[parseInt(l.toString(),10)][""+t.parent.parentIdMapping]&&0===s[parseInt(l.toString(),10)].level&&(s.splice(l,1),l--);for(l=0;l<h.length;l++)e.record[""+t.parent.idMapping]!==h[parseInt(l.toString(),10)][""+t.parent.idMapping]&&e.record[""+t.parent.idMapping]===h[parseInt(l.toString(),10)][""+t.parent.parentIdMapping]&&Object.prototype.hasOwnProperty.call(h,l)&&c.push(h[parseInt(l.toString(),10)]);h=c}if(t.parent.enableVirtualization&&"remoteExpand"===e.action)for(e.record.childRecords=[],l=0;l<h.length;l++)e.record[""+t.parent.idMapping]!==h[parseInt(l.toString(),10)][""+t.parent.idMapping]&&e.record[""+t.parent.idMapping]===h[parseInt(l.toString(),10)][""+t.parent.parentIdMapping]&&Object.prototype.hasOwnProperty.call(h,l)&&e.record.childRecords.push(h[parseInt(l.toString(),10)]);else e.record.childRecords=h;for(var u=0;u<h.length;u++){if(t.parent.enableVirtualization&&h[parseInt(u.toString(),10)][""+t.parent.idMapping]===e.record[""+t.parent.idMapping]&&"remoteExpand"===e.action)t.parent[""+o].push(e.record);else if(t.parent.enableVirtualization&&h[parseInt(u.toString(),10)][""+t.parent.idMapping]===e.record[""+t.parent.idMapping]&&"collapse"===e.action)for(l=0;l<t.parent[""+o].length;l++)e.record[""+t.parent.idMapping]===t.parent[""+o][parseInt(l.toString(),10)][""+t.parent.idMapping]&&t.parent[""+o].splice(l,1);if(h[parseInt(u.toString(),10)].taskData=(0,S.extend)({},h[parseInt(u.toString(),10)]),h[parseInt(u.toString(),10)][""+t.parent.parentIdMapping]&&t.parent.enableVirtualization&&t.parent[""+o].length)for(l=0;l<t.parent[""+o].length;l++)h[parseInt(u.toString(),10)][""+t.parent.parentIdMapping]===t.parent[""+o][parseInt(l.toString(),10)][""+t.parent.idMapping]&&(h[parseInt(u.toString(),10)].level=t.parent[""+o][parseInt(l.toString(),10)].level+1,delete(g=t.parent[""+o][parseInt(l.toString(),10)]).childRecords,h[parseInt(u.toString(),10)].parentItem=g,h[parseInt(u.toString(),10)].parentUniqueID=e.record.uniqueID);else if(t.parent.enableVirtualization)!h[parseInt(u.toString(),10)][""+t.parent.hasChildMapping]&&-1===t.parentItems.indexOf(h[parseInt(u.toString(),10)][""+t.parent.idMapping])||p&&!p[parseInt(u.toString(),10)]?(delete(g=(0,S.extend)({},e.record)).childRecords,h[parseInt(u.toString(),10)].parentItem=g,h[parseInt(u.toString(),10)].parentUniqueID=e.record.uniqueID):(0,S.isNullOrUndefined)(h[parseInt(u.toString(),10)][""+t.parent.parentIdMapping])?(h[parseInt(u.toString(),10)].level=0,"remoteExpand"===e.action&&(h[parseInt(u.toString(),10)].childRecords=[],h[parseInt(u.toString(),10)].childRecords=e.record.childRecords)):h[parseInt(u.toString(),10)].level=e.record.level;else{var g;h[parseInt(u.toString(),10)].level=e.record.level+1,delete(g=(0,S.extend)({},e.record)).childRecords,h[parseInt(u.toString(),10)].parentItem=g,h[parseInt(u.toString(),10)].parentUniqueID=e.record.uniqueID}if(h[parseInt(u.toString(),10)].index=Math.ceil(1e3*Math.random()),h[parseInt(u.toString(),10)].uniqueID=(0,x.getUid)(t.parent.element.id+"_data_"),h[parseInt(u.toString(),10)].checkboxState="uncheck",t.parent.enableVirtualization&&(0,S.isNullOrUndefined)(h[parseInt(u.toString(),10)].level))for(var f=0;f<t.parent.grid.currentViewData.length;f++)t.parent.grid.currentViewData[parseInt(f.toString(),10)][""+t.parent.idMapping]===h[parseInt(u.toString(),10)][""+t.parent.parentIdMapping]&&(h[parseInt(u.toString(),10)].level=t.parent.grid.currentViewData[parseInt(f.toString(),10)].level+1);if((0,S.setValue)("uniqueIDCollection."+h[parseInt(u.toString(),10)].uniqueID,h[parseInt(u.toString(),10)],t.parent),(h[parseInt(u.toString(),10)][""+t.parent.hasChildMapping]||-1!==t.parentItems.indexOf(h[parseInt(u.toString(),10)][""+t.parent.idMapping]))&&(!p||p[parseInt(u.toString(),10)]))if(h[parseInt(u.toString(),10)].hasChildRecords=!0,t.parent.enableVirtualization&&t.parent.loadChildOnDemand){for(l=0;l<t.parent[""+a].length;l++)h[parseInt(u.toString(),10)][""+t.parent.idMapping]===t.parent[""+a][parseInt(l.toString(),10)][""+t.parent.idMapping]&&(h[parseInt(u.toString(),10)].expanded=t.parent[""+a][parseInt(l.toString(),10)].expanded);if("collapse"===e.action&&h[parseInt(u.toString(),10)][""+t.parent.idMapping]!==e.record[""+t.parent.idMapping]&&!1!==h[parseInt(u.toString(),10)].expanded)h[parseInt(u.toString(),10)].expanded=!0;else if("collapse"===e.action&&h[parseInt(u.toString(),10)][""+t.parent.idMapping]===e.record[""+t.parent.idMapping])h[parseInt(u.toString(),10)].expanded=!1,t.parent[""+a].push(e.record);else if("remoteExpand"===e.action){for(l=0;l<t.parent.grid.currentViewData.length;l++)t.parent.grid.currentViewData[parseInt(l.toString(),10)][""+t.parent.idMapping]===h[parseInt(u.toString(),10)][""+t.parent.idMapping]&&h.splice(u,1,t.parent.grid.currentViewData[parseInt(l.toString(),10)]);if(h[parseInt(u.toString(),10)][t.parent.idMapping]===e.record[""+t.parent.idMapping])for(l=0;l<t.parent[""+a].length;l++)e.record[""+t.parent.idMapping]===t.parent[""+a][parseInt(l.toString(),10)][""+t.parent.idMapping]&&t.parent[""+a].splice(l,1);!1!==h[parseInt(u.toString(),10)].expanded&&(h[parseInt(u.toString(),10)].expanded=!0)}}else t.parent.enableVirtualization&&h[parseInt(u.toString(),10)][""+t.parent.idMapping]===e.record[""+t.parent.idMapping]&&"collapse"!==e.action?h[parseInt(u.toString(),10)].expanded=!0:t.parent.enableVirtualization&&t.parent.loadChildOnDemand||(h[parseInt(u.toString(),10)].expanded=!1);s.splice(n+u+1,0,h[parseInt(u.toString(),10)])}if((0,S.setValue)("result",s,i),(0,S.setValue)("action","beforecontentrender",i),t.parent.trigger(G,i),(0,qt.hideSpinner)(t.parent.element),t.parent.grid.aggregates.length>0&&!t.parent.enableVirtualization){var y=(0,x.getObject)("query",i),m="result";if((0,S.isNullOrUndefined)(y)&&(y=(0,S.getValue)("grid.renderModule.data",t.parent).aggregateQuery(new ct.Query)),!(0,S.isNullOrUndefined)(y)){var v=y.queries.filter((function(e){return"onAggregates"===e.fn}));i[""+m]=t.parent.summaryModule.calculateSummaryValue(v,i[""+m],!0)}}t.parent.enableVirtualization&&(t.parent.grid.pageSettings.totalRecordsCount=i.count),i.count=t.parent.grid.pageSettings.totalRecordsCount;var w={};t.parent.enableVirtualization&&t.remoteVirtualAction(w);var I={index:n,childData:h};t.parent.enableInfiniteScrolling?t.parent.notify("infinite-remote-expand",I):(0,S.getValue)("grid.renderModule",t.parent).dataManagerSuccess(i,w),t.parent.trigger(ee,r)}))},e.prototype.remoteVirtualAction=function(e){e.requestType="refresh",(0,S.setValue)("isExpandCollapse",!0,e);var t=(0,S.getValue)("grid.contentModule",this.parent),r=(0,S.getValue)("currentInfo",t),i=(0,S.getValue)("prevInfo",t);r.loadNext&&this.parent.grid.pageSettings.currentPage===r.nextInfo.page&&(this.parent.grid.pageSettings.currentPage=i.page)},e.prototype.beginSorting=function(){if(this.isSortAction=!0,ut(this.parent)&&this.parent.enableVirtualization){var e=this.parent.query.queries.indexOf(this.parent.query.queries.filter((function(e){return"onSortBy"===e.fn}))[0]);-1!==e&&this.parent.query.queries.splice(e,1),0===this.parent.grid.sortSettings.columns.length&&this.parent.query.sortBy(null,null)}},e.prototype.createRecords=function(e,t){for(var r=[],i=0,n=Object.keys(e).length;i<n;i++){var o=(0,S.extend)({},e[parseInt(i.toString(),10)]);o.taskData=e[parseInt(i.toString(),10)];var a=0;if(this.storedIndex++,Object.prototype.hasOwnProperty.call(o,"index")||(o.index=this.storedIndex),(!(0,S.isNullOrUndefined)(o[this.parent.childMapping])&&!gt(this.parent)||o[this.parent.hasChildMapping]&&gt(this.parent))&&(o.hasChildRecords=!0,this.parent.enableCollapseAll||!(0,S.isNullOrUndefined)(this.parent.dataStateChange)&&(0,S.isNullOrUndefined)(o[this.parent.childMapping])?o.expanded=!1:o.expanded=!!(0,S.isNullOrUndefined)(o[this.parent.expandStateMapping])||o[this.parent.expandStateMapping]),Object.prototype.hasOwnProperty.call(o,"index")||(o.index=(o.hasChildRecords,this.storedIndex)),this.isSelfReference&&(0,S.isNullOrUndefined)(o[this.parent.parentIdMapping])&&this.parent.parentData.push(o),o.uniqueID=(0,x.getUid)(this.parent.element.id+"_data_"),(0,S.setValue)("uniqueIDCollection."+o.uniqueID,o,this.parent),!(0,S.isNullOrUndefined)(t)){var s=(0,S.extend)({},t);delete s.childRecords,delete s[this.parent.childMapping],this.isSelfReference&&delete s.taskData[this.parent.childMapping],o.parentItem=s,o.parentUniqueID=s.uniqueID,a=t.level+1}Object.prototype.hasOwnProperty.call(o,"level")||(o.level=a),o.checkboxState="uncheck";var d="remoteCollapsedData";if(this.parent.enableVirtualization&&this.parent.loadChildOnDemand&&ut(this.parent)&&!this.parent.initialRender){if(!o.hasChildRecords&&(0,S.isNullOrUndefined)(o[""+this.parent.parentIdMapping])){o.hasChildRecords=!0;for(var l=0;l<this.parent[""+d].length;l++)this.parent[""+d][parseInt(l.toString(),10)][""+this.parent.idMapping]===o[""+this.parent.idMapping]&&(o.expanded=!1)}else 0===o.level&&(0,S.isNullOrUndefined)(t)&&!o.hasChildRecords&&(o.level=o.level+1);o[""+this.parent.hasChildMapping]&&!(0,S.isNullOrUndefined)(o[""+this.parent.expandStateMapping])&&(o.expanded=o[""+this.parent.expandStateMapping],o.hasChildRecords=!0),this.parent.flatData.push(o)}else((0,S.isNullOrUndefined)(o[""+this.parent.parentIdMapping])||o.parentItem)&&(this.parent.flatData.push(o),this.parent.infiniteScrollData.push(o));if(this.isSelfReference||0!==o.level||this.parent.parentData.push(o),!(0,S.isNullOrUndefined)(o[this.parent.childMapping]&&o[this.parent.childMapping].length)){var p=this.createRecords(o[this.parent.childMapping],o);o.childRecords=p}r.push(o)}return r},e.prototype.dataProcessor=function(e){var t,r=(0,x.getObject)("isExport",e),i=(0,x.getObject)("expresults",e),n=(0,x.getObject)("exportType",e),o=(0,x.getObject)("isPrinting",e),a=(0,x.getObject)("actionArgs",e),s=(0,x.getObject)("requestType",e),d=(0,x.getObject)("data",e),l=(0,x.getObject)("action",e),p=a,h=this.parent.getPrimaryKeyFieldNames()[0],c=(0,x.getObject)("data",p);(0,S.isNullOrUndefined)(p)||(0,S.isNullOrUndefined)(p.action)||"add"!==p.action||(0,S.isNullOrUndefined)(p.data)||!(0,S.isNullOrUndefined)(p.data[""+h])||(p.data[""+h]=e.result[p.index][""+h],c.taskData[""+h]=e.result[p.index][""+h]),(!(0,S.isNullOrUndefined)(a)&&Object.keys(a).length||"save"===s)&&(s=s||a.requestType,d=d||(0,x.getObject)("data",a),l=l||(0,x.getObject)("action",a),"Batch"===this.parent.editSettings.mode&&(this.batchChanges=this.parent.grid.editModule.getBatchChanges()),this.parent.isLocalData&&this.updateAction(d,l,s));var u,g,f=(t=r&&!(0,S.isNullOrUndefined)(i)?i:gt(this.parent)?(0,S.getValue)("result",this.parent.grid.dataSource):this.parent.grid.dataSource)instanceof ct.DataManager?t.dataSource.json:t,y=gt(this.parent)?(0,S.getValue)("count",this.parent.dataSource):f.length,m=new ct.Query,v=(0,x.getObject)("query",e);if((0,S.isNullOrUndefined)(v)||(u=v.queries.filter((function(e){return"onWhere"===e.fn})),g=v.queries.filter((function(e){return"onSearch"===e.fn}))),this.parent.grid.allowFiltering&&this.parent.grid.filterSettings.columns.length||this.parent.grid.searchSettings.key.length>0||!(0,S.isNullOrUndefined)(v)&&(u.length||g.length)&&this.parent.isLocalData){(0,S.isNullOrUndefined)(v)&&(v=new ct.Query,v=(0,S.getValue)("grid.renderModule.data",this.parent).filterQuery(v),v=(0,S.getValue)("grid.renderModule.data",this.parent).searchQuery(v));var w=v.queries.filter((function(e){return"onWhere"===e.fn})),I=v.queries.filter((function(e){return"onSearch"===e.fn}));m.queries=w.concat(I);var R=new ct.DataManager(f).executeLocal(m);if(this.parent.notify("updateFilterRecs",{data:R}),f=this.dataResults.result,this.dataResults.result=null,this.parent.grid.aggregates.length>0){var C=(0,x.getObject)("query",e);if((0,S.isNullOrUndefined)(v)&&(v=(0,S.getValue)("grid.renderModule.data",this.parent).aggregateQuery(new ct.Query)),!(0,S.isNullOrUndefined)(C)){var b=C.queries.filter((function(e){return"onAggregates"===e.fn}));f=this.parent.summaryModule.calculateSummaryValue(b,f,!0)}}}if(this.parent.grid.aggregates.length&&0===this.parent.grid.sortSettings.columns.length&&0===this.parent.grid.filterSettings.columns.length&&!this.parent.grid.searchSettings.key.length){var D=(0,x.getObject)("query",e);(0,S.isNullOrUndefined)(D)&&(D=(0,S.getValue)("grid.renderModule.data",this.parent).aggregateQuery(new ct.Query)),b=D.queries.filter((function(e){return"onAggregates"===e.fn})),f=this.parent.summaryModule.calculateSummaryValue(b,this.parent.flatData,!0)}if(this.parent.grid.sortSettings.columns.length>0||this.isSortAction){this.isSortAction=!1;for(var M=this.parent.parentData,O=(C=(0,x.getObject)("query",e),new ct.Query),P=this.parent.grid.sortSettings.columns.length-1;P>=0;P--){var E=this.parent.grid.renderModule.data.getColumnByField(this.parent.grid.sortSettings.columns[parseInt(P.toString(),10)].field),A=E.sortComparer&&wt(this.parent)?E.sortComparer.bind(E):this.parent.grid.sortSettings.columns[parseInt(P.toString(),10)].direction;O.sortBy(this.parent.grid.sortSettings.columns[parseInt(P.toString(),10)].field,A)}var N=new ct.DataManager(M).executeLocal(O);if(this.parent.allowRowDragAndDrop&&!(0,S.isNullOrUndefined)(this.parent.rowDragAndDropModule.draggedRecord)&&this.parent.rowDragAndDropModule.droppedRecord.hasChildRecords&&"middleSegment"!==this.parent.rowDragAndDropModule.dropPosition){var k=N.indexOf(this.parent.rowDragAndDropModule.draggedRecord);N.splice(k,1);var U=N.indexOf(this.parent.rowDragAndDropModule.droppedRecord);this.parent.rowDragAndDropModule.droppedRecord.hasChildRecords&&"topSegment"===this.parent.rowDragAndDropModule.dropPosition?N.splice(U,0,this.parent.rowDragAndDropModule.draggedRecord):"bottomSegment"===this.parent.rowDragAndDropModule.dropPosition&&N.splice(U+1,0,this.parent.rowDragAndDropModule.draggedRecord)}var q={modifiedData:N,filteredData:f,srtQry:O};this.parent.notify("createSort",q),f=q.modifiedData,this.dataResults.result=null,this.sortedData=f,this.parent.notify("updateModel",{}),this.parent.grid.aggregates.length>0&&!(0,S.isNullOrUndefined)(C)&&(b=(0,x.getObject)("query",e).queries.filter((function(e){return"onAggregates"===e.fn})),f=this.parent.summaryModule.calculateSummaryValue(b,this.sortedData,!1))}y=gt(this.parent)?(0,S.getValue)("count",this.parent.dataSource):f.length;var V=this.paging(f,y,r,o,n,e);f=V.result,y=V.count,e.result=f,e.count=y,this.parent.notify("updateResults",e)},e.prototype.paging=function(e,t,r,i,n,o){if(!this.parent.allowPaging||r&&"CurrentPage"!==n||i&&"CurrentPage"!==this.parent.printMode){if((this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&(!r||"CurrentPage"===n)&&"save"!==(0,S.getValue)("requestType",o)){var a=this.parent.enableInfiniteScrolling?o:(0,S.getValue)("actionArgs",o);this.parent.notify(ae,{result:e,count:t,actionArgs:a}),e=this.dataResults.result,t=this.dataResults.count}}else this.parent.notify(ae,{result:e,count:t}),e=this.dataResults.result,t=gt(this.parent)?(0,S.getValue)("count",this.parent.dataSource):this.dataResults.count;var s="isCollapsedStatePersist";if((!0===i||o.isPdfExport&&((0,S.isNullOrUndefined)(o[""+s])||o[""+s]))&&"AllPages"===this.parent.printMode){for(var d=[],l=0;l<e.length;l++)St(this.parent,e[parseInt(l.toString(),10)],this.parent.parentData)&&d.push(e[parseInt(l.toString(),10)]);t=(e=d).length}return{result:e,count:t}},e.prototype.updateData=function(e){this.dataResults=e},e.prototype.updateAction=function(e,t,r){"delete"!==r&&"save"!==r||this.parent.notify(ue,{value:e,action:t||r}),"batchsave"===r&&"Batch"===this.parent.editSettings.mode&&this.parent.notify(De,{})},e}();!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Update=2]="Update",e[e.Delete=3]="Delete",e[e.Cancel=4]="Cancel",e[e.Search=5]="Search",e[e.ExpandAll=6]="ExpandAll",e[e.CollapseAll=7]="CollapseAll",e[e.ExcelExport=8]="ExcelExport",e[e.PdfExport=9]="PdfExport",e[e.CsvExport=10]="CsvExport",e[e.Print=11]="Print",e[e.RowIndent=12]="RowIndent",e[e.RowOutdent=13]="RowOutdent"}(bt||(bt={})),function(e){e[e.AutoFit=0]="AutoFit",e[e.AutoFitAll=1]="AutoFitAll",e[e.SortAscending=2]="SortAscending",e[e.SortDescending=3]="SortDescending",e[e.Edit=4]="Edit",e[e.Delete=5]="Delete",e[e.Save=6]="Save",e[e.Cancel=7]="Cancel",e[e.PdfExport=8]="PdfExport",e[e.ExcelExport=9]="ExcelExport",e[e.CsvExport=10]="CsvExport",e[e.FirstPage=11]="FirstPage",e[e.PrevPage=12]="PrevPage",e[e.LastPage=13]="LastPage",e[e.NextPage=14]="NextPage",e[e.AddRow=15]="AddRow",e[e.RowIndent=16]="RowIndent",e[e.RowOutdent=17]="RowOutdent"}(Dt||(Dt={}));var Tt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Lt=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tt(t,e),Lt([(0,S.Property)(12)],t.prototype,"pageSize",void 0),Lt([(0,S.Property)(8)],t.prototype,"pageCount",void 0),Lt([(0,S.Property)(1)],t.prototype,"currentPage",void 0),Lt([(0,S.Property)()],t.prototype,"totalRecordsCount",void 0),Lt([(0,S.Property)(!1)],t.prototype,"enableQueryString",void 0),Lt([(0,S.Property)(!1)],t.prototype,"pageSizes",void 0),Lt([(0,S.Property)(null)],t.prototype,"template",void 0),Lt([(0,S.Property)("All")],t.prototype,"pageSizeMode",void 0),t}(S.ChildProperty),zt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ft=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},_t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.intl=new S.Internationalization,t.templateFn={},t}return zt(t,e),t.prototype.setFormatter=function(e){this.format&&(this.format.skeleton||this.format.format)&&(this.formatFn=this.getFormatFunction(this.format))},t.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},t.prototype.getFormatter=function(){return this.formatFn},t.prototype.setTemplate=function(e){void 0===e&&(e={}),void 0!==this.footerTemplate&&(this.templateFn[(0,S.getEnumValue)(x.CellType,x.CellType.Summary)]={fn:(0,S.compile)(this.footerTemplate,e),property:"footerTemplate"})},t.prototype.getTemplate=function(e){return this.templateFn[(0,S.getEnumValue)(x.CellType,e)]},t.prototype.setPropertiesSilent=function(e){this.setProperties(e,!0)},Ft([(0,S.Property)()],t.prototype,"type",void 0),Ft([(0,S.Property)()],t.prototype,"footerTemplate",void 0),Ft([(0,S.Property)()],t.prototype,"field",void 0),Ft([(0,S.Property)()],t.prototype,"format",void 0),Ft([(0,S.Property)()],t.prototype,"columnName",void 0),Ft([(0,S.Property)()],t.prototype,"customAggregate",void 0),t}(S.ChildProperty),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zt(t,e),Ft([(0,S.Collection)([],_t)],t.prototype,"columns",void 0),Ft([(0,S.Property)(!0)],t.prototype,"showChildSummary",void 0),t}(S.ChildProperty),Gt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qt=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Gt(t,e),Qt([(0,S.Property)(!1)],t.prototype,"allowAdding",void 0),Qt([(0,S.Property)(!1)],t.prototype,"allowEditing",void 0),Qt([(0,S.Property)(!1)],t.prototype,"allowDeleting",void 0),Qt([(0,S.Property)("Cell")],t.prototype,"mode",void 0),Qt([(0,S.Property)("Top")],t.prototype,"newRowPosition",void 0),Qt([(0,S.Property)(!0)],t.prototype,"allowEditOnDblClick",void 0),Qt([(0,S.Property)(!0)],t.prototype,"showConfirmDialog",void 0),Qt([(0,S.Property)(!1)],t.prototype,"showDeleteConfirmDialog",void 0),Qt([(0,S.Property)("")],t.prototype,"template",void 0),Qt([(0,S.Property)({})],t.prototype,"dialog",void 0),Qt([(0,S.Property)(!1)],t.prototype,"allowNextRowEdit",void 0),t}(S.ChildProperty),Wt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Yt=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Wt(t,e),Yt([(0,S.Property)()],t.prototype,"field",void 0),Yt([(0,S.Property)()],t.prototype,"direction",void 0),t}(S.ChildProperty),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Wt(t,e),Yt([(0,S.Collection)([],Jt)],t.prototype,"columns",void 0),Yt([(0,S.Property)(!0)],t.prototype,"allowUnsort",void 0),t}(S.ChildProperty);function $t(e,t,r,i,n,o,a){var s,d,l,p=e.value,h=e.action,c=t.grid.getPrimaryKeyFieldNames()[0],u=t.dataSource instanceof ct.DataManager?t.dataSource.dataSource.json:t.dataSource,g=[],f=p,y=!1;if("Batch"===t.editSettings.mode&&(l=t.grid.editModule.getBatchChanges()),"add"===h||"batchsave"===h&&"Batch"===t.editSettings.mode&&l.addedRecords.length){var m=function(e,t,r,i,n,o,a){var s,d=!1,l=r.grid.getCurrentViewRecords();switch(s=Rt(s=(0,S.extend)({},e.value)),r.editSettings.newRowPosition){case"Top":t.unshift(s),d=!0;break;case"Bottom":t.push(s),d=!0;break;case"Above":s=(0,S.isNullOrUndefined)(a)?Rt(s=(0,S.extend)({},l[n+1])):Rt(s=(0,S.extend)({},a));break;case"Below":case"Child":if((0,S.isNullOrUndefined)(a)){var p=r.grid.getPrimaryKeyFieldNames()[0],h=l[parseInt(n.toString(),10)];s=Rt(s=!(0,S.isNullOrUndefined)(h)&&h[""+p]===e.value[""+p]||-1!==o?(0,S.extend)({},h):(0,S.extend)({},e.value));r.editModule.internalProperties.taskData=s}else s=Rt(s=(0,S.extend)({},a));-1===o&&(t.unshift(s),d=!0)}return{value:s,isSkip:d}}(e,u,t,0,i,n,a);p=m.value,y=m.isSkip}if(p instanceof Array?g=It(p):g.push((0,S.extend)({},p)),!y&&("add"!==h||"Top"!==t.editSettings.newRowPosition&&"Bottom"!==t.editSettings.newRowPosition))for(var v=0;v<g.length;v++){"object"==typeof g[parseInt(v.toString(),10)][""+c]&&(g[parseInt(v.toString(),10)]=g[parseInt(v.toString(),10)][""+c]);var w=g[parseInt(v.toString(),10)].taskData?Object.keys(g[parseInt(v.toString(),10)].taskData):Object.keys(g[parseInt(v.toString(),10)]);s=u.length;for(var I=function(){if(u[parseInt(s.toString(),10)][""+c]===g[parseInt(v.toString(),10)][""+c]){if("delete"!==h){if("edit"===h){for(d=0;d<w.length;d++)if(Object.prototype.hasOwnProperty.call(u[parseInt(s.toString(),10)],w[parseInt(d.toString(),10)])&&("Cell"!==t.editSettings.mode||!(0,S.isNullOrUndefined)(l)&&0===l.changedRecords.length||w[parseInt(d.toString(),10)]===o)){var e=xt(t,g[parseInt(v.toString(),10)].uniqueID);u[parseInt(s.toString(),10)][w[parseInt(d.toString(),10)]]=g[parseInt(v.toString(),10)][w[parseInt(d.toString(),10)]],e&&e.taskData&&(e.taskData[w[parseInt(d.toString(),10)]]=e[w[parseInt(d.toString(),10)]]=u[parseInt(s.toString(),10)][w[parseInt(d.toString(),10)]])}}else if("add"===h||"batchsave"===h){var n=void 0;"Child"===t.editSettings.newRowPosition?r?(f.taskData[""+t.parentIdMapping]=u[parseInt(s.toString(),10)][""+t.idMapping],u.splice(s+1,0,f.taskData)):(Object.prototype.hasOwnProperty.call(u[parseInt(s.toString(),10)],t.childMapping)||(u[parseInt(s.toString(),10)][""+t.childMapping]=[]),u[parseInt(s.toString(),10)][""+t.childMapping].push(f.taskData),er(c,u[parseInt(s.toString(),10)],h,t,r,f)):"Below"===t.editSettings.newRowPosition?(u.splice(s+1,0,f.taskData),(0,S.isNullOrUndefined)(f.parentItem)||er(c,u[s+1],h,t,r,f)):i?"Above"===t.editSettings.newRowPosition&&(u.splice(s,0,f.taskData),(0,S.isNullOrUndefined)(f.parentItem)||er(c,u[parseInt(s.toString(),10)],h,t,r,f)):(n=0,u.splice(n,0,f.taskData))}return"break"}var a=u[parseInt(s.toString(),10)];if(u.splice(s,1),r){if(!(0,S.isNullOrUndefined)(a[""+t.parentIdMapping]))for(var p=t.flatData.filter((function(e){return e[""+t.idMapping]===a[""+t.parentIdMapping]}))[0],y=p?p[""+t.childMapping]:[],m=y.length-1;m>=0;m--)if(y[parseInt(m.toString(),10)][""+t.idMapping]===a[""+t.idMapping]){t.enableImmutableMode||p.childRecords.length!==p.Children.length||p.childRecords.splice(m,1),y.splice(m,1),y.length||(p.hasChildRecords=!1,er(c,p,h,t,r));break}return"break"}}else(0,S.isNullOrUndefined)(u[parseInt(s.toString(),10)][""+t.childMapping])||Zt(u[parseInt(s.toString(),10)][""+t.childMapping],g[parseInt(v.toString(),10)],h,c,t,r,f,o)&&er(c,u[parseInt(s.toString(),10)],h,t,r)};s--&&s>=0&&"break"!==I(););}}function Zt(e,t,r,i,n,o,a,s){for(var d=!1,l=e.length;l--&&l>=0;)if(e[parseInt(l.toString(),10)][""+i]===t[""+i]||o&&e[parseInt(l.toString(),10)][n.parentIdMapping]===t[n.idMapping]){if("edit"===r){for(var p=Object.keys(t),h=xt(n,t.uniqueID),c=0;c<p.length;c++)if(Object.prototype.hasOwnProperty.call(e[parseInt(l.toString(),10)],p[parseInt(c.toString(),10)])&&("Cell"!==n.editSettings.mode||p[parseInt(c.toString(),10)]===s)&&(h[p[parseInt(c.toString(),10)]]=h.taskData[p[parseInt(c.toString(),10)]]=e[parseInt(l.toString(),10)][p[parseInt(c.toString(),10)]]=t[p[parseInt(c.toString(),10)]],"Normal"===n.grid.editSettings.mode&&"Cell"===n.editSettings.mode)){var u="editModule";n.grid.editModule[""+u].editRowIndex=t.index,n.grid.editModule[""+u].updateCurrentViewData(t)}break}"add"===r||"batchsave"===r?"Child"===n.editSettings.newRowPosition?o?(a[""+n.parentIdMapping]=e[parseInt(l.toString(),10)][n.idMapping],e.splice(l+1,0,a),er(i,e[parseInt(l.toString(),10)],r,n,o,a)):(Object.prototype.hasOwnProperty.call(e[parseInt(l.toString(),10)],n.childMapping)||(e[parseInt(l.toString(),10)][n.childMapping]=[]),e[parseInt(l.toString(),10)][n.childMapping].push(a.taskData),er(i,e[parseInt(l.toString(),10)],r,n,o,a)):"Above"===n.editSettings.newRowPosition?(e.splice(l,0,a.taskData),(0,S.isNullOrUndefined)(a.parentItem)||er(i,e[parseInt(l.toString(),10)],r,n,o,a)):"Below"===n.editSettings.newRowPosition&&(e.splice(l+1,0,a.taskData),(0,S.isNullOrUndefined)(a.parentItem)||er(i,e[parseInt(l.toString(),10)],r,n,o,a)):(e.splice(l,1),e.length||(d=!0))}else(0,S.isNullOrUndefined)(e[parseInt(l.toString(),10)][n.childMapping])||Zt(e[parseInt(l.toString(),10)][n.childMapping],t,r,i,n,o,a,s)&&er(i,e[parseInt(l.toString(),10)],r,n,o);return d}function er(e,t,r,i,n,o){if("Above"!==i.editSettings.newRowPosition&&"Below"!==i.editSettings.newRowPosition||"add"!==r&&"batchsave"!==r||(0,S.isNullOrUndefined)(o.parentItem)){var a,s=i.grid.getCurrentViewRecords();if(s.map((function(r,i){r[""+e]!==t[""+e]||(a=i)})),i.enableVirtualization&&(0,S.isNullOrUndefined)(a)){var d=(0,S.getValue)("uniqueIDCollection."+o.parentUniqueID,i);t=d}if((0,S.isNullOrUndefined)(a)||(t=s[parseInt(a.toString(),10)]),i.enableVirtualization&&(0,S.isNullOrUndefined)(t)&&!(0,S.isNullOrUndefined)(o)&&(t=(0,S.getValue)("uniqueIDCollection."+o.parentUniqueID,i)),n||(0,S.isNullOrUndefined)(t.childRecords)||!t.childRecords.length?t.hasChildRecords=!1:t.hasChildRecords=!0,"add"===r||"batchsave"===r){t.expanded=!0,t.hasChildRecords=!0,i.sortSettings.columns.length&&(0,S.isNullOrUndefined)(o)&&(o=s.filter((function(e){return e.parentUniqueID===t.uniqueID?e:null})));var l=o?o instanceof Array?o[0]:o:s[a+1];"Below"!==i.editSettings.newRowPosition&&(Object.prototype.hasOwnProperty.call(t,"childRecords")?(0,S.isNullOrUndefined)(o)||t[""+e]===o[""+e]||t.childRecords.push(o):t.childRecords=[],-1===t.childRecords.indexOf(l)&&t[""+e]!==o[""+e]&&t.childRecords.unshift(l),n&&(Object.prototype.hasOwnProperty.call(t,i.childMapping)||(t[i.childMapping]=[]),-1===t[""+i.childMapping].indexOf(l)&&t[""+e]!==o[""+e]&&t[i.childMapping].unshift(l)))}for(var p=i.grid.getPrimaryKeyFieldNames()[0],h=i.grid.dataSource instanceof ct.DataManager?i.grid.dataSource.dataSource.json:i.grid.dataSource,c=0;c<h.length;c++)if(h[parseInt(c.toString(),10)][""+p]===t[""+p]){h[parseInt(c.toString(),10)]=t;break}i.grid.setRowData(e,t);var u=i.getRowByIndex(a);"Batch"===i.editSettings.mode&&(u="add"===r?i.getRows()[i.grid.getCurrentViewRecords().indexOf(t)]:i.getRows()[i.grid.getRowIndexByPrimaryKey(t[""+e])]);var g=void 0;if((i.frozenRows||i.getFrozenColumns())&&(g=i.getRowByIndex(a)),!i.enableVirtualization&&!(0,S.isNullOrUndefined)(u)||!(0,S.isNullOrUndefined)(g)){var f=i.treeColumnIndex;i.allowRowDragAndDrop&&i.enableImmutableMode&&(f+=1),i.renderModule.cellRender({data:t,cell:u.cells[parseInt(f.toString(),10)]?u.cells[parseInt(f.toString(),10)]:g.cells[f-i.getFrozenColumns()],column:i.grid.getColumns()[i.treeColumnIndex],requestType:r}),(i.enableImmutableMode&&"indenting"===i.action||"outdenting"===i.action)&&i.renderModule.RowModifier({data:t,row:u})}}else xt(i,o.parentItem.uniqueID).childRecords.push(o)}var tr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),rr=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tr(t,e),rr([(0,S.Property)(!1)],t.prototype,"enableCache",void 0),rr([(0,S.Property)(3)],t.prototype,"maxBlocks",void 0),rr([(0,S.Property)(3)],t.prototype,"initialBlocks",void 0),t}(S.ChildProperty),nr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),or=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ar=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.dataResults={},n.uniqueIDCollection={},n.uniqueIDFilterCollection={},n.changedRecords="changedRecords",n.deletedRecords="deletedRecords",n.addedRecords="addedRecords",n.indentOutdentAction="indentOutdentAction",n.modifiedRecords=[],n.stackedHeader=!1,n.objectEqualityChecker=function(e,t){if(e){for(var r=Object.keys(e),i=!0,n=["Children","childRecords","taskData","uniqueID","parentItem","parentUniqueID","index"],o=0;o<r.length;o++)if(!(e[r[parseInt(o.toString(),10)]]===t[r[parseInt(o.toString(),10)]]||-1!==n.indexOf(r[parseInt(o.toString(),10)])||e[r[parseInt(o.toString(),10)]]instanceof Date&&t[r[parseInt(o.toString(),10)]]instanceof Date&&e[r[parseInt(o.toString(),10)]].getTime()===t[r[parseInt(o.toString(),10)]].getTime())){i=!1;break}return i}return!1},r.Inject(Mt),(0,S.setValue)("mergePersistData",n.mergePersistTreeGridData,n),(0,S.isNullOrUndefined)(n.injectedModules.Logger)||x.Grid.Inject(x.Logger),n.grid=new x.Grid,n}var r;return nr(t,e),r=t,t.prototype.excelExport=function(e,t,r,i){return this.excelExportModule.Map(e,t,r,i,!1)},t.prototype.csvExport=function(e,t,r,i){return this.excelExportModule.Map(e,t,r,i,!0)},t.prototype.pdfExport=function(e,t,r,i){return this.pdfExportModule.Map(e,t,r,i)},t.prototype.serverExcelExport=function(e){this.isExcel=!0,this.exportTreeGrid(e)},t.prototype.serverPdfExport=function(e){this.isExcel=!1,this.exportTreeGrid(e)},t.prototype.serverCsvExport=function(e){this.isExcel=!0,this.exportTreeGrid(e)},t.prototype.exportTreeGrid=function(e){var t=this.grid.getDataModule().generateQuery(!0),r=(new ct.UrlAdaptor).processQuery(new ct.DataManager({url:""}),t),i=JSON.parse(r.data),n=JSON.parse(this.addOnPersist(["allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","columns","locale","searchSettings","idMapping","parentIdMapping","childMapping","treeColumnIndex"]));n.filterSettings.columns=i.where,n.searchSettings.fields=i.search&&i.search[0].fields||[],n.sortSettings.columns=i.sorted,n.columns=this.setHeaderText(n.columns,["field","headerText","type","format","visible","template","index","width","textAlign","headerTextAlign","columns"]);var o=this.createElement("form",{id:"ExportForm",styles:"display:none;"}),a=this.createElement("input",{id:"treeGridInput",attrs:{name:"treeGridModel"}});a.value=JSON.stringify(n),o.method="POST",o.action=e,o.appendChild(a),document.body.appendChild(o),o.submit(),o.remove()},t.prototype.setHeaderText=function(e,t){for(var r=0;r<e.length;r++){var i=this.getColumnByUid(e[parseInt(r.toString(),10)].uid);this.stackedHeader&&(0,S.isNullOrUndefined)(i)&&(i=(0,S.isNullOrUndefined)(e[parseInt(r.toString(),10)].field)?e[parseInt(r.toString(),10)]:this.getColumnByField(e[parseInt(r.toString(),10)].field)),e[parseInt(r.toString(),10)].headerText=i.headerText,(0,S.isNullOrUndefined)(i.template)||(e[parseInt(r.toString(),10)].template="true"),e[parseInt(r.toString(),10)].format&&(e[parseInt(r.toString(),10)].format=(0,x.getNumberFormat)(this.getFormat(i.format),i.type,!1,this.currencyCode),this.isExcel||"datetime"!==i.type&&"date"!==i.type||(e[parseInt(r.toString(),10)].format=e[parseInt(r.toString(),10)].format.toString().replace("AM/PM","tt")),e[parseInt(r.toString(),10)].type=i.type),e[parseInt(r.toString(),10)].columns&&this.setHeaderText(e[parseInt(r.toString(),10)].columns,t);for(var n=Object.keys(e[parseInt(r.toString(),10)]),o=0;o<n.length;o++)t.indexOf(n[parseInt(o.toString(),10)])<0&&delete e[parseInt(r.toString(),10)][n[parseInt(o.toString(),10)]]}return e},t.prototype.getFormat=function(e){return"object"==typeof e?(0,S.isNullOrUndefined)(e.format)?e.skeleton:e.format:e},t.prototype.getModuleName=function(){return"treegrid"},t.prototype.preRender=function(){this.TreeGridLocale(),this.initProperties(),this.defaultLocale={Above:"Above",Below:"Below",Child:"Child",AddRow:"Add Row",ExpandAll:"Expand All",CollapseAll:"Collapse All",RowIndent:"Indent",RowOutdent:"Outdent"},this.l10n=new S.L10n("treegrid",this.defaultLocale,this.locale),this.isSelfReference&&(0,S.isNullOrUndefined)(this.childMapping)&&(this.childMapping="Children")},t.prototype.sortByColumn=function(e,t,r){this.sortModule&&this.sortModule.sortColumn(e,t,r)},t.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},t.prototype.removeSortColumn=function(e){this.sortModule&&this.sortModule.removeSortColumn(e)},t.prototype.search=function(e){this.grid.search(e)},t.prototype.autoFitColumns=function(e){this.resizeModule.autoFitColumns(e),this.updateColumnModel()},t.prototype.reorderColumns=function(e,t){this.grid.reorderColumns(e,t)},t.prototype.TreeGridLocale=function(){var e,t,r=S.L10n.locale,i={};(0,S.setValue)(this.locale,{},i),e=(0,x.getObject)(this.locale,r),t=(0,x.getObject)(this.getModuleName(),e),(0,S.setValue)("grid",t,(0,x.getObject)(this.locale,i)),S.L10n.load(i)},t.prototype.print=function(){this.printModule.print()},t.prototype.treeGridkeyActionHandler=function(e){if(this.allowKeyboard){var t=void 0,r=void 0,i=void 0,n=void 0,o=void 0;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"ctrlShiftUpArrow":i=(t=e.target).closest(".e-rowcell"),(0,S.isNullOrUndefined)(i)||(n=i.closest("tr"),(0,S.isNullOrUndefined)(n)||(0,S.isNullOrUndefined)(n.getElementsByClassName("e-treegridexpand")[0])||this.expandCollapseRequest(n.querySelector(".e-treegridexpand")));break;case"ctrlShiftDownArrow":i=(t=e.target).closest(".e-rowcell"),(0,S.isNullOrUndefined)(i)||(n=i.closest("tr"),(0,S.isNullOrUndefined)(n)||(0,S.isNullOrUndefined)(n.getElementsByClassName("e-treegridcollapse")[0])||this.expandCollapseRequest(n.querySelector(".e-treegridcollapse")));break;case"downArrow":if(!this.enableVirtualization){var a=(r=(t=e.target).parentElement).cellIndex;if("dropdownedit"===this.grid.getColumnByIndex(a).editType&&(0,S.isNullOrUndefined)(this.grid.getColumnByIndex(a).edit.obj)&&(r=t),null!==(o=this.findnextRowElement(r))){var s=o.rowIndex;this.selectRow(s);var d=e.target.cellIndex,l=o.children[parseInt(d.toString(),10)];(0,S.addClass)([l],"e-focused"),(0,S.addClass)([l],"e-focus")}else this.clearSelection()}break;case"upArrow":if(!this.enableVirtualization)if(a=(r=(t=e.target).parentElement).cellIndex,"dropdownedit"===this.grid.getColumnByIndex(a).editType&&(0,S.isNullOrUndefined)(this.grid.getColumnByIndex(a).edit.obj)&&(r=t),null!==(o=this.findPreviousRowElement(r))){var p=o.rowIndex;this.selectRow(p);var h=e.target.cellIndex,c=o.children[parseInt(h.toString(),10)];(0,S.addClass)([c],"e-focused"),(0,S.addClass)([c],"e-focus")}else this.clearSelection()}}},t.prototype.findnextRowElement=function(e){var t=e.nextElementSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findnextRowElement(t)),t},t.prototype.findPreviousRowElement=function(e){var t=e.previousElementSibling;return null===t||-1===t.className.indexOf("e-summaryrow")&&"none"!==t.style.display||(t=this.findPreviousRowElement(t)),t},t.prototype.initProperties=function(){this.defaultLocale={},this.flatData=[],this.infiniteScrollData=[],this.remoteCollapsedData=[],this.remoteExpandedData=[],this.parentData=[],this.columnModel=[],this.isExpandAll=!1,this.isCollapseAll=!1,this.keyConfigs={ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlShiftUpArrow:"ctrl+shift+uparrow",ctrlShiftDownArrow:"ctrl+shift+downarrow",downArrow:"downArrow",upArrow:"upArrow"},this.isLocalData=!(this.dataSource instanceof ct.DataManager)||this.dataSource.dataSource.offline||!(0,S.isNullOrUndefined)(this.dataSource.ready)||this.dataSource.adaptor instanceof ct.RemoteSaveAdaptor,this.isSelfReference=!(0,S.isNullOrUndefined)(this.parentIdMapping)},t.prototype.wireEvents=function(){S.EventHandler.add(this.grid.element,"click",this.mouseClickHandler,this),S.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),S.EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this),this.keyboardModule=new S.KeyboardEvents(this.element,{keyAction:this.treeGridkeyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex)},t.prototype.requiredModules=function(){var e=[];if(this.grid.splitFrozenCount(this.getColumns()),this.isDestroyed)return e;e.push({member:"filter",args:[this,this.filterSettings]}),(0,S.isNullOrUndefined)(this.toolbar)||e.push({member:"toolbar",args:[this]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this]}),this.aggregates.length>0&&e.push({member:"summary",args:[this]}),e.push({member:"resize",args:[this]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this]});var t=this.injectedModules.filter((function(e){return"freeze"===e.prototype.getModuleName()}));return(this.frozenColumns||this.frozenRows||this.getFrozenColumns()||this.grid.getFrozenLeftColumnsCount()||this.grid.getFrozenRightColumnsCount()||t.length)&&e.push({member:"freeze",args:[this]}),this.detailTemplate&&e.push({member:"detailRow",args:[this]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this]}),this.showColumnChooser&&e.push({member:"ColumnChooser",args:[this]}),this.extendRequiredModules(e),e},t.prototype.extendRequiredModules=function(e){var t=this.injectedModules.filter((function(e){return"rowDragAndDrop"===e.prototype.getModuleName()}));(this.allowRowDragAndDrop||t.length)&&((0,S.isNullOrUndefined)(this.toolbar)||!this.toolbar.includes("Indent")&&!this.toolbar.includes("Outdent")||(this.isIndentEnabled=!0),e.push({member:"rowDragAndDrop",args:[this]})),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this]}),this.allowSelection&&e.push({member:"selection",args:[this]}),this.enableVirtualization&&e.push({member:"virtualScroll",args:[this]}),this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this]}),e.push({member:"logger",args:[this.grid]})},t.prototype.isCommandColumn=function(e){var t=this;return e.some((function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)}))},t.prototype.unwireEvents=function(){this.grid&&this.grid.element&&S.EventHandler.remove(this.grid.element,"click",this.mouseClickHandler)},t.prototype.log=function(e,t){this.loggerModule&&this.loggerModule.treeLog(e,t,this)},t.prototype.render=function(){var e=this;this.isReact&&(this.grid.isReact=!0,this.grid.portals=[]),this.isVue&&(this.grid.isVue=!0,this.grid.vueInstance=this.vueInstance),(0,qt.createSpinner)({target:this.element},this.createElement),this.log(["mapping_fields_missing"]),this.renderModule=new Vt(this),this.dataModule=new Bt(this),this.printModule=new Ot(this),this.trigger(T),this.autoGenerateColumns(),this.initialRender=!0,(0,S.isNullOrUndefined)(this.dataSource)||this.convertTreeData(this.dataSource),this.loadGrid(),this.element.classList.contains("e-treegrid")&&this.rowDropSettings.targetID&&(this.grid.rowDropSettings.targetID+="_gridcontrol"),this.addListener();var t=(0,S.createElement)("div",{id:this.element.id+"_gridcontrol"});(0,S.addClass)([this.element],"e-treegrid"),(0,S.isNullOrUndefined)(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),(0,S.isNullOrUndefined)(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.element.appendChild(t);var r=this.grid.requiredModules;this.grid.requiredModules=function(){var e=[];e=r.apply(this);for(var t=0;t<e.length;t++)"virtualscroll"===e[parseInt(t.toString(),10)].member&&(e[parseInt(t.toString(),10)].member="treeVirtualScroll");return e};var i="root";this.grid[""+i]=this[""+i]?this[""+i]:this,this.grid.appendTo(t),this.element.getElementsByClassName("e-gridcontent")[0].childNodes[0].setAttribute("tabindex","0"),this.element.getElementsByClassName("e-content")[0].querySelector(".e-table").setAttribute("role","treegrid"),this.isIndentEnabled&&this.refreshToolbarItems(),this.wireEvents(),this.renderComplete();var n="destroyTemplate",o=this.grid[""+n];this.grid[""+n]=function(t,r){o.apply(e.grid),e.isReact&&(0,S.isNullOrUndefined)(e.portals)||e.clearTemplate(t,r)}},t.prototype.refreshToolbarItems=function(){var e=this.toolbarModule.getToolbar(),t=this.element.id+"_gridcontrol_indent",r=this.element.id+"_gridcontrol_outdent",i=e.querySelector("#"+t).parentElement,n=e.querySelector("#"+r).parentElement;i.classList.add("e-hidden"),n.classList.add("e-hidden")},t.prototype.afterGridRender=function(){(0,S.isNullOrUndefined)(this.grid.clipboardModule)||this.grid.clipboardModule.destroy(),this.clipboardModule=this.grid.clipboardModule=new pt(this,this.grid.serviceLocator)},t.prototype.convertTreeData=function(e){var t=this;if(gt(this)&&(e=(0,S.getValue)("result",e)),e instanceof Array&&e.length>0&&Object.prototype.hasOwnProperty.call(e[0],"level"))this.flatData=e,this.flatData.filter((function(e){(0,S.setValue)("uniqueIDCollection."+e.uniqueID,e,t),0===e.level&&t.parentData.push(e)}));else if(gt(this)){var r=(0,S.getValue)("result",this.dataSource);this.dataModule.convertToFlatData(r)}else this.dataModule.convertToFlatData(e)},t.prototype.bindGridProperties=function(){this.bindedDataSource(),this.grid.enableRtl=this.enableRtl,this.grid.allowKeyboard=this.allowKeyboard,this.grid.columns=this.getGridColumns(this.columns),this.grid.allowExcelExport=this.allowExcelExport,this.grid.allowPdfExport=this.allowPdfExport,this.grid.query=this.query,this.grid.columnQueryMode=this.columnQueryMode,this.grid.allowPaging=this.allowPaging,this.grid.pageSettings=(0,x.getActualProperties)(this.pageSettings),this.grid.pagerTemplate=this.pagerTemplate,this.grid.showColumnMenu=this.showColumnMenu,this.grid.allowSorting=this.allowSorting,this.grid.allowFiltering=this.allowFiltering,this.grid.enableVirtualization=this.enableVirtualization,this.grid.enableColumnVirtualization=this.enableColumnVirtualization,this.grid.enableInfiniteScrolling=this.enableInfiniteScrolling,this.grid.infiniteScrollSettings=this.infiniteScrollSettings,this.grid.enableVirtualMaskRow=this.enableVirtualMaskRow,this.grid.loadingIndicator=this.loadingIndicator,this.grid.width=this.width,this.grid.height=this.height,this.grid.enableAltRow=this.enableAltRow,this.grid.allowReordering=this.allowReordering,this.grid.allowTextWrap=this.allowTextWrap,this.grid.allowResizing=this.allowResizing,this.grid.enableHover=this.enableHover,this.grid.enableAutoFill=this.enableAutoFill,this.grid.enableAdaptiveUI=this.enableAdaptiveUI,this.grid.enableImmutableMode=this.enableImmutableMode,this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop,this.grid.rowDropSettings=(0,x.getActualProperties)(this.rowDropSettings),this.grid.rowHeight=this.rowHeight,this.grid.gridLines=this.gridLines,this.grid.allowSelection=this.allowSelection,this.grid.toolbar=(0,x.getActualProperties)(this.getGridToolbar()),this.grid.toolbarTemplate=this.toolbarTemplate,this.grid.showColumnChooser=this.showColumnChooser,this.grid.filterSettings=(0,x.getActualProperties)(this.filterSettings),this.grid.selectionSettings=(0,x.getActualProperties)(this.selectionSettings),this.grid.sortSettings=(0,x.getActualProperties)(this.sortSettings),this.grid.searchSettings=(0,x.getActualProperties)(this.searchSettings),this.grid.aggregates=(0,x.getActualProperties)(this.aggregates),this.grid.textWrapSettings=(0,x.getActualProperties)(this.textWrapSettings),this.grid.printMode=(0,x.getActualProperties)(this.printMode),this.grid.locale=(0,x.getActualProperties)(this.locale),this.grid.selectedRowIndex=this.selectedRowIndex,this.grid.contextMenuItems=(0,x.getActualProperties)(this.getContextMenu()),this.grid.columnMenuItems=(0,x.getActualProperties)(this.columnMenuItems),this.grid.editSettings=this.getGridEditSettings(),this.grid.rowTemplate=(0,x.getActualProperties)(this.rowTemplate),this.grid.detailTemplate=(0,x.getActualProperties)(this.detailTemplate),this.grid.frozenRows=this.frozenRows,this.grid.frozenColumns=this.frozenColumns,this.grid.clipMode=(0,x.getActualProperties)(this.clipMode);var e="templateDotnetInstance";this.grid[""+e]=this[""+e],this.grid.isJsComponent=!0,this.grid.enableHtmlSanitizer=this.enableHtmlSanitizer},t.prototype.triggerEvents=function(e){this.trigger((0,x.getObject)("name",e),e)},t.prototype.IsExpandCollapseClicked=function(e){(0,S.isNullOrUndefined)(e.target)||!(e.target.classList.contains("e-treegridexpand")||e.target.classList.contains("e-treegridcollapse")||e.target.classList.contains("e-summarycell"))||this.selectionSettings.checkboxOnly||!(!(0,S.isNullOrUndefined)(e.data)&&e.data.hasChildRecords||-1!==e.rowIndex&&(0,S.isNullOrUndefined)(e.data))||(e.cancel=!0)},t.prototype.bindGridEvents=function(){var e=this;this.grid.rowSelecting=function(t){e.IsExpandCollapseClicked(t),e.trigger(Q,t)},this.grid.rowDeselecting=function(t){e.IsExpandCollapseClicked(t),e.trigger(We,t)},this.grid.rowSelected=function(t){if(e.enableVirtualization&&t.isHeaderCheckboxClicked&&e.grid.currentViewData.length!==e.grid.selectionModule.selectedRowIndexes.length)for(var r=0;r<e.getRows().length;r++)e.getRows()[parseInt(r.toString(),10)].getElementsByClassName("e-frame e-icons e-uncheck").length&&e.grid.selectionModule.updateRowSelection(e.getRows()[parseInt(r.toString(),10)],e.getCurrentViewRecords()[parseInt(r.toString(),10)].index);e.selectedRowIndex=e.grid.selectedRowIndex,e.notify(K,t),e.trigger(K,t)},this.grid.rowDeselected=function(t){e.selectedRowIndex=e.grid.selectedRowIndex,(0,S.isNullOrUndefined)(t.data)||e.notify(Y,t),e.trigger(Y,t)},this.grid.resizeStop=function(t){e.updateColumnModel(),e.trigger(Z,t)},this.grid.excelQueryCellInfo=function(t){e.notify("excelCellInfo",t),t=e.dataResults},this.grid.pdfQueryCellInfo=function(t){e.notify("pdfCellInfo",t),t=e.dataResults},this.grid.checkBoxChange=function(t){e.trigger(W,t)},this.grid.pdfExportComplete=this.triggerEvents.bind(this),this.grid.excelExportComplete=this.triggerEvents.bind(this),this.grid.excelHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.pdfHeaderQueryCellInfo=this.triggerEvents.bind(this),this.grid.dataSourceChanged=this.triggerEvents.bind(this),this.grid.recordDoubleClick=this.triggerEvents.bind(this),this.grid.cellDeselected=this.triggerEvents.bind(this),this.grid.cellDeselecting=this.triggerEvents.bind(this),this.grid.columnMenuOpen=this.triggerEvents.bind(this),this.grid.columnMenuClick=this.triggerEvents.bind(this),this.grid.cellSelected=this.triggerEvents.bind(this),this.grid.headerCellInfo=this.triggerEvents.bind(this),this.grid.resizeStart=this.triggerEvents.bind(this),this.grid.resizing=this.triggerEvents.bind(this),this.grid.columnDrag=this.triggerEvents.bind(this),this.grid.columnDragStart=this.triggerEvents.bind(this),this.grid.columnDrop=this.triggerEvents.bind(this),this.grid.beforePrint=this.triggerEvents.bind(this),this.grid.beforeCopy=this.triggerEvents.bind(this),this.grid.beforePaste=function(t){for(var r=e.getRows(),i="rowIndex";r[t[""+i]].classList.contains("e-summaryrow");)t[""+i]++;e.trigger(he,t)},this.grid.load=function(){e.grid.on("initial-end",e.afterGridRender,e),(0,S.isNullOrUndefined)(e.loggerModule)||(e.loggerModule=e.grid.loggerModule=new V(e.grid))},this.grid.printComplete=this.triggerEvents.bind(this),this.grid.actionFailure=this.triggerEvents.bind(this),this.extendedGridDataBoundEvent(),this.extendedGridEvents(),this.extendedGridActionEvents(),this.extendedGridEditEvents(),this.bindGridDragEvents(),this.bindCallBackEvents()},t.prototype.lastRowBorder=function(e,t){for(var r=0;r<e.cells.length;r++)t?(0,S.addClass)([e.cells[parseInt(r.toString(),10)]],"e-lastrowcell"):(0,S.removeClass)([e.cells[parseInt(r.toString(),10)]],"e-lastrowcell")},t.prototype.isPixelHeight=function(){return"auto"!==this.height&&-1===this.height.toString().indexOf("%")},t.prototype.extendedGridDataBoundEvent=function(){var e=this;this.grid.dataBound=function(t){if(e.updateRowTemplate(),e.updateColumnModel(),e.updateAltRow(e.getRows()),e.notify("dataBoundArg",t),ut(e)&&!wt(e)&&!e.hasChildMapping){var r;r=e.dataResults.result?0:1,(0,S.setValue)("grid.contentModule.isLoaded",!(r>0),e)}if(e.isPixelHeight()&&e.initialRender)for(var i=e.getContentTable().rows,n=[].slice.call(i),o=n.length-1;o>0;o--)if(!Ct(n[parseInt(o.toString(),10)])){n[parseInt(o.toString(),10)].nextElementSibling&&e.lastRowBorder(n[parseInt(o.toString(),10)],!0);break}var a="action";if(e.enableVirtualization&&e.selectionSettings.persistSelection&&("expand"===e.dataResults[""+a]||"collapse"===e.dataResults[""+a])&&(e.grid.selectionModule.refreshPersistSelection(),"Single"===e.grid.selectionSettings.type)){var s=e.getCurrentViewRecords().indexOf(e.grid.selectionModule.data);e.grid.selectionModule.updateRowSelection(e.getRows()[parseInt(s.toString(),10)],s)}e.trigger(j,t),e.initialRender=!1};var t=this;this.grid.beforeDataBound=function(e){var r=(0,x.getObject)("action",e);if((ut(t)&&!wt(t)||gt(this))&&"edit"!==r)t.notify("updateRemoteLevel",e),e=t.dataResults;else if(0===t.flatData.length&&wt(t)&&t.dataSource instanceof ct.DataManager){var i=t.dataSource;t.dataModule.convertToFlatData(i.dataSource.json),e.result=t.grid.dataSource.dataSource.json=t.flatData}if(ut(t)||gt(this)||(0,S.isNullOrUndefined)(t.dataSource)||(this.isPrinting&&(0,S.setValue)("isPrinting",!0,e),t.notify("dataProcessor",e)),(0,S.extend)(e,t.dataResults),t.enableImmutableMode&&(e.result=e.result.slice()),t.initialRender&&(this.contentModule.objectEqualityChecker=t.objectEqualityChecker),!this.isPrinting){var n=new ct.Deferred;return t.trigger(F,e,(function(e){n.resolve(e)})),n}},this.grid.log=function(t,r){e.loggerModule&&e.loggerModule.log(t,r)}},t.prototype.bindCallBackEvents=function(){var e=this;this.grid.toolbarClick=function(t){if(!(t.item.id===e.grid.element.id+"_excelexport"&&!1===e.allowExcelExport||t.item.id===e.grid.element.id+"_pdfexport"&&!1===e.allowPdfExport||t.item.id===e.grid.element.id+"_csvexport"&&!1===e.allowExcelExport)){var r=new ct.Deferred;return e.trigger(J,t,(function(i){i.cancel||e.notify(J,t),r.resolve(i)})),r}},this.grid.cellSelecting=function(t){var r=e.grid.selectionModule.actualTarget;(0,S.isNullOrUndefined)(r)||!r.classList.contains("e-treegridexpand")&&!r.classList.contains("e-treegridcollapse")||(t.cancel=!0);var i=new ct.Deferred;return e.trigger((0,x.getObject)("name",t),t,(function(e){i.resolve(e)})),i},this.grid.beginEdit=function(t){if((0,S.isNullOrUndefined)(t.row)||!t.row.classList.contains("e-summaryrow")){var r=new ct.Deferred;return e.trigger(ge,t,(function(e){r.resolve(e)})),r}t.cancel=!0}},t.prototype.extendedGridEditEvents=function(){var e=this;this.grid.dataStateChange=function(t){e.isExpandRefresh?(e.isExpandRefresh=!1,e.grid.dataSource={result:e.flatData,count:(0,S.getValue)("count",e.grid.dataSource)}):("infiniteScroll"!==t.action.requestType&&(e.infiniteScrollData=[]),e.trigger(H,t))},this.grid.cellSave=function(t){if(e.grid.isContextMenuOpen()){var r=e.grid.contextMenuModule.contextMenu.element.getElementsByClassName("e-selected")[0];((0,S.isNullOrUndefined)(r)||r.id!==e.element.id+"_gridcontrol_cmenu_Save")&&(t.cancel=!0)}var i=new ct.Deferred;return e.trigger(me,t,(function(t){t.cancel||e.notify(me,t),i.resolve(t)})),i},this.grid.cellSaved=function(t){e.trigger(Se,t),e.notify(Se,t)},this.grid.cellEdit=function(t){var r=new ct.Deferred;return t.promise=r,e.notify(ve,t),r},this.grid.batchAdd=function(t){e.trigger(Re,t),e.notify(Re,t)},this.grid.beforeBatchSave=function(t){e.trigger(be,t),e.notify(be,t)},this.grid.beforeBatchAdd=function(t){e.trigger(Ce,t),e.notify(Ce,t)},this.grid.batchDelete=function(t){e.trigger(we,t),e.notify(we,t)},this.grid.beforeBatchDelete=function(t){e.trigger(xe,t),e.notify(xe,t)},this.grid.batchCancel=function(t){"Cell"!==e.editSettings.mode&&e.trigger(Ie,t),e.notify(Ie,t)}},t.prototype.updateRowTemplate=function(){var e=this;this.rowTemplate&&(this.isReact&&0===this.getContentTable().rows.length?setTimeout((function(){if(e.treeColumnRowTemplate(),e.enableCollapseAll)for(var t=e.getCurrentViewRecords(),r=e.getContentTable().rows,i=0;i<r.length;i++){var n={data:t[parseInt(i.toString(),10)],row:r[parseInt(i.toString(),10)]};e.renderModule.RowModifier(n)}}),0):this.treeColumnRowTemplate())},t.prototype.bindedDataSource=function(){var e="dataSource",t="ready";if(this.dataSource&&gt(this)){var r=this.flatData,i=(0,S.getValue)("count",this.dataSource);this.grid.dataSource={result:r,count:i}}else this.grid.dataSource=this.dataSource instanceof ct.DataManager?new ct.DataManager(this.dataSource.dataSource,this.dataSource.defaultQuery,this.dataSource.adaptor):this.flatData;if(this.dataSource instanceof ct.DataManager&&(this.dataSource.dataSource.offline||this.dataSource.ready)){this.grid.dataSource[""+e].json=It(this.dataSource[""+e].json),this.grid.dataSource[""+t]=this.dataSource.ready;var n=this;(0,S.isNullOrUndefined)(this.grid.dataSource[""+t])||this.grid.dataSource[""+t].then((function(t){var r=n.grid.dataSource;r[""+e].offline=!0,r.isDataAvailable=!0,r[""+e].json=t.result,r.adaptor=new ct.JsonAdaptor}))}},t.prototype.extendedGridActionEvents=function(){var e=this;this.grid.actionBegin=function(t){if("sorting"===t.requestType&&t.target&&t.target.parentElement&&t.target.parentElement.classList.contains("e-hierarchycheckbox")&&(t.cancel=!0),"reorder"===(0,x.getObject)("requestType",t)&&e.notify("getColumnIndex",{}),ut(e)&&e.enableVirtualization&&("virtualscroll"===t.requestType?(e.query.expand("VirtualScrollingAction"),e.showSpinner()):"searching"===t.requestType&&""===t.searchString?e.query.expand("ClearSearchingAction"):"clearFilter"===t.action&&e.query.expand("ClearFilteringAction")),e.notify("actionBegin",{editAction:t}),ut(e)||(0,S.isNullOrUndefined)(e.filterModule)||gt(e)||0!==e.grid.filterSettings.columns.length||0!==e.grid.searchSettings.key.length||(e.notify("clearFilters",{flatData:e.grid.dataSource}),e.grid.setProperties({dataSource:e.dataResults.result},!0),(0,S.isNullOrUndefined)(e.grid.changedProperties.dataSource)&&(e.grid.renderModule.data.dataManager=e.grid.dataSource instanceof ct.DataManager?e.grid.dataSource:(0,S.isNullOrUndefined)(e.grid.dataSource)?new ct.DataManager:new ct.DataManager(e.grid.dataSource),e.grid.renderModule.data.isQueryInvokedFromData=!0,e.grid.query=e.grid.query instanceof ct.Query?e.grid.query:new ct.Query)),"indenting"!==e.action&&"outdenting"!==e.action){var r=new ct.Deferred;return e.trigger(_,t,(function(t){t.cancel||e.notify(ge,t),r.resolve(t)})),r}},this.grid.actionComplete=function(t){if(e.notify("actioncomplete",t),e.updateColumnModel(),e.updateTreeGridModel(),"reorder"===t.requestType&&e.notify("setColumnIndex",{}),e.notify("actionComplete",{editAction:t}),"add"===t.requestType&&"Top"!==e.editSettings.newRowPosition&&"Bottom"!==e.editSettings.newRowPosition&&e.notify(fe,t),"batchsave"===t.requestType&&e.notify(De,t),e.notify("updateGridActions",t),"save"===t.requestType&&e.aggregates.map((function(e){return!0===e.showChildSummary})).length&&e.grid.refresh(),"filter"===t.action&&(""===e.filterModule.currentFilterObject||!e.enableVirtualization||e.initialRender||ut(e)&&e.enableVirtualization||e.expandAll()),"searching"===t.requestType&&(""===e.searchSettings.key||!e.enableVirtualization||e.initialRender||ut(e)&&e.enableVirtualization||e.expandAll()),"clearFilter"===t.action&&e.enableCollapseAll&&e.collapseAll(),"indenting"===e.action||"outdenting"===e.action){e.action="indenting"===e.action?"indented":"outdented";var r=[e.selectedRecords],i={data:r,dropIndex:e.dropIndex,dropPosition:e.dropPosition,modifiedRecords:e.modifiedRecords,requestType:e.action,row:e.selectedRows};e.trigger(G,i),e.getCurrentViewRecords().filter((function(e){return e.uniqueID===r[0].uniqueID})).length||e.refreshToolbarItems(),e.action="",e.selectedRecords=e.selectedRows=e.modifiedRecords=[]}else{if(e.grid.isFrozenGrid()&&e.enableVirtualization&&"movable"===t.tableName){var n=e.grid.element.querySelector("."+Je),o=e.grid.element.querySelector("."+$e);n.style.height=o.style.height="auto"}e.trigger(G,t)}}},t.prototype.extendedGridEvents=function(){var e=this,t=this;this.grid.recordDoubleClick=function(t){e.trigger(ye,t),e.notify(ye,t)},this.grid.detailDataBound=function(t){e.notify("detaildataBound",t),e.trigger(Te,t)},this.grid.rowDataBound=function(e){(0,S.isNullOrUndefined)(this.isPrinting)?(0,S.setValue)("isPrinting",!1,e):(0,S.setValue)("isPrinting",this.isPrinting,e),t.renderModule.RowModifier(e)},this.grid.queryCellInfo=function(e){(0,S.isNullOrUndefined)(this.isPrinting)?(0,S.setValue)("isPrinting",!1,e):(0,S.setValue)("isPrinting",this.isPrinting,e),t.renderModule.cellRender(e)},this.grid.contextMenuClick=function(t){e.notify(le,t),e.trigger(le,t)},this.grid.contextMenuOpen=function(t){e.notify(de,t),e.trigger(de,t)},this.grid.queryCellInfo=function(t){e.renderModule.cellRender(t)}},t.prototype.bindGridDragEvents=function(){var e=this;this.grid.rowDragStartHelper=function(t){e.trigger(je,t)},this.grid.rowDragStart=function(t){e.trigger(Fe,t)},this.grid.rowDrag=function(t){e.grid.isEdit?t.cancel=!0:(e.notify(Ge,t),e.trigger(Le,t))},this.grid.rowDrop=function(t){e.grid.isEdit||e.notify(Qe,t),t.cancel=!0}},t.prototype.loadGrid=function(){this.bindGridProperties(),this.bindGridEvents(),(0,S.setValue)("registeredTemplate",this.registeredTemplate,this.grid),(0,S.setValue)("viewContainerRef",this.viewContainerRef,this.grid)},t.prototype.autoGenerateColumns=function(){if(!this.columns.length&&!this.dataModule.isRemote()&&Object.keys(this.dataSource).length){this.columns=[];for(var e=this.dataSource[0],t=Object.keys(e),r=0;r<t.length;r++)-1===[this.childMapping,this.parentIdMapping].indexOf(t[parseInt(r.toString(),10)])&&this.columns.push(t[parseInt(r.toString(),10)])}},t.prototype.getGridEditSettings=function(){var e={},t="guid";switch(e.allowAdding=this.editSettings.allowAdding,e.allowEditing=this.editSettings.allowEditing,e.allowDeleting=this.editSettings.allowDeleting,e.newRowPosition="Bottom"===this.editSettings.newRowPosition?"Bottom":"Top",e.allowEditOnDblClick=this.editSettings.allowEditOnDblClick,e.showConfirmDialog=this.editSettings.showConfirmDialog,e.template=this.editSettings.template,e.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,e.allowNextRowEdit=this.editSettings.allowNextRowEdit,e[""+t]=this.editSettings[""+t],e.dialog=this.editSettings.dialog,this.editSettings.mode){case"Dialog":case"Batch":e.mode=this.editSettings.mode;break;case"Row":e.mode="Normal";break;case"Cell":e.mode="Normal",e.showConfirmDialog=!1}return e},t.prototype.getContextMenu=function(){if(this.contextMenuItems){for(var e=[],t=0;t<this.contextMenuItems.length;t++)switch(this.contextMenuItems[parseInt(t.toString(),10)]){case"AddRow":case Dt.AddRow:e.push({text:this.l10n.getConstant("AddRow"),target:".e-content",id:this.element.id+"_gridcontrol_cmenu_AddRow",items:[{text:this.l10n.getConstant("Above"),id:"Above"},{text:this.l10n.getConstant("Below"),id:"Below"},{text:this.l10n.getConstant("Child"),id:"Child"}]});break;case"Indent":case Dt.RowIndent:e.push({text:this.l10n.getConstant("RowIndent"),target:".e-content",iconCss:"e-indent e-icons",id:this.element.id+"_gridcontrol_cmenu_Indent"});break;case"Outdent":case Dt.RowOutdent:e.push({text:this.l10n.getConstant("RowOutdent"),target:".e-content",iconCss:"e-outdent e-icons",id:this.element.id+"_gridcontrol_cmenu_Outdent"});break;default:e.push(this.contextMenuItems[parseInt(t.toString(),10)])}return e}return null},t.prototype.getGridToolbar=function(){if(this.toolbar){this.l10n=new S.L10n("treegrid",this.defaultLocale,this.locale);for(var e=[],t=void 0,r=0;r<this.toolbar.length;r++)switch(this.toolbar[parseInt(r.toString(),10)]){case"Search":case bt.Search:e.push("Search");break;case"Print":case bt.Print:e.push("Print");break;case"ExpandAll":case bt.ExpandAll:t=this.l10n.getConstant("ExpandAll"),e.push({text:t,tooltipText:t,prefixIcon:"e-expand",id:this.element.id+"_gridcontrol_expandall"});break;case"CollapseAll":case bt.CollapseAll:t=this.l10n.getConstant("CollapseAll"),e.push({text:t,tooltipText:t,prefixIcon:"e-collapse",id:this.element.id+"_gridcontrol_collapseall"});break;case"Indent":case bt.RowIndent:t=this.l10n.getConstant("RowIndent"),e.push({text:t,tooltipText:t,prefixIcon:"e-indent",id:this.element.id+"_gridcontrol_indent"});break;case"Outdent":case bt.RowOutdent:t=this.l10n.getConstant("RowOutdent"),e.push({text:t,tooltipText:t,prefixIcon:"e-outdent",id:this.element.id+"_gridcontrol_outdent"});break;default:e.push(this.toolbar[parseInt(r.toString(),10)])}return e}return null},t.prototype.getGridColumns=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=0);var i,n,o=e;t&&(this.columnModel=[]),0===this.columnModel.length&&(r=0===r?-1:r);for(var a=[],s=0;s<o.length;s++){r+=1;var d=this.grid.getColumnByUid(o[parseInt(s.toString(),10)].uid);if(n=d||{},i={},"string"==typeof this.columns[parseInt(s.toString(),10)])n.field=i.field=this.columns[parseInt(s.toString(),10)];else for(var l=0,p=Object.keys(o[parseInt(s.toString(),10)]);l<p.length;l++){var h=p[l];r===this.treeColumnIndex&&"template"===h?i[""+h]=o[parseInt(s.toString(),10)][""+h]:"columns"!==h||(0,S.isNullOrUndefined)(o[parseInt(s.toString(),10)][""+h])?this.initialRender&&!(0,S.isNullOrUndefined)(d)&&this.enablePersistence&&"edit"===h?n[""+h]=i[""+h]=d[""+h]:d&&"sortComparer"===h||(n[""+h]=i[""+h]=o[parseInt(s.toString(),10)][""+h]):(n[""+h]=this.getGridColumns(o[parseInt(s.toString(),10)][""+h],!1,this.columnModel.length-1),i[""+h]=o[parseInt(s.toString(),10)][""+h])}i.columns||this.columnModel.push(new w(i)),a.push(n),!(0,S.isNullOrUndefined)(this.columnModel[this.treeColumnIndex])&&this.enableRtl&&n.field===this.columnModel[this.treeColumnIndex].field&&((0,S.isNullOrUndefined)(this.treeColumnTextAlign)&&(this.treeColumnTextAlign=this.columnModel[this.treeColumnIndex].textAlign,this.treeColumnField=this.columnModel[this.treeColumnIndex].field),n.textAlign="Right")}return a},t.prototype.onPropertyChanged=function(e){for(var t=!1,r=0,i=Object.keys(e);r<i.length;r++){var n=i[r];switch(n){case"treeColumnIndex":this.grid.refreshColumns();break;case"allowPaging":this.grid.allowPaging=this.allowPaging;break;case"pageSettings":this.grid.pageSettings=(0,x.getActualProperties)(this.pageSettings),t=!0;break;case"enableVirtualization":this.grid.enableVirtualization=this.enableVirtualization;break;case"enableColumnVirtualization":this.grid.enableColumnVirtualization=this.enableColumnVirtualization;break;case"toolbar":this.grid.toolbar=this.getGridToolbar();break;case"allowSelection":this.grid.allowSelection=this.allowSelection;break;case"selectionSettings":this.grid.selectionSettings=(0,x.getActualProperties)(this.selectionSettings);break;case"allowSorting":this.grid.allowSorting=this.allowSorting;break;case"allowMultiSorting":this.grid.allowMultiSorting=this.allowMultiSorting;break;case"sortSettings":this.grid.sortSettings=(0,x.getActualProperties)(this.sortSettings);break;case"searchSettings":this.grid.searchSettings=(0,x.getActualProperties)(this.searchSettings);break;case"allowFiltering":this.grid.allowFiltering=this.allowFiltering;break;case"filterSettings":this.initialRender||(this.grid.filterSettings=(0,x.getActualProperties)(this.filterSettings));break;case"showColumnMenu":this.grid.showColumnMenu=this.showColumnMenu;break;case"allowRowDragAndDrop":this.grid.allowRowDragAndDrop=this.allowRowDragAndDrop;break;case"aggregates":this.grid.aggregates=(0,x.getActualProperties)(this.aggregates);break;case"enableInfiniteScrolling":this.grid.enableInfiniteScrolling=this.enableInfiniteScrolling;break;case"dataSource":if(this.isLocalData=!(this.dataSource instanceof ct.DataManager)||!(0,S.isNullOrUndefined)(this.dataSource.ready)||this.dataSource.adaptor instanceof ct.RemoteSaveAdaptor,this.convertTreeData(this.dataSource),this.isLocalData){if(gt(this)){var o=(0,S.getValue)("count",this.dataSource);this.grid.dataSource={result:this.flatData,count:o}}else{var a=this.dataSource;this.grid.dataSource=a instanceof ct.DataManager?new ct.DataManager(a.dataSource,a.defaultQuery,a.adaptor):this.flatData}this.enableVirtualization&&(this.grid.contentModule.isDataSourceChanged=!0)}else this.bindedDataSource(),this.enableVirtualization&&(this.grid.contentModule.removeEventListener(),this.grid.contentModule.eventListener("on"),this.grid.contentModule.renderTable());break;case"query":this.grid.query=this.query;break;case"enableCollapseAll":e[""+n]?this.collapseAll():this.expandAll();break;case"expandStateMapping":this.grid.refresh();break;case"gridLines":this.grid.gridLines=this.gridLines;break;case"rowTemplate":this.grid.rowTemplate=(0,x.getActualProperties)(this.rowTemplate);break;case"frozenRows":this.grid.frozenRows=this.frozenRows;break;case"frozenColumns":this.grid.frozenColumns=this.frozenColumns;break;case"rowHeight":this.grid.rowHeight=this.rowHeight;break;case"height":(0,S.isNullOrUndefined)(this.height)||"string"!=typeof this.height||-1===this.height.indexOf("%")||(this.element.style.height=this.height),this.grid.height=this.height;break;case"width":(0,S.isNullOrUndefined)(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(this.element.style.width=this.width),this.grid.width=this.width;break;case"locale":this.grid.locale=this.locale,this.TreeGridLocale(),this.grid.toolbar=this.getGridToolbar(),this.grid.contextMenuItems=this.getContextMenu();break;case"selectedRowIndex":this.grid.selectedRowIndex=this.selectedRowIndex;break;case"enableAltRow":this.grid.enableAltRow=this.enableAltRow;break;case"enableHover":this.grid.enableHover=this.enableHover;break;case"enableAutoFill":this.grid.enableAutoFill=this.enableAutoFill;break;case"enableAdaptiveUI":this.grid.enableAdaptiveUI=this.enableAdaptiveUI;break;case"enableImmutableMode":this.grid.enableImmutableMode=this.enableImmutableMode;break;case"allowExcelExport":this.grid.allowExcelExport=this.allowExcelExport;break;case"allowPdfExport":this.grid.allowPdfExport=this.allowPdfExport;break;case"enableRtl":(0,S.isNullOrUndefined)(this.treeColumnField)||this.updateTreeColumnTextAlign(),this.grid.enableRtl=this.enableRtl;break;case"allowReordering":this.grid.allowReordering=this.allowReordering;break;case"allowResizing":this.grid.allowResizing=this.allowResizing;break;case"textWrapSettings":this.grid.textWrapSettings=(0,x.getActualProperties)(this.textWrapSettings);break;case"allowTextWrap":this.grid.allowTextWrap=(0,x.getActualProperties)(this.allowTextWrap),this.grid.refresh();break;case"contextMenuItems":this.grid.contextMenuItems=this.getContextMenu();break;case"showColumnChooser":this.grid.showColumnChooser=this.showColumnChooser;break;case"detailTemplate":this.grid.detailTemplate=(0,x.getActualProperties)(this.detailTemplate);break;case"columnMenuItems":this.grid.columnMenuItems=(0,x.getActualProperties)(this.columnMenuItems);break;case"editSettings":this.grid.isEdit&&"Normal"===this.grid.editSettings.mode&&e[""+n].mode&&("Cell"===e[""+n].mode||"Row"===e[""+n].mode)&&this.grid.closeEdit(),this.grid.editSettings=this.getGridEditSettings()}t&&this.grid.refresh()}},t.prototype.updateTreeColumnTextAlign=function(){this.grid.getColumnByField(this.treeColumnField).textAlign=this.enableRtl?"Right":this.treeColumnTextAlign,this.grid.refreshColumns()},t.prototype.destroy=function(){var t=this.element;if(t){var r=!(!t.querySelector(".e-gridheader")||!t.querySelector(".e-gridcontent"));r&&this.unwireEvents(),this.removeListener(),r&&e.prototype.destroy.call(this),this.grid&&this.grid.destroy(),this.dataModule&&this.dataModule.destroy();for(var i=["dataModule","sortModule","renderModule","filterModule","printModule","clipboardModule","excelExportModule","pdfExportModule","toolbarModule","summaryModule","reorderModule","resizeModule","pagerModule","keyboardModule","columnMenuModule","contextMenuModule","editModule","virtualScrollModule","selectionModule","detailRow","rowDragAndDropModule","freezeModule"],n=0;n<i.length;n++)this[i[parseInt(n.toString(),10)]]&&(this[i[parseInt(n.toString(),10)]]=null);this.element.innerHTML="",this.grid=null}},t.prototype.dataBind=function(){(0,S.isNullOrUndefined)(this.grid)||(!(0,S.isNullOrUndefined)(this.rowDropSettings.targetID)&&(0,S.isNullOrUndefined)(document.getElementById(this.grid.rowDropSettings.targetID))&&(document.getElementById(this.rowDropSettings.targetID).id=this.grid.rowDropSettings.targetID,this.rowDropSettings.targetID=this.grid.rowDropSettings.targetID),e.prototype.dataBind.call(this),this.grid.dataBind())},t.prototype.getPersistData=function(){for(var e=["pageSettings","sortSettings","filterSettings","columns","searchSettings","selectedRowIndex","treeColumnIndex"],t={pageSettings:["template","pageSizes","pageSizeMode","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent","hierarchyMode"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[]},r=0;r<e.length;r++)for(var i=this[e[parseInt(r.toString(),10)]],n=0,o=t[e[parseInt(r.toString(),10)]];!(0,S.isNullOrUndefined)(o)&&n<o.length;n++)delete i[""+o[parseInt(n.toString(),10)]];return this.ignoreInArrays(["filter","edit","filterBarTemplate","headerTemplate","template","commandTemplate","commands","dataSource"],this.columns),this.addOnPersist(e)},t.prototype.ignoreInArrays=function(e,t){for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)].columns?(this.ignoreInColumn(e,t[parseInt(r.toString(),10)]),this.ignoreInArrays(e,t[parseInt(r.toString(),10)].columns)):this.ignoreInColumn(e,t[parseInt(r.toString(),10)])},t.prototype.ignoreInColumn=function(e,t){if((0,S.isNullOrUndefined)(t.template))for(var r=0;r<e.length;r++)delete t[e[parseInt(r.toString(),10)]],t.filter={}},t.prototype.mouseClickHandler=function(e){if((0,S.isNullOrUndefined)(e.touches)){var t=e.target;if(!t.classList.contains("e-treegridexpand")&&!t.classList.contains("e-treegridcollapse")||this.isEditCollapse||this.grid.isEdit||this.expandCollapseRequest(t),this.isEditCollapse=!1,this.notify("checkboxSelection",{target:t}),this.grid.isCheckBoxSelection&&!this.grid.isPersistSelection&&this.aggregates.map((function(e){return!0===e.showChildSummary})).length){var r=this.grid.getHeaderContent().querySelector(".e-checkselectall");if(this.grid.getSelectedRowIndexes().length===this.getCurrentViewRecords().length){var i=r.nextElementSibling;(0,S.removeClass)([i],["e-stop","e-uncheck"]),(0,S.addClass)([i],["e-check"])}}}},t.prototype.mouseMoveHandler=function(e){var t=!1,r=this.getColumns();"EllipsisWithTooltip"===this.clipMode&&(t=!0);var i=(0,x.parentsUntil)(e.target,"e-ellipsistooltip");(t||-1!==this.treeColumnIndex&&"EllipsisWithTooltip"===r[this.treeColumnIndex].clipMode)&&null!==i&&parseInt(i.getAttribute("data-colindex"),10)===this.treeColumnIndex&&i.children[0].scrollWidth>i.children[0].clientWidth&&new qt.Tooltip({content:i.textContent}).appendTo(i)},t.prototype.getRows=function(){return this.grid.getRows()},t.prototype.getPager=function(){return this.grid.getPager()},t.prototype.addRecord=function(e,t,r){this.editModule&&(this.editModule.isAddedRowByMethod=!0,this.editModule.addRecord(e,t,r))},t.prototype.closeEdit=function(){this.grid.editModule&&this.grid.editModule.closeEdit()},t.prototype.saveCell=function(){this.grid.editModule&&this.grid.editModule.saveCell()},t.prototype.updateCell=function(e,t,r){this.grid.editModule&&this.grid.editModule.updateCell(e,t,r)},t.prototype.updateRow=function(e,t){if(this.grid.editModule)if((0,S.isNullOrUndefined)(e))this.grid.editModule.updateRow(e,t);else{var r=this.grid.getCurrentViewRecords()[parseInt(e.toString(),10)];(0,S.extend)(r,t),this.grid.editModule.updateRow(e,r)}},t.prototype.deleteRecord=function(e,t){this.grid.editModule&&this.grid.editModule.deleteRecord(e,t)},t.prototype.startEdit=function(e){this.grid.editModule&&this.grid.editModule.startEdit(e)},t.prototype.editCell=function(e,t){this.editModule&&this.editModule.editCell(e,t)},t.prototype.enableToolbarItems=function(e,t){this.grid.toolbarModule&&this.grid.toolbarModule.enableItems(e,t)},t.prototype.endEdit=function(){this.grid.editModule&&this.grid.editModule.endEdit()},t.prototype.openColumnChooser=function(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)},t.prototype.deleteRow=function(e){this.grid.editModule&&this.grid.editModule.deleteRow(e)},t.prototype.getPrimaryKeyFieldNames=function(){return this.grid.getPrimaryKeyFieldNames()},t.prototype.setCellValue=function(e,t,r){this.grid.setCellValue(e,t,r);var i=this.grid.getRowIndexByPrimaryKey(e),n=this.getCurrentViewRecords()[parseInt(i.toString(),10)];(0,S.isNullOrUndefined)(n)||$t({value:n,action:"edit"},this,this.isSelfReference,n.index,this.grid.selectedRowIndex,t)},t.prototype.setRowData=function(e,t){var r,i=this.getCurrentViewRecords(),n=this.grid.getPrimaryKeyFieldNames()[0],o={};i.some((function(t){return t[""+n]===e&&(o=t,!0)})),r=o.level,t.level=r,t.index=o.index,t.childRecords=o.childRecords,t.taskData=o.taskData,t.uniqueID=o.uniqueID,t.parentItem=o.parentItem,t.checkboxState=o.checkboxState,t.hasChildRecords=o.hasChildRecords,t.parentUniqueID=o.parentUniqueID,t.expanded=o.expanded,this.grid.setRowData(e,t);var a=this.getVisibleRecords();if(a.length>0&&e===a[a.length-1][""+n]){var s=this.getContentTable().scrollHeight,d=this.getContent().clientHeight;this.lastRowBorder(this.getRows()[i.indexOf(o)],s<=d)}},t.prototype.goToPage=function(e){this.grid.pagerModule&&this.grid.pagerModule.goToPage(e)},t.prototype.updateExternalMessage=function(e){this.pagerModule&&this.grid.pagerModule.updateExternalMessage(e)},t.prototype.getCellFromIndex=function(e,t){return this.grid.getCellFromIndex(e,t)},t.prototype.getColumnByField=function(e){return(0,x.iterateArrayOrObject)(this.columnModel,(function(t){if(t.field===e)return t}))[0]},t.prototype.getColumnByUid=function(e){var t=this.initialRender?this.grid.columns:this.columns;return this.grid.columns.length!==this.columnModel.length&&(t=this.grid.columnModel),(0,x.iterateArrayOrObject)(t,(function(t){if(t.uid===e)return t}))[0]},t.prototype.getColumnFieldNames=function(){return this.grid.getColumnFieldNames()},t.prototype.getFooterContent=function(){return this.grid.getFooterContent()},t.prototype.getFooterContentTable=function(){return this.grid.getFooterContentTable()},t.prototype.showColumns=function(e,t){this.grid.showColumns(e,t),this.updateColumnModel()},t.prototype.hideColumns=function(e,t){this.grid.hideColumns(e,t),this.updateColumnModel()},t.prototype.getColumnHeaderByField=function(e){return this.grid.getColumnHeaderByField(e)},t.prototype.getColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},t.prototype.getColumnHeaderByUid=function(e){return this.grid.getColumnHeaderByUid(e)},t.prototype.getColumnIndexByField=function(e){return this.grid.getColumnIndexByField(e)},t.prototype.getVirtualColIndexByUid=function(e){var t=(0,x.iterateArrayOrObject)(this.grid.columnModel,(function(t,r){if(t.uid===e)return r}))[0];return(0,S.isNullOrUndefined)(t)?-1:t},t.prototype.getColumnIndexByUid=function(e){return this.grid.getColumnIndexByUid(e)},t.prototype.getColumns=function(e){return this.updateColumnModel(this.grid.getColumns(e)),this.columnModel},t.prototype.updateColumnModel=function(e){var t,r,i,n=(0,S.isNullOrUndefined)(e)?this.grid.getColumns():e;if(-1!==this.treeColumnIndex&&this.columnModel[this.treeColumnIndex]&&!(0,S.isNullOrUndefined)(this.columnModel[this.treeColumnIndex].template)&&(t=this.columnModel[this.treeColumnIndex].template,r=this.columnModel[this.treeColumnIndex].field),!this.enableColumnVirtualization||this.enableColumnVirtualization&&this.columnModel.length===n.length){this.columnModel=[];for(var o=0;o<n.length;o++){i={};for(var a=0,s=Object.keys(n[parseInt(o.toString(),10)]);a<s.length;a++){var d=s[a];i[""+d]=n[parseInt(o.toString(),10)][""+d]}this.columnModel.push(new w(i)),r!==this.columnModel[parseInt(o.toString(),10)].field||"checkbox"===this.columnModel[parseInt(o.toString(),10)].type||(0,S.isNullOrUndefined)(t)||""===t||(this.columnModel[parseInt(o.toString(),10)].template=t)}}var l="deepMerge";return this[""+l]=["columns"],this.grid.columns.length!==this.columnModel.length&&(this.stackedHeader=!0),this.stackedHeader&&this.allowResizing&&this.updateColumnsWidth(this.columns),this.stackedHeader||(0,S.merge)(this.columns,this.columnModel),this[""+l]=void 0,this.columnModel},t.prototype.updateColumnsWidth=function(e){var t=this;e.forEach((function(e){if(e.columns)t.updateColumnsWidth(e.columns);else if(e.field){var r=t.grid.getColumnByField(e.field);(0,S.isNullOrUndefined)(r)||(e.width=r.width)}}))},t.prototype.getContent=function(){return this.grid.getContent()},t.prototype.mergePersistTreeGridData=function(){this.grid.mergePersistGridData.apply(this)},t.prototype.mergeColumns=function(e,t){this.grid.mergeColumns.apply(this,[e,t])},t.prototype.updateTreeGridModel=function(){this.setProperties({filterSettings:(0,x.getObject)("properties",this.grid.filterSettings)},!0),this.setProperties({pageSettings:(0,x.getObject)("properties",this.grid.pageSettings)},!0),this.setProperties({searchSettings:(0,x.getObject)("properties",this.grid.searchSettings)},!0),this.setProperties({sortSettings:(0,x.getObject)("properties",this.grid.sortSettings)},!0)},t.prototype.getContentTable=function(){return this.grid.getContentTable()},t.prototype.getDataRows=function(){for(var e=[],t=this.grid.getDataRows(),r=0,i=t.length;r<i;r++)t[parseInt(r.toString(),10)].classList.contains("e-summaryrow")||e.push(t[parseInt(r.toString(),10)]);return e},t.prototype.getCurrentViewRecords=function(){return this.grid.currentViewData.filter((function(e){return(0,S.isNullOrUndefined)(e.isSummaryRow)}))},t.prototype.getBatchChanges=function(){return this.grid.editModule.getBatchChanges()},t.prototype.getHeaderContent=function(){return this.grid.getHeaderContent()},t.prototype.getHeaderTable=function(){return this.grid.getHeaderTable()},t.prototype.getRowByIndex=function(e){return this.grid.getRowByIndex(e)},t.prototype.getRowInfo=function(e){return this.grid.getRowInfo(e)},t.prototype.getUidByColumnField=function(e){return this.grid.getUidByColumnField(e)},t.prototype.getVisibleColumns=function(){for(var e=[],t=0,r=this.columnModel;t<r.length;t++){var i=r[t];i.visible&&e.push(i)}return e},t.prototype.showSpinner=function(){(0,qt.showSpinner)(this.element)},t.prototype.hideSpinner=function(){(0,qt.hideSpinner)(this.element)},t.prototype.refresh=function(){this.uniqueIDCollection={},this.convertTreeData(this.dataSource),gt(this)||(this.dataSource instanceof ct.DataManager?this.grid.setProperties({dataSource:new ct.DataManager(this.dataSource.dataSource,this.dataSource.defaultQuery,this.dataSource.adaptor)},!0):this.grid.dataSource=this.flatData),this.grid.refresh()},t.prototype.getCheckedRecords=function(){return this.selectionModule.getCheckedrecords()},t.prototype.getVisibleRecords=function(){var e=[],t=this.getCurrentViewRecords();if(this.allowPaging)e=t;else for(var r=0;r<t.length;r++)e.push(t[parseInt(r.toString(),10)]),t[parseInt(r.toString(),10)].expanded||(r+=vt(t[parseInt(r.toString(),10)]).length);return e},t.prototype.getCheckedRowIndexes=function(){return this.selectionModule.getCheckedRowIndexes()},t.prototype.selectCheckboxes=function(e){this.selectionModule.selectCheckboxes(e)},t.prototype.refreshColumns=function(e){(0,S.isNullOrUndefined)(e)||e?(this.grid.columns=this.getGridColumns(this.columns),this.grid.refreshColumns()):this.grid.setProperties({columns:this.getGridColumns(this.columns)},!0)},t.prototype.refreshHeader=function(){this.grid.refreshHeader()},t.prototype.expandCollapseRequest=function(e){if("Batch"===this.editSettings.mode&&(this.getBatchChanges()[this.changedRecords].length||this.getBatchChanges()[this.deletedRecords].length||this.getBatchChanges()[this.addedRecords].length)&&this.editSettings.showConfirmDialog){var t=this.grid.editModule.dialogObj;return this.grid.editModule.showDialog("CancelEdit",t),void(this.targetElement=e)}if(this.rowTemplate){var r=e.closest(".e-treerowcell").parentElement,i=this.getCurrentViewRecords()[r.rowIndex];e.classList.contains("e-treegridexpand")?this.collapseRow(r,i):this.expandRow(r,i)}else{var n=this.grid.getRowInfo(e);i=n.rowData,this.grid.isFrozenGrid()&&this.enableVirtualization&&!Object.keys(i).length&&(i=this.grid.contentModule.freezeRows.filter((function(e){return e.uid===n.row.getAttribute("data-uid")}))[0].data),this.enableImmutableMode&&(i=this.getCurrentViewRecords()[n.rowIndex]),e.classList.contains("e-treegridexpand")?this.collapseRow(n.row,i):this.expandRow(n.row,i)}},t.prototype.expandRow=function(e,t,r,i){var n=this,o=this.parentData;if(this.enableVirtualization||(o=this.flatData.filter((function(e){return e.hasChildRecords}))),t=this.getCollapseExpandRecords(e,t),!(0,S.isNullOrUndefined)(e)&&e.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(e,!1),this.isExpandAll&&!ut(this)){var a={data:o,row:e,cancel:!1},s=!1;this.grid.pagerModule&&!(0,S.isNullOrUndefined)(this.grid.pagerModule.pagerObj.pagerdropdownModule)&&(s=!!this.grid.pagerModule.pagerObj.pagerdropdownModule.dropDownListObject.value),this.isExpandingEventTriggered?(!this.allowPaging||s&&"All"===this.grid.pagerModule.pagerObj.pagerdropdownModule.dropDownListObject.value)&&!this.expandAllPrevent&&this.isExpandingEventTriggered&&this.expandRows(e,t,o,r,i):this.trigger(te,a,(function(a){n.expandAllPrevent=a.cancel,a.cancel||(a.expandAll&&n.expandCollapseAllChildren(t,"expand",r,i),n.expandRows(e,t,o,r,i))})),this.isExpandingEventTriggered=!0}else(!this.isExpandAll||this.isExpandAll&&ut(this))&&(a={data:t,row:e,cancel:!1},this.trigger(te,a,(function(a){a.cancel||(a.expandAll&&n.expandCollapseAllChildren(t,"expand",r,i),n.expandRows(e,t,o,r,i))})))},t.prototype.expandRows=function(e,t,r,i,n){if(this.expandCollapse("expand",e,t),(!ut(this)||wt(this))&&(!gt(this)||!(0,S.isNullOrUndefined)(t.Children))){var o={data:t,row:e};(0,S.isNullOrUndefined)(this.expandStateMapping)||this.updateExpandStateMapping(o.data,!0),this.isExpandAll&&!this.isExpandedEventTriggered?(this.isExpandedEventTriggered=!0,o={data:r,row:e},this.trigger(ee,o)):this.isExpandAll||this.trigger(ee,o)}},t.prototype.expandCollapseAllChildren=function(e,t,r,i){if(((0,S.isNullOrUndefined)(r)||e[this.getPrimaryKeyFieldNames()[0]]===r)&&((0,S.isNullOrUndefined)(i)||i===e.level)){var n=vt(e).filter((function(e){return e.hasChildRecords}));n.unshift(e);for(var o=0;o<n.length;o++)this.expandCollapse(t,null,n[parseInt(o.toString(),10)])}},t.prototype.getCollapseExpandRecords=function(e,t){return this.allowPaging&&"All"===this.pageSettings.pageSizeMode&&this.isExpandAll&&(0,S.isNullOrUndefined)(t)&&!ut(this)?t=this.flatData.filter((function(e){return e.hasChildRecords})):(0,S.isNullOrUndefined)(t)&&(t=this.detailTemplate?this.grid.getCurrentViewRecords()[e.getAttribute("data-rowindex")]:this.enableVirtualization&&this.isCollapseAll?this.isExpandAll&&-1===e.rowIndex?this.grid.getCurrentViewRecords()[parseInt(e.getAttribute("data-rowindex"),10)]:this.grid.getCurrentViewRecords()[e.rowIndex]:this.grid.getCurrentViewRecords()[parseInt(e.getAttribute("data-rowindex"),10)]),t},t.prototype.collapseRow=function(e,t,r){var i=this,n=this.parentData;if(this.enableVirtualization||(n=this.flatData.filter((function(e){return e.hasChildRecords}))),t=this.getCollapseExpandRecords(e,t),this.isCollapseAll&&!ut(this)){var o={data:n,row:e,cancel:!1};this.isCollapsingEventTriggered?this.allowPaging||this.collapseAllPrevent||!this.isCollapsingEventTriggered||this.collapseRows(e,t,n,r):this.trigger(ie,o,(function(o){i.collapseAllPrevent=o.cancel,o.cancel||(o.collapseAll&&i.expandCollapseAllChildren(t,"collapse",r),i.collapseRows(e,t,n,r))})),this.isCollapsingEventTriggered=!0}else(!this.isCollapseAll||this.isCollapseAll&&ut(this))&&(o={data:t,row:e,cancel:!1},this.trigger(ie,o,(function(o){o.cancel||i.collapseRows(e,t,n,r)})))},t.prototype.collapseRows=function(e,t,r,i){this.expandCollapse("collapse",e,t);var n={data:t,row:e};ut(this)||((0,S.isNullOrUndefined)(this.expandStateMapping)||this.updateExpandStateMapping(n.data,!1),this.isCollapseAll&&!this.isCollapsedEventTriggered?(this.isCollapsedEventTriggered=!0,n={data:r,row:e},this.trigger(re,n)):this.isCollapseAll||this.trigger(re,n),this.enableInfiniteScrolling&&this.grid.getContent().firstElementChild.scrollHeight-this.grid.getContent().firstElementChild.scrollTop<this.grid.getRowHeight()+ +this.height&&this.grid.getContent().firstElementChild.scrollBy(0,this.grid.getRowHeight()))},t.prototype.updateExpandStateMapping=function(e,t){var r=e;if(r.length)for(var i=0;i<r.length;i++)r[parseInt(i.toString(),10)][this.expandStateMapping]=t,$t({value:r[parseInt(i.toString(),10)],action:"edit"},this,this.isSelfReference,r[parseInt(i.toString(),10)].index,this.grid.selectedRowIndex,this.expandStateMapping);else e[""+this.expandStateMapping]=t,$t({value:e,action:"edit"},this,this.isSelfReference,e.index,this.grid.selectedRowIndex,this.expandStateMapping)},t.prototype.expandAtLevel=function(e){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!ut(this)){var t=this.grid.dataSource.filter((function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!0),t.hasChildRecords&&t.level===e}));this.expandAction(t,null,e,!0)}else{t=this.getRecordDetails(e);var r=(0,x.getObject)("records",t);this.expandAction(r,null,e)}},t.prototype.expandByKey=function(e){this.expandCollapseActionByKey(e,"Expand")},t.prototype.expandAction=function(e,t,r,i){void 0===i&&(i=!1);for(var n=function(n){if(!(0,S.isNullOrUndefined)(e[parseInt(n.toString(),10)].parentItem)){var a=e[parseInt(n.toString(),10)].parentItem.uniqueID,s=o.flatData.filter((function(e){return e.uniqueID===a}));ut(o)&&(s=o.getCurrentViewRecords().filter((function(e){return e.uniqueID===a}))),!1===s[0].expanded?(e.push(s[0]),s[0].expanded=!0):St(o,s[0],o.parentData)||s[0].expanded&&void 0!==s[0].parentItem&&e.push(s[0])}i||o.expandRow(null,e[parseInt(n.toString(),10)],t,r)},o=this,a=0;a<e.length;a++)n(a);i&&this.expandRow(null,e,t,r)},t.prototype.getRecordDetails=function(e){var t=this.getRows().filter((function(t){return-1!==t.className.indexOf("level"+e)&&(t.querySelector(".e-treegridcollapse")||t.querySelector(".e-treegridexpand"))}));return{records:this.getCurrentViewRecords().filter((function(t){return t.level===e&&t.hasChildRecords})),rows:t}},t.prototype.collapseAtLevel=function(e){if((this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization)&&!ut(this)){var t=this.grid.dataSource.filter((function(t){return t.hasChildRecords&&t.level===e&&(t.expanded=!1),t.hasChildRecords&&t.level===e}));this.collapseAction(t,null,!0)}else{var r=this.getRecordDetails(e),i=(0,x.getObject)("records",r);this.collapseAction(i)}},t.prototype.collapseByKey=function(e){this.expandCollapseActionByKey(e,"Collapse")},t.prototype.expandCollapseActionByKey=function(e,t){var r=this.getPrimaryKeyFieldNames()[0],i=ut(this)?this.getCurrentViewRecords():this.grid.dataSource;if(!(0,S.isNullOrUndefined)(r)){var n=i.filter((function(t){return t[""+r].toString()===e.toString()}));"Expand"===t?this.expandAction(n,e,null):this.collapseAction(n,e)}},t.prototype.collapseAction=function(e,t,r){if(void 0===r&&(r=!1),r)this.collapseRow(null,e);else for(var i=0;i<e.length;i++)this.collapseRow(null,e[parseInt(i.toString(),10)],t);!this.grid.contentModule.isDataSourceChanged&&this.enableVirtualization&&this.getRows()&&this.parentData.length===this.getRows().length&&(this.grid.contentModule.startIndex=-1,this.grid.contentModule.endIndex=-1)},t.prototype.expandAll=function(){this.isExpandedEventTriggered=!1,this.isExpandingEventTriggered=!1,this.expandCollapseAll("expand")},t.prototype.collapseAll=function(){this.isCollapsedEventTriggered=!1,this.isCollapsingEventTriggered=!1,this.expandCollapseAll("collapse")},t.prototype.expandCollapseAll=function(e){var t=this.getRows().filter((function(t){return t.querySelector(".e-treegrid"+("expand"===e?"collapse":"expand"))}));if(!t.length&&this.getRows().length&&t.push(this.getRows()[0]),this.isExpandAll=!0,this.isCollapseAll=!0,(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization||this.enableInfiniteScrolling)&&!ut(this)){if(this.flatData.filter((function(t){t.hasChildRecords&&(t.expanded="collapse"!==e)})),t.length)for(var r=0;r<t.length;r++)"collapse"===e?(0,S.isNullOrUndefined)(this.getCurrentViewRecords()[t[parseInt(r.toString(),10)].rowIndex])||this.collapseRow(t[parseInt(r.toString(),10)]):this.enableVirtualization?"true"!==t[0].getAttribute("aria-expanded")&&this.expandRow(t[0]):this.expandRow(t[parseInt(r.toString(),10)]);else if(this.allowPaging){var i=this.enableCollapseAll;this.setProperties({enableCollapseAll:!0},!0),this.grid.pagerModule.goToPage(1),this.setProperties({enableCollapseAll:i},!0)}}else for(r=0;r<t.length;r++)"collapse"===e?this.collapseRow(t[parseInt(r.toString(),10)]):this.expandRow(t[parseInt(r.toString(),10)]);this.isExpandAll=!1,this.isCollapseAll=!1},t.prototype.expandCollapse=function(e,t,r,i){var n,o=this,a={row:t,data:r,childData:[],requestType:e},s=this.grid.currentViewData.filter((function(e){return e.parentUniqueID===r.uniqueID}));(!ut(this)&&"expand"===e&&this.isSelfReference&&gt(this)&&!s.length||"collapse"===e||this.isExpandAll&&this.loadChildOnDemand&&!ut(this)&&this.isSelfReference&&gt(this))&&this.updateChildOnDemand(a);var d,l=this.getRows();if(this.rowTemplate){var p=this.getContentTable().rows;l=[].slice.call(p)}if((0,S.isNullOrUndefined)(t)?(d=this.grid.currentViewData.indexOf(r),t=l[parseInt(d.toString(),10)]):d=+t.getAttribute("data-rowindex"),(0,S.isNullOrUndefined)(t)||t.setAttribute("aria-expanded","expand"===e?"true":"false"),!(this.allowPaging&&"All"===this.pageSettings.pageSizeMode||this.enableVirtualization||this.enableInfiniteScrolling)||ut(this)||gt(this)){var h=void 0;if("expand"===e){if(h="table-row",i||(r.expanded=!0,this.uniqueIDCollection[r.uniqueID].expanded=r.expanded),(0,S.isNullOrUndefined)(t)||(n=t.getElementsByClassName("e-treegridcollapse")[0]),i&&!(0,S.isNullOrUndefined)(r[this.expandStateMapping])&&r[this.expandStateMapping]&&(0,S.isNullOrUndefined)(n)&&(n=t.getElementsByClassName("e-treegridexpand")[0]),(0,S.isNullOrUndefined)(n))return;n.classList.contains("e-treegridexpand")||(0,S.addClass)([n],"e-treegridexpand"),(0,S.removeClass)([n],"e-treegridcollapse")}else{if(h="none",i&&!gt(this)||(r.expanded=!1,this.uniqueIDCollection[r.uniqueID].expanded=r.expanded),(0,S.isNullOrUndefined)(t)||(n=t.getElementsByClassName("e-treegridexpand")[0]),i&&!(0,S.isNullOrUndefined)(r[this.expandStateMapping])&&!r[this.expandStateMapping]&&(0,S.isNullOrUndefined)(n)&&(n=t.getElementsByClassName("e-treegridcollapse")[0]),(0,S.isNullOrUndefined)(n))return;n.classList.contains("e-treegridcollapse")||(0,S.addClass)([n],"e-treegridcollapse"),(0,S.removeClass)([n],"e-treegridexpand")}t.querySelectorAll(".e-treerowcell")[0].setAttribute("aria-expanded","expand"===e?"true":"false");var c=l.filter((function(e){return e.classList.contains("e-griddetailrowindex"+r.index+"level"+(r.level+1))}));if(ut(this)&&!wt(this))this.remoteExpand(e,t,r);else{gt(this)&&!s.length&&"collapse"!==e||this.localExpand(e,t,r);var u=this.getVisibleRecords()[this.getVisibleRecords().length-1].index,g=this.getRowByIndex(u);this.grid.getContentTable().clientHeight<=this.grid.getContent().clientHeight&&!(0,S.isNullOrUndefined)(g)&&!g.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(g,!0)}if(gt(this)&&"expand"===e){var f=this.getCurrentViewRecords().filter((function(e){return St(o,e,o.parentData)}));this.dataResults.result=f}if(!(0,S.isNullOrUndefined)(n)&&n.closest(".e-treerowcell").classList.contains("e-cellselectionbackground")&&(n.closest(".e-treerowcell").classList.remove("e-cellselectionbackground"),n.closest(".e-treerowcell").removeAttribute("aria-selected")),this.isPixelHeight()&&!t.cells[0].classList.contains("e-lastrowcell"))for(var y=this.getRows(),m=(p=this.getContentTable().rows,(y=[].slice.call(p)).length-1);m>=0;m--)if(!Ct(y[parseInt(m.toString(),10)])){var v=this.getContentTable().scrollHeight,w=this.getContent().clientHeight;this.lastRowBorder(y[parseInt(m.toString(),10)],v<=w);break}this.notify("rowExpandCollapse",{detailrows:c,action:h,record:r,row:t}),this.updateAltRow(l)}else this.notify(oe,{action:e,row:t,record:r})},t.prototype.updateChildOnDemand=function(e){var t=this;if("collapse"===e.requestType&&gt(this)){for(var r=this.flatData.slice(),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].parentUniqueID===e.data.uniqueID&&(r.splice(i,1),i-=1);this.dataResults.result=r}else{var n=new ct.Deferred;e.childDataBind=n.resolve;var o=e.data;this.trigger(H,e),n.promise.then((function(){if(e.childData.length){gt(t)&&(t.flatData=t.dataResults.result),t.enableInfiniteScrolling&&gt(t)&&(t.flatData=t.infiniteScrollData);for(var r=t.flatData,i=0,n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].taskData===o.taskData){i=n;break}var a=(0,S.getValue)("result",t.dataSource),s=It(e.childData),d=o[t.childMapping]&&o[t.childMapping].length>s.length?o[t.childMapping].length:s.length;for(n=0;n<d;n++)o[t.childMapping]&&a.filter((function(e,r){e[t.parentIdMapping]===o[t.idMapping]&&a.splice(r,1)})),s[parseInt(n.toString(),10)]?(s[parseInt(n.toString(),10)].level=o.level+1,s[parseInt(n.toString(),10)].index=Math.ceil(1e3*Math.random()),s[parseInt(n.toString(),10)].parentItem=(0,S.extend)({},o),s[parseInt(n.toString(),10)].taskData=(0,S.extend)({},s[parseInt(n.toString(),10)]),delete s[parseInt(n.toString(),10)].parentItem.childRecords,delete s[parseInt(n.toString(),10)].taskData.parentItem,s[parseInt(n.toString(),10)].parentUniqueID=o.uniqueID,s[parseInt(n.toString(),10)].uniqueID=(0,x.getUid)(t.element.id+"_data_"),(0,S.setValue)("uniqueIDCollection."+s[parseInt(n.toString(),10)].uniqueID,s[parseInt(n.toString(),10)],t),(!(0,S.isNullOrUndefined)(s[parseInt(n.toString(),10)][t.childMapping])||s[parseInt(n.toString(),10)][t.hasChildMapping]&&gt(t))&&(s[parseInt(n.toString(),10)].hasChildRecords=!0),gt(t)&&o[t.childMapping]&&o[t.childMapping][parseInt(n.toString(),10)]?r.splice(i+1+n,0,s[parseInt(n.toString(),10)]):r.splice(i+1+n,o[t.childMapping]&&o[t.childMapping][parseInt(n.toString(),10)]?1:0,s[parseInt(n.toString(),10)])):r.splice(i+1+n,1);r[parseInt(i.toString(),10)][""+t.childMapping]=s,r[parseInt(i.toString(),10)].childRecords=s,r[parseInt(i.toString(),10)].expanded=!0,(0,S.setValue)("uniqueIDCollection."+r[parseInt(i.toString(),10)].uniqueID,r[parseInt(i.toString(),10)],t);for(var l=0;l<e.childData.length;l++)a.push(e.childData[parseInt(l.toString(),10)])}gt(t)&&t.loadChildOnDemand&&"expand"===e.requestType&&(t.dataResults.expandRecord={},t.dataResults.expandRecord=e.data),t.isExpandRefresh=!0;var p=t.getContentTable().parentElement.scrollTop;t.grid.refresh(),t.enableInfiniteScrolling&&(t.getContentTable().parentElement.scrollTop=p),t.trigger(ee,e)}))}},t.prototype.remoteExpand=function(e,t,r){var i=this.getRows();if(this.rowTemplate){var n=this.getContentTable().rows;i=[].slice.call(n)}var o,a={data:r,row:t};if(o=i.filter((function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))||e.querySelector(".e-gridrowindex"+r.index+"level0.e-summarycell")})),"expand"===e){this.notify(ne,{record:r,rows:o,parentRow:t});var s={row:t,data:r};o.length>0&&this.trigger(ee,s)}else"collapse"===e&&this.enableVirtualization?this.dataModule.fetchRemoteChildData({action:e,record:a.data,rows:null,parentRow:a.row}):(this.collapseRemoteChild({record:r,rows:o}),this.trigger(re,a))},t.prototype.localExpand=function(e,t,r){var i,n,o,a=this.grid.currentViewData.filter((function(e){return e.parentUniqueID===r.uniqueID}));this.isPixelHeight()&&t.cells[0].classList.contains("e-lastrowcell")&&this.lastRowBorder(t,!1);var s=this.getRows();if(this.rowTemplate){var d=this.getContentTable().rows;s=[].slice.call(d)}var l="expand"===e?"table-row":"none",p=this.getPrimaryKeyFieldNames()[0];if(this.enableImmutableMode&&!this.allowPaging){i=[];for(var h=0;h<a.length;h++){var c=this.grid.getRowIndexByPrimaryKey(a[parseInt(h.toString(),10)][""+p]);i.push(this.getRows()[parseInt(c.toString(),10)])}}else i=s.filter((function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))}));var u=this.grid.getFrozenLeftColumnsCount()>0||this.grid.getFrozenRightColumnsCount()>0;(this.frozenRows||this.frozenColumns||this.getFrozenColumns()||u)&&(n=this.getRows().filter((function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))}))),u&&(o=this.getRows().filter((function(e){return e.querySelector(".e-gridrowindex"+r.index+"level"+(r.level+1))})));var g=this.grid.getRowsObject(),f=this.grid.currentViewData,y=f.filter((function(e){return e.uniqueID===r.uniqueID})),m=f.indexOf(y[0]);(0,S.isNullOrUndefined)(g[parseInt(m.toString(),10)].visible)||!1===g[parseInt(m.toString(),10)].visible||(g[parseInt(m.toString(),10)].visible=!0);var v=s.filter((function(e){return e.classList.contains("e-griddetailrowindex"+r.index+"level"+(r.level+1))}));for(h=0;h<i.length;h++){if((0,S.isNullOrUndefined)(i[parseInt(h.toString(),10)])||(i[parseInt(h.toString(),10)].style.display=l),!(0,S.isNullOrUndefined)(i[parseInt(h.toString(),10)])&&!this.allowPaging&&!(this.enableVirtualization||this.enableInfiniteScrolling||ut(this)||gt(this))){g[i[parseInt(h.toString(),10)].rowIndex].visible="none"!==l;var w=f.filter((function(e){return e.uniqueID===y[0].parentUniqueID}));!(0,S.isNullOrUndefined)(w[0])&&s[f.indexOf(w[0])].getElementsByClassName("e-treegridcollapse").length&&(g[parseInt(m.toString(),10)].visible=!1)}(0,S.isNullOrUndefined)(n)||(n[parseInt(h.toString(),10)].style.display=l),(0,S.isNullOrUndefined)(o)||(o[parseInt(h.toString(),10)].style.display=l),this.notify("childRowExpand",{row:i[parseInt(h.toString(),10)]}),!(0,S.isNullOrUndefined)(a[parseInt(h.toString(),10)].childRecords)&&a[parseInt(h.toString(),10)].childRecords.length>0&&("expand"!==e||(0,S.isNullOrUndefined)(a[parseInt(h.toString(),10)].expanded)||a[parseInt(h.toString(),10)].expanded)&&(this.expandCollapse(e,i[parseInt(h.toString(),10)],a[parseInt(h.toString(),10)],!0),this.frozenColumns<=this.treeColumnIndex&&!(0,S.isNullOrUndefined)(n)&&this.expandCollapse(e,n[parseInt(h.toString(),10)],a[parseInt(h.toString(),10)],!0))}for(h=0;h<v.length;h++)(0,S.isNullOrUndefined)(v[parseInt(h.toString(),10)])||this.allowPaging||this.enableVirtualization||this.enableInfiniteScrolling||ut(this)||gt(this)||(g[v[parseInt(h.toString(),10)].rowIndex].visible="none"!==l,v[parseInt(h.toString(),10)].style.display=l);this.allowPaging||this.enableVirtualization||this.enableInfiniteScrolling||ut(this)||gt(this)||this.grid.notify("refresh-Expand-and-Collapse",{rows:this.grid.getRowsObject()})},t.prototype.updateAltRow=function(e){if(this.enableAltRow&&!this.rowTemplate)for(var t=0,r=0;e&&r<e.length;r++){var i=e[parseInt(r.toString(),10)];"none"!==i.style.display&&(i.classList.contains("e-altrow")&&(0,S.removeClass)([i],"e-altrow"),t%2==0||i.classList.contains("e-summaryrow")||i.classList.contains("e-detailrow")||(0,S.addClass)([i],"e-altrow"),i.classList.contains("e-summaryrow")||i.classList.contains("e-detailrow")||t++)}},t.prototype.treeColumnRowTemplate=function(){var e=this.getContentTable().rows;e=[].slice.call(e);for(var t=this.grid.getRowsObject(),r=0;r<e.length;r++){var i=this.grid.getContentTable().rows[parseInt(r.toString(),10)].cells[this.treeColumnIndex],n=e[parseInt(r.toString(),10)],o={data:0!==t.length?t[parseInt(r.toString(),10)].data:new Object,row:n,cell:i,column:this.getColumns()[this.treeColumnIndex]};this.renderModule.cellRender(o)}},t.prototype.collapseRemoteChild=function(e,t){t||(e.record.expanded=!1);var r,i,n=e.rows,o=[],a=[],s=this.getFrozenLeftColumnsCount()>0||this.getFrozenRightColumnsCount()>0;s&&(o=this.getRows().filter((function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))})),a=this.getRows().filter((function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))})));for(var d=0;d<n.length;d++){n[parseInt(d.toString(),10)].style.display="none",r=n[parseInt(d.toString(),10)];var l=n[parseInt(d.toString(),10)].querySelector(".e-detailrowexpand");if((0,S.isNullOrUndefined)(l)||this.grid.detailRowModule.collapse(l),s&&(o[parseInt(d.toString(),10)].style.display="none",a[parseInt(d.toString(),10)].style.display="none",n[parseInt(d.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")||(o[parseInt(d.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")?r=o[parseInt(d.toString(),10)]:a[parseInt(d.toString(),10)].querySelector(".e-treecolumn-container .e-treegridexpand")&&(r=a[parseInt(d.toString(),10)]))),r.querySelector(".e-treecolumn-container .e-treegridexpand")){var p=r.querySelector(".e-treecolumn-container .e-treegridexpand");i=this.rowTemplate?this.grid.getCurrentViewRecords()[n[parseInt(d.toString(),10)].rowIndex]:this.grid.getRowObjectFromUID(n[parseInt(d.toString(),10)].getAttribute("data-Uid")).data,!(0,S.isNullOrUndefined)(p)&&i.expanded&&((0,S.removeClass)([p],"e-treegridexpand"),(0,S.addClass)([p],"e-treegridcollapse"));for(var h=[],c=this.getRows(),u=0;u<c.length;u++)c[parseInt(u.toString(),10)].querySelector(".e-gridrowindex"+i.index+"level"+(i.level+1))&&h.push(c[parseInt(u.toString(),10)]);h.length&&i.expanded&&this.collapseRemoteChild({record:i,rows:h},!1)}}},t.prototype.sanitize=function(e){return this.enableHtmlSanitizer&&"string"==typeof e?S.SanitizeHtmlHelper.sanitize(e):e},t.prototype.updateRowAndCellElements=function(e,t,r){for(var i=0;i<e.length;i++)this.renderModule.cellRender({data:e[parseInt(i.toString(),10)],cell:t[parseInt(i.toString(),10)].cells[parseInt(r.toString(),10)],column:this.grid.getColumns()[this.treeColumnIndex],requestType:"rowDragAndDrop"}),"indenting"!==this.action&&"outdenting"!==this.action||this.renderModule.RowModifier({data:e[parseInt(i.toString(),10)],row:t[parseInt(i.toString(),10)]})},t.prototype.addListener=function(){this.on("updateResults",this.updateResultModel,this),this.grid.on("initial-end",this.afterGridRender,this)},t.prototype.updateResultModel=function(e){this.dataResults=e},t.prototype.removeListener=function(){this.isDestroyed||(this.off("updateResults",this.updateResultModel),this.grid.off("initial-end",this.afterGridRender))},t.prototype.filterByColumn=function(e,t,r,i,n,o,a,s){this.grid.filterByColumn(e,t,r,i,n,o,a,s)},t.prototype.clearFiltering=function(){this.grid.clearFiltering()},t.prototype.removeFilteredColsByField=function(e,t){this.grid.removeFilteredColsByField(e,t)},t.prototype.selectRow=function(e,t){this.grid.selectRow(e,t)},t.prototype.selectRows=function(e){this.grid.selectRows(e)},t.prototype.clearSelection=function(){this.grid.clearSelection()},t.prototype.copy=function(e){this.clipboardModule.copy(e)},t.prototype.paste=function(e,t,r){this.clipboardModule.paste(e,t,r)},t.prototype.selectCell=function(e,t){this.grid.selectCell(e,t)},t.prototype.getSelectedRows=function(){return this.grid.getSelectedRows()},t.prototype.getMovableCellFromIndex=function(e,t){return this.grid.getCellFromIndex(e,t)},t.prototype.getMovableDataRows=function(){return this.grid.getDataRows()},t.prototype.getMovableRowByIndex=function(e){return this.grid.getRowByIndex(e)},t.prototype.getMovableRows=function(){return this.grid.getRows()},t.prototype.getFrozenRightRowByIndex=function(e){return this.grid.getRowByIndex(e)},t.prototype.getFrozenRightRows=function(){return this.grid.getRows()},t.prototype.getFrozenRightDataRows=function(){return this.grid.getDataRows()},t.prototype.getFrozenRightCellFromIndex=function(e,t){return this.grid.getCellFromIndex(e,t)},t.prototype.getFrozenLeftColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},t.prototype.getFrozenRightColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},t.prototype.getMovableColumnHeaderByIndex=function(e){return this.grid.getColumnHeaderByIndex(e)},t.prototype.getMovableColumnsCount=function(){return this.grid.getMovableColumnsCount()},t.prototype.getFrozenLeftColumnsCount=function(){return this.grid.getFrozenLeftColumnsCount()},t.prototype.getFrozenRightColumnsCount=function(){return this.grid.getFrozenRightColumnsCount()},t.prototype.getFrozenLeftColumns=function(){return this.updateColumnModel(this.grid.getFrozenLeftColumns()),this.columnModel},t.prototype.getFrozenRightColumns=function(){return this.updateColumnModel(this.grid.getFrozenRightColumns()),this.columnModel},t.prototype.getVisibleMovableCount=function(){return this.grid.getVisibleMovableCount()},t.prototype.getVisibleFrozenRightCount=function(){return this.grid.getVisibleFrozenRightCount()},t.prototype.getVisibleFrozenLeftCount=function(){return this.grid.getVisibleFrozenLeftCount()},t.prototype.getMovableColumns=function(){return this.updateColumnModel(this.grid.getMovableColumns()),this.columnModel},t.prototype.getFrozenColumns=function(){return this.getFrozenCount(this.columns,0)+this.frozenColumns},t.prototype.getFrozenCount=function(e,t){for(var r=0,i=e.length;r<i;r++)e[parseInt(r.toString(),10)].columns?t=this.getFrozenCount(e[parseInt(r.toString(),10)].columns,t):e[parseInt(r.toString(),10)].isFrozen&&t++;return t},t.prototype.getSelectedRowIndexes=function(){return this.grid.getSelectedRowIndexes()},t.prototype.getSelectedRowCellIndexes=function(){return this.grid.getSelectedRowCellIndexes()},t.prototype.getSelectedRecords=function(){return this.grid.getSelectedRecords()},t.prototype.getDataModule=function(){return{baseModule:this.grid.getDataModule(),treeModule:this.dataModule}},t.prototype.reorderRows=function(e,t,r){this.rowDragAndDropModule.reorderRows(e,t,r)},t.prototype.indent=function(e){(0,S.isNullOrUndefined)(this.rowDragAndDropModule)||this.rowDragAndDropModule[this.indentOutdentAction](e,"indent")},t.prototype.outdent=function(e){(0,S.isNullOrUndefined)(this.rowDragAndDropModule)||this.rowDragAndDropModule[this.indentOutdentAction](e,"outdent")},or([(0,S.Property)(0)],t.prototype,"frozenRows",void 0),or([(0,S.Property)(0)],t.prototype,"frozenColumns",void 0),or([(0,S.Property)("Ellipsis")],t.prototype,"clipMode",void 0),or([(0,S.Property)([])],t.prototype,"columns",void 0),or([(0,S.Property)(null)],t.prototype,"childMapping",void 0),or([(0,S.Property)(null)],t.prototype,"hasChildMapping",void 0),or([(0,S.Property)(0)],t.prototype,"treeColumnIndex",void 0),or([(0,S.Property)(null)],t.prototype,"idMapping",void 0),or([(0,S.Property)(null)],t.prototype,"parentIdMapping",void 0),or([(0,S.Property)(!1)],t.prototype,"enableCollapseAll",void 0),or([(0,S.Property)(null)],t.prototype,"expandStateMapping",void 0),or([(0,S.Property)(!1)],t.prototype,"allowRowDragAndDrop",void 0),or([(0,S.Property)([])],t.prototype,"dataSource",void 0),or([(0,S.Property)()],t.prototype,"query",void 0),or([(0,S.Property)()],t.prototype,"cloneQuery",void 0),or([(0,S.Property)("AllPages")],t.prototype,"printMode",void 0),or([(0,S.Property)(!1)],t.prototype,"allowPaging",void 0),or([(0,S.Property)(!1)],t.prototype,"loadChildOnDemand",void 0),or([(0,S.Property)(!1)],t.prototype,"allowTextWrap",void 0),or([(0,S.Complex)({},A)],t.prototype,"textWrapSettings",void 0),or([(0,S.Property)(!1)],t.prototype,"allowReordering",void 0),or([(0,S.Property)(!1)],t.prototype,"allowResizing",void 0),or([(0,S.Property)(!1)],t.prototype,"autoCheckHierarchy",void 0),or([(0,S.Complex)({},jt)],t.prototype,"pageSettings",void 0),or([(0,S.Complex)({},x.RowDropSettings)],t.prototype,"rowDropSettings",void 0),or([(0,S.Property)("USD")],t.prototype,"currencyCode",void 0),or([(0,S.Property)()],t.prototype,"pagerTemplate",void 0),or([(0,S.Property)(!1)],t.prototype,"showColumnMenu",void 0),or([(0,S.Property)(!1)],t.prototype,"showColumnChooser",void 0),or([(0,S.Property)(!1)],t.prototype,"allowSorting",void 0),or([(0,S.Property)(!0)],t.prototype,"allowMultiSorting",void 0),or([(0,S.Complex)({},Xt)],t.prototype,"sortSettings",void 0),or([(0,S.Collection)([],Ht)],t.prototype,"aggregates",void 0),or([(0,S.Complex)({},Kt)],t.prototype,"editSettings",void 0),or([(0,S.Property)(!1)],t.prototype,"allowFiltering",void 0),or([(0,S.Property)()],t.prototype,"detailTemplate",void 0),or([(0,S.Complex)({},P)],t.prototype,"filterSettings",void 0),or([(0,S.Complex)({},At)],t.prototype,"searchSettings",void 0),or([(0,S.Property)()],t.prototype,"toolbar",void 0),or([(0,S.Property)()],t.prototype,"toolbarTemplate",void 0),or([(0,S.Property)("Default")],t.prototype,"gridLines",void 0),or([(0,S.Property)()],t.prototype,"contextMenuItems",void 0),or([(0,S.Property)()],t.prototype,"columnMenuItems",void 0),or([(0,S.Property)()],t.prototype,"rowTemplate",void 0),or([(0,S.Property)("Parent")],t.prototype,"copyHierarchyMode",void 0),or([(0,S.Property)(null)],t.prototype,"rowHeight",void 0),or([(0,S.Property)(!0)],t.prototype,"enableAltRow",void 0),or([(0,S.Property)(!0)],t.prototype,"allowKeyboard",void 0),or([(0,S.Property)(!1)],t.prototype,"enableHover",void 0),or([(0,S.Property)(!1)],t.prototype,"enableAutoFill",void 0),or([(0,S.Property)(!1)],t.prototype,"enableAdaptiveUI",void 0),or([(0,S.Property)(!1)],t.prototype,"enableImmutableMode",void 0),or([(0,S.Property)("auto")],t.prototype,"height",void 0),or([(0,S.Property)("auto")],t.prototype,"width",void 0),or([(0,S.Complex)({},b)],t.prototype,"loadingIndicator",void 0),or([(0,S.Property)(!0)],t.prototype,"enableVirtualMaskRow",void 0),or([(0,S.Property)(!1)],t.prototype,"enableVirtualization",void 0),or([(0,S.Property)(!1)],t.prototype,"enableColumnVirtualization",void 0),or([(0,S.Property)(!1)],t.prototype,"enableHtmlSanitizer",void 0),or([(0,S.Property)(!1)],t.prototype,"enableInfiniteScrolling",void 0),or([(0,S.Complex)({},ir)],t.prototype,"infiniteScrollSettings",void 0),or([(0,S.Property)("All")],t.prototype,"columnQueryMode",void 0),or([(0,S.Event)()],t.prototype,"created",void 0),or([(0,S.Event)()],t.prototype,"load",void 0),or([(0,S.Event)()],t.prototype,"expanding",void 0),or([(0,S.Event)()],t.prototype,"expanded",void 0),or([(0,S.Event)()],t.prototype,"collapsing",void 0),or([(0,S.Event)()],t.prototype,"collapsed",void 0),or([(0,S.Event)()],t.prototype,"cellSave",void 0),or([(0,S.Event)()],t.prototype,"cellSaved",void 0),or([(0,S.Event)()],t.prototype,"actionBegin",void 0),or([(0,S.Event)()],t.prototype,"actionComplete",void 0),or([(0,S.Event)()],t.prototype,"beginEdit",void 0),or([(0,S.Event)()],t.prototype,"batchAdd",void 0),or([(0,S.Event)()],t.prototype,"batchDelete",void 0),or([(0,S.Event)()],t.prototype,"batchCancel",void 0),or([(0,S.Event)()],t.prototype,"beforeBatchAdd",void 0),or([(0,S.Event)()],t.prototype,"beforeBatchDelete",void 0),or([(0,S.Event)()],t.prototype,"beforeBatchSave",void 0),or([(0,S.Event)()],t.prototype,"cellEdit",void 0),or([(0,S.Event)()],t.prototype,"actionFailure",void 0),or([(0,S.Event)()],t.prototype,"dataBound",void 0),or([(0,S.Event)()],t.prototype,"dataSourceChanged",void 0),or([(0,S.Event)()],t.prototype,"dataStateChange",void 0),or([(0,S.Event)()],t.prototype,"recordDoubleClick",void 0),or([(0,S.Event)()],t.prototype,"rowDataBound",void 0),or([(0,S.Event)()],t.prototype,"detailDataBound",void 0),or([(0,S.Event)()],t.prototype,"queryCellInfo",void 0),or([(0,S.Property)(!0)],t.prototype,"allowSelection",void 0),or([(0,S.Event)()],t.prototype,"rowSelecting",void 0),or([(0,S.Event)()],t.prototype,"rowSelected",void 0),or([(0,S.Event)()],t.prototype,"rowDeselecting",void 0),or([(0,S.Event)()],t.prototype,"rowDeselected",void 0),or([(0,S.Event)()],t.prototype,"headerCellInfo",void 0),or([(0,S.Event)()],t.prototype,"cellSelecting",void 0),or([(0,S.Event)()],t.prototype,"columnMenuOpen",void 0),or([(0,S.Event)()],t.prototype,"columnMenuClick",void 0),or([(0,S.Event)()],t.prototype,"cellSelected",void 0),or([(0,S.Event)()],t.prototype,"cellDeselecting",void 0),or([(0,S.Event)()],t.prototype,"cellDeselected",void 0),or([(0,S.Event)()],t.prototype,"resizeStart",void 0),or([(0,S.Event)()],t.prototype,"resizing",void 0),or([(0,S.Event)()],t.prototype,"resizeStop",void 0),or([(0,S.Event)()],t.prototype,"columnDragStart",void 0),or([(0,S.Event)()],t.prototype,"columnDrag",void 0),or([(0,S.Event)()],t.prototype,"columnDrop",void 0),or([(0,S.Event)()],t.prototype,"checkboxChange",void 0),or([(0,S.Event)()],t.prototype,"printComplete",void 0),or([(0,S.Event)()],t.prototype,"beforePrint",void 0),or([(0,S.Event)()],t.prototype,"toolbarClick",void 0),or([(0,S.Event)()],t.prototype,"beforeDataBound",void 0),or([(0,S.Event)()],t.prototype,"contextMenuOpen",void 0),or([(0,S.Event)()],t.prototype,"contextMenuClick",void 0),or([(0,S.Event)()],t.prototype,"beforeCopy",void 0),or([(0,S.Event)()],t.prototype,"beforePaste",void 0),or([(0,S.Event)()],t.prototype,"rowDrag",void 0),or([(0,S.Event)()],t.prototype,"rowDragStart",void 0),or([(0,S.Event)()],t.prototype,"rowDragStartHelper",void 0),or([(0,S.Event)()],t.prototype,"rowDrop",void 0),or([(0,S.Property)(-1)],t.prototype,"selectedRowIndex",void 0),or([(0,S.Complex)({},Ut)],t.prototype,"selectionSettings",void 0),or([(0,S.Property)(!1)],t.prototype,"allowExcelExport",void 0),or([(0,S.Property)(!1)],t.prototype,"allowPdfExport",void 0),or([(0,S.Event)()],t.prototype,"pdfQueryCellInfo",void 0),or([(0,S.Event)()],t.prototype,"pdfHeaderQueryCellInfo",void 0),or([(0,S.Event)()],t.prototype,"excelQueryCellInfo",void 0),or([(0,S.Event)()],t.prototype,"excelHeaderQueryCellInfo",void 0),or([(0,S.Event)()],t.prototype,"beforeExcelExport",void 0),or([(0,S.Event)()],t.prototype,"excelExportComplete",void 0),or([(0,S.Event)()],t.prototype,"beforePdfExport",void 0),or([(0,S.Event)()],t.prototype,"pdfExportComplete",void 0),r=or([S.NotifyPropertyChanges],t)}(S.Component),sr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),dr=function(e){function t(t){var r=e.call(this,t)||this;return r.initRenderCalled=!1,r.checkInjectedModules=!0,r.directivekeys={columns:{column:{stackedColumns:"stackedColumn"}},aggregates:{aggregate:{aggregateColumns:"aggregateColumn"}}},r.statelessTemplateProps=null,r.templateProps=null,r.immediateRender=!1,r.portals=[],r}return sr(t,e),t.prototype.render=function(){if(!(this.element&&!this.initRenderCalled||this.refreshing)||this.isReactForeceUpdate)return m.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals));e.prototype.render.call(this),this.initRenderCalled=!0},t}(ar);(0,n.applyMixins)(dr,[n.ComponentBase,m.Component]);var lr=function(){function e(e){x.Grid.Inject(x.Reorder),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"reorder"},e.prototype.addEventListener=function(){this.parent.on("getColumnIndex",this.getTreeColumn,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("getColumnIndex",this.getTreeColumn)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getTreeColumn=function(){for(var e,t=this.parent.columnModel[this.parent.treeColumnIndex],r=this.parent.getColumns(),i=0;i<r.length;i++)if((0,x.getObject)("field",t)===(0,x.getObject)("field",r[parseInt(i.toString(),10)])){e=i;break}this.parent.setProperties({treeColumnIndex:e},!0)},e}(),pr=function(){function e(e){x.Grid.Inject(x.Resize),this.parent=e}return e.prototype.autoFitColumns=function(e){this.parent.grid.autoFitColumns(e)},e.prototype.getModuleName=function(){return"resize"},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.grid.resizeModule.destroy()},e}(),hr=function(){function e(e){this.canDrop=!0,this.isDraggedWithChild=!1,this.modifiedRecords="modifiedRecords",this.selectedRecords="selectedRecords",this.selectedRows="selectedRows",this.hasDropItem=!0,this.isaddtoBottom=!1,x.Grid.Inject(x.RowDD),this.parent=e,this.addEventListener()}return e.prototype.getChildrecordsByParentID=function(e){return(this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource).filter((function(t){return t.uniqueID===e}))},e.prototype.addEventListener=function(){this.parent.on(Ge,this.Rowdraging,this),this.parent.on(Qe,this.rowDropped,this),this.parent.on(_e,this.rowsAdded,this),this.parent.on(He,this.rowsRemoved,this)},e.prototype.reorderRows=function(e,t,r){var i=this.parent,n="action",o="updateRowAndCellElements";if(e[0]!==t&&-1!==["above","below","child"].indexOf(r)){"above"===r&&(this.dropPosition="topSegment"),"below"===r&&(this.dropPosition="bottomSegment"),"child"===r&&(this.dropPosition="middleSegment"),this.parent.dropPosition=this.dropPosition;for(var a=[],s=0;s<e.length;s++){var d=this.parent.getRowByIndex(e[parseInt(s.toString(),10)]).rowIndex;a[parseInt(s.toString(),10)]=this.parent.getCurrentViewRecords()[parseInt(d.toString(),10)]}var l={data:a,dropIndex:t};if(gt(this.parent)||this.dropRows(l,!0),i.isLocalData&&(i.flatData=this.orderToIndex(i.flatData)),"outdenting"===this.parent[""+n]&&((0,S.isNullOrUndefined)(a[0].parentItem)||(a[0].level=a[0].parentItem.level+1)),this.parent.grid.refresh(),this.parent.enableImmutableMode&&"middleSegment"===this.dropPosition){d=void 0,this.parent.allowRowDragAndDrop?d=this.parent.treeColumnIndex+1:"indenting"===this.parent[""+n]&&(d=this.parent.treeColumnIndex);var p=this.parent.getRows()[e[0]],h=l.data[0],c=[];(f=[]).push(h),c.push(p);var u=xt(this.parent,l.data[0].parentUniqueID),g=this.parent.getRows()[parseInt(t.toString(),10)];f.push(u),c.push(g),this.parent[""+o](f,c,d)}if(this.parent.enableImmutableMode&&"outdenting"===this.parent[""+n]){d=void 0,this.parent.allowRowDragAndDrop?d=this.parent.treeColumnIndex+1:"outdenting"===this.parent[""+n]&&(d=this.parent.treeColumnIndex);var f,y=l.data[0];p=this.parent.getRows()[e[0]],c=[],(f=[]).push(y),c.push(p),this.parent[""+o](f,c,d)}}},e.prototype.indentOutdentAction=function(e,t){var r=this.parent,i="action",n="dropIndex",o=-1;if(!(0,S.isNullOrUndefined)(e)||-1!==this.parent.selectedRowIndex){this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?o=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(o=this.parent.selectedRowIndex),this.selectedItem=(0,S.isNullOrUndefined)(e)?r.getCurrentViewRecords()[parseInt(o.toString(),10)]:e;var a=this.parent.getPrimaryKeyFieldNames()[0],s=this.parent.grid.getRowIndexByPrimaryKey(this.selectedItem[""+a]);if(this.selectedRow=this.parent[this.selectedRows]=-1!==o?this.parent.getSelectedRows()[0]:this.parent.grid.getRowByIndex(s),this.selectedRecord=this.parent[this.selectedRecords]=-1!==o?r.getCurrentViewRecords()[parseInt(o.toString(),10)]:this.selectedItem,"indent"===t){var d=r.getCurrentViewRecords()[this.selectedRow.rowIndex-1],l=void 0;if(0===this.selectedRow.rowIndex||-1===this.selectedRow.rowIndex||r.getCurrentViewRecords()[this.selectedRow.rowIndex].level-d.level==1)return;if(d.level>this.selectedRecord.level)for(var p=0;p<r.getCurrentViewRecords().length;p++)r.getCurrentViewRecords()[parseInt(p.toString(),10)].taskData===d.parentItem.taskData&&(l=p,r.enableVirtualization&&(l=parseInt(r.getRows()[parseInt(p.toString(),10)].getAttribute("data-rowindex"),10)));else l=this.selectedRow.rowIndex-1;!this.parent.enableVirtualization||!this.selectedRecord||d.level>this.selectedRecord.level||(l=parseInt(this.selectedRow.getAttribute("data-rowindex"),10)-1),r[""+i]="indenting",r[""+n]=l,this.eventTrigger("indenting",l)}else if("outdent"===t){if(-1===this.selectedRow.rowIndex||0===this.selectedRow.rowIndex||0===r.getCurrentViewRecords()[this.selectedRow.rowIndex].level)return;l=void 0;var h=this.selectedRecord.parentItem;for(p=0;p<r.getCurrentViewRecords().length;p++)r.getCurrentViewRecords()[parseInt(p.toString(),10)].uniqueID===h.uniqueID&&(l=p);this.parent.enableVirtualization&&this.selectedRecord&&(l=parseInt(this.parent.getRows()[parseInt(l.toString(),10)].getAttribute("data-rowindex"),10)),r[""+i]="outdenting",r[""+n]=l,this.eventTrigger("outdenting",l)}}},e.prototype.eventTrigger=function(e,t){var r=this,i={action:e,cancel:!1,data:[this.parent[this.selectedRecords]],row:this.parent[this.selectedRows]};this.parent.trigger(_,i,(function(e){e.cancel||("indenting"===e.action?r.parent.enableVirtualization?r.reorderRows([parseInt(r.selectedRow.getAttribute("data-rowindex"),10)],t,"child"):r.reorderRows([r.selectedRow.rowIndex],t,"child"):"outdenting"===e.action&&(r.parent.enableVirtualization?r.reorderRows([parseInt(r.selectedRow.getAttribute("data-rowindex"),10)],t,"below"):r.reorderRows([r.selectedRow.rowIndex],t,"below")))}))},e.prototype.orderToIndex=function(e){for(var t=0;t<e.length;t++)if(e[parseInt(t.toString(),10)].index=t,!(0,S.isNullOrUndefined)(e[parseInt(t.toString(),10)].parentItem)){var r=(0,S.getValue)("uniqueIDCollection."+e[parseInt(t.toString(),10)].parentUniqueID,this.parent);e[parseInt(t.toString(),10)].parentItem.index=r.index}return e},e.prototype.rowsAdded=function(e){for(var t,r=e.records,i=e.records.length-1;i>-1;i--)if((t=r[parseInt(i.toString(),10)]).parentUniqueID){var n=r.filter((function(e){return e.uniqueID===t.parentUniqueID}));if(n.length){var o=n[0].childRecords.indexOf(t),a=n[0];-1!==o&&((0,S.isNullOrUndefined)(this.parent.idMapping)&&(a.childRecords.splice(o,1),a.childRecords.length||(a.hasChildRecords=!1,a.hasFilteredChildRecords=!1)),this.isDraggedWithChild=!0)}}if((0,S.isNullOrUndefined)(this.parent.dataSource)||!this.parent.dataSource.length){var s,d=this.parent,l=e.records;for(i=e.records.length-1;i>-1;i--){if(s=l[parseInt(i.toString(),10)],!i&&s.hasChildRecords&&(s.taskData[this.parent.parentIdMapping]=null),(0,S.isNullOrUndefined)(d.parentIdMapping)||(d.childMapping=null),(0,S.isNullOrUndefined)(s.taskData)||(0,S.isNullOrUndefined)(d.childMapping)||Object.prototype.hasOwnProperty.call(s.taskData,d.childMapping)||(s.taskData[d.childMapping]=[]),Object.prototype.hasOwnProperty.call(s,d.childMapping)&&s[d.childMapping].length&&!this.isDraggedWithChild&&!(0,S.isNullOrUndefined)(d.parentIdMapping))for(var p=s[d.childMapping],h=0;h<p.length;h++)-1===l.indexOf(p[parseInt(h.toString(),10)])&&(l.splice(h,0,p[parseInt(h.toString(),10)]),p[parseInt(h.toString(),10)].taskData=(0,S.extend)({},p[parseInt(h.toString(),10)]),i+=1);Object.prototype.hasOwnProperty.call(s,d.parentIdMapping)&&null!==s[d.parentIdMapping]&&!this.isDraggedWithChild&&(s.taskData[d.parentIdMapping]=null,delete s.parentItem,delete s.parentUniqueID),(0,S.isNullOrUndefined)(d.dataSource)&&(d.dataSource=[]),d.dataSource.splice(0,0,s.taskData)}d.setProperties({dataSource:d.dataSource},!1)}else{for(i=0;i<r.length;i++)(0,S.setValue)("uniqueIDCollection."+r[parseInt(i.toString(),10)].uniqueID,r[parseInt(i.toString(),10)],this.parent);var c={data:e.records,dropIndex:e.toIndex};this.parent.dataSource instanceof ct.DataManager?(this.treeGridData=this.parent.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource),(0,S.isNullOrUndefined)(this.dropPosition)&&(this.dropPosition="bottomSegment",c.dropIndex=this.parent.getCurrentViewRecords().length>1?this.parent.getCurrentViewRecords().length-1:c.dropIndex,c.data=c.data.map((function(e){return e.hasChildRecords&&(0,S.isNullOrUndefined)(e.parentItem)?(e.level=0,e):(delete e.parentItem,delete e.parentUniqueID,e.level=0,e)}))),this.dropRows(c)}},e.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++)this.draggedRecord=e.records[parseInt(t.toString(),10)],(this.draggedRecord.hasChildRecords||this.draggedRecord.parentItem&&-1!==this.parent.grid.dataSource.indexOf(this.getChildrecordsByParentID(this.draggedRecord.parentUniqueID)[0])||0===this.draggedRecord.level)&&this.deleteDragRow()},e.prototype.refreshGridDataSource=function(){var e,t,r=this.draggedRecord,i=this.droppedRecord,n=this.parent;if(!(e=this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?n.dataSource.dataSource.json:n.dataSource)||(0,S.isNullOrUndefined)(i)||i.parentItem||(0,S.isNullOrUndefined)(i.taskData)){if(!this.parent.parentIdMapping&&!(0,S.isNullOrUndefined)(i)&&i.parentItem&&("topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition)){var o=this.getChildrecordsByParentID(i.parentUniqueID)[0].childRecords;for(s=0;s<o.length;s++)i.parentItem.taskData[this.parent.childMapping][parseInt(s.toString(),10)]=o[parseInt(s.toString(),10)].taskData}}else{for(var a=Object.keys(e),s=0;s<a.length;s++)e[parseInt(s.toString(),10)][this.parent.childMapping]===i.taskData[this.parent.childMapping]&&(t=s);"topSegment"===this.dropPosition?this.parent.idMapping||e.splice(t,0,r.taskData):"bottomSegment"===this.dropPosition&&(this.parent.idMapping||e.splice(t+1,0,r.taskData))}this.parent.parentIdMapping&&(r.parentItem?"topSegment"===this.dropPosition||"bottomSegment"===this.dropPosition?(r[this.parent.parentIdMapping]=i[this.parent.parentIdMapping],r.taskData[this.parent.parentIdMapping]=i[this.parent.parentIdMapping]):(r[this.parent.parentIdMapping]=i[this.parent.idMapping],r.taskData[this.parent.parentIdMapping]=i[this.parent.idMapping]):(r.taskData[this.parent.parentIdMapping]=null,r[this.parent.parentIdMapping]=null))},e.prototype.removeFirstrowBorder=function(e){var t="bottomSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-firstrow-border").length>0&&e&&(0!==e.rowIndex||t)&&this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove()},e.prototype.removeLastrowBorder=function(e){var t,r=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow")),i=(t=this.parent.enableVirtualization?e&&!r&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")!==e.getAttribute("data-uid"):e&&!r&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid"))||"topSegment"===this.dropPosition;this.parent.element.getElementsByClassName("e-lastrow-border").length>0&&e&&(t||i)&&this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove()},e.prototype.updateIcon=function(e,t,r){var i=r.target?(0,S.closest)(r.target,"tr"):null;this.dropPosition=void 0;var n=0;this.removeFirstrowBorder(i),this.removeLastrowBorder(i);for(var o=0;o<r.rows.length;o++)((0,S.isNullOrUndefined)(i)||i.getAttribute("data-uid")!==r.rows[parseInt(o.toString(),10)].getAttribute("data-uid"))&&(0,x.parentsUntil)(r.target,"e-gridcontent")||(this.dropPosition="Invalid",this.addErrorElem());var a,s=this.parent,d=s.toolbar&&s.toolbar.length?document.getElementById(s.element.id+"_gridcontrol_toolbarItems").offsetHeight:0,l=this.getOffset(s.element),p=s.getHeaderContent().offsetHeight+l.top+d,h=s.getContent().firstElementChild.scrollTop;(0,S.isNullOrUndefined)(i)||(n=i.offsetTop-h);var c=((a=this.parent.enableVirtualization?i.getBoundingClientRect().top:n+p+0)+e[0].offsetHeight-a)/3,u=a+c,g=u+c,f=g+c,y=(0,x.getObject)("originalEvent.event",r),m=(0,x.getObject)("originalEvent.event",r),v="mousemove"===y.type?y.pageY:(0,S.isNullOrUndefined)(m)||(0,S.isNullOrUndefined)(m.changedTouches)?null:m.changedTouches[0].pageY,w=v<=u,I=v>u&&v<=g,R=v>g&&v<=f;if(w||I||R){if(w&&"Invalid"!==this.dropPosition&&(this.removeChildBorder(),this.dropPosition="topSegment",this.removetopOrBottomBorder(),this.addFirstrowBorder(i),this.removeErrorElem(),this.removeLastrowBorder(i),this.topOrBottomBorder(r.target)),I&&"Invalid"!==this.dropPosition){this.removetopOrBottomBorder();var C,b=(0,S.closest)(r.target,"tr");(C=[].slice.call(b.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))).length>0&&this.addRemoveClasses(C,!0,"e-childborder"),this.addLastRowborder(i),this.addFirstrowBorder(i),this.dropPosition="middleSegment"}R&&"Invalid"!==this.dropPosition&&(this.removeErrorElem(),this.removetopOrBottomBorder(),this.removeChildBorder(),this.dropPosition="bottomSegment",this.addLastRowborder(i),this.removeFirstrowBorder(i),this.topOrBottomBorder(r.target))}return this.dropPosition},e.prototype.removeChildBorder=function(){var e;(e=[].slice.call(this.parent.element.querySelectorAll(".e-childborder"))).length>0&&this.addRemoveClasses(e,!1,"e-childborder")},e.prototype.addFirstrowBorder=function(e){var t=this.parent.element,r=this.parent;if(e&&0===e.rowIndex&&!e.classList.contains("e-emptyrow")){var i=this.parent.createElement("div",{className:"e-firstrow-border"}),n=this.parent.getHeaderContent(),o=0;r.toolbar&&(o=r.toolbarModule.getToolbar().offsetHeight);var a=!(0,S.isNullOrUndefined)(this.parent.rowDropSettings.targetID);a&&(i.style.top=this.parent.grid.element.getElementsByClassName("e-gridheader")[0].offsetHeight+o+"px"),i.style.width=a?t.offsetWidth+"px":t.offsetWidth-this.getScrollWidth()+"px",n.querySelectorAll(".e-firstrow-border").length||n.appendChild(i)}},e.prototype.addLastRowborder=function(e){var t=e&&(e.classList.contains("e-emptyrow")||e.classList.contains("e-columnheader")||e.classList.contains("e-detailrow"));if(e&&!t&&this.parent.getRows()[this.parent.getCurrentViewRecords().length-1].getAttribute("data-uid")===e.getAttribute("data-uid")){var r=this.parent.createElement("div",{className:"e-lastrow-border"}),i=this.parent.getContent();r.style.width=this.parent.element.offsetWidth-this.getScrollWidth()+"px",i.querySelectorAll(".e-lastrow-border").length||(i.classList.add("e-treegrid-relative"),i.appendChild(r),r.style.bottom=this.getScrollWidth()+"px")}},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?x.Scroll.getScrollBarWidth():0},e.prototype.addErrorElem=function(){var e=document.getElementsByClassName("e-cloneproperties")[0],t="sanitize";if(!e.querySelectorAll(".e-errorelem").length&&!this.parent.rowDropSettings.targetID){var r=document.createElement("div");(0,S.classList)(r,["e-errorcontainer"],[]),(0,S.classList)(r,["e-icons","e-errorelem"],[]);var i=e.querySelector(".errorValue"),n=e.querySelector(".e-rowcell").innerHTML;i&&(n=this.parent[""+t](i.innerHTML),i.parentNode.removeChild(i)),e.querySelector(".e-rowcell").innerHTML="";var o=document.createElement("span");o.className="errorValue",o.style.paddingLeft="16px",o.innerHTML=this.parent[""+t](n),e.querySelector(".e-rowcell").appendChild(r),e.querySelector(".e-rowcell").appendChild(o);var a=document.querySelector(".e-dropitemscount");if(this.hasDropItem&&a){var s=parseInt(a.style.left,10)+r.offsetWidth+16,d=this.parent.enableRtl?0:s;a.style.left=d+"px",this.hasDropItem=!1}}},e.prototype.removeErrorElem=function(){var e=document.querySelector(".e-errorelem"),t=document.querySelector(".errorValue"),r=document.querySelector(".e-dropitemscount");if(e){if(r){var i=parseInt(r.style.left,10)-e.offsetWidth-16;(0,S.setStyleAttribute)(t,{paddingLeft:"0px"}),this.parent.enableRtl||(0,S.setStyleAttribute)(r,{left:i+"px"})}e.remove()}this.hasDropItem=!0},e.prototype.topOrBottomBorder=function(e){var t,r=(0,S.closest)(e,"tr");(t=r?[].slice.call(r.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")):[]).length&&("topSegment"===this.dropPosition&&(this.addRemoveClasses(t,!0,"e-droptop"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0].remove()),"bottomSegment"===this.dropPosition&&this.addRemoveClasses(t,!0,"e-dropbottom"))},e.prototype.removetopOrBottomBorder=function(){var e;(e=[].slice.call(this.parent.element.querySelectorAll(".e-dropbottom, .e-droptop"))).length&&(this.addRemoveClasses(e,!1,"e-dropbottom"),this.addRemoveClasses(e,!1,"e-droptop"))},e.prototype.addRemoveClasses=function(e,t,r){for(var i=0,n=e.length;i<n;i++)t?e[parseInt(i.toString(),10)].classList.add(r):e[parseInt(i.toString(),10)].classList.remove(r)},e.prototype.getOffset=function(e){var t=e.getBoundingClientRect(),r=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||r.scrollTop,o=window.pageXOffset||i.scrollLeft||r.scrollLeft,a=i.clientTop||r.clientTop||0,s=i.clientLeft||r.clientLeft||0,d=t.top+n-a,l=t.left+o-s;return{top:Math.round(d),left:Math.round(l)}},e.prototype.Rowdraging=function(e){var t=this.parent,r=this.parent.element.querySelector(".e-cloneproperties");r.style.cursor="";var i,n=e.target?(0,S.closest)(e.target,"tr"):null,o=n?n.rowIndex:-1,a=[],s=t.getCurrentViewRecords()[parseInt(o.toString(),10)];this.removeErrorElem(),this.canDrop=!0,e.data[0]?a=e.data:a.push(e.data),-1!==o?this.ensuredropPosition(a,s):(this.canDrop=!1,this.addErrorElem()),!t.rowDropSettings.targetID&&this.canDrop&&t.rowDragAndDropModule.updateIcon(e.rows,o,e),(0,S.isNullOrUndefined)(t.rowDropSettings.targetID)&&!this.canDrop&&this.removetopOrBottomBorder(),t.rowDropSettings.targetID&&(i=(0,x.parentsUntil)(e.target,"e-treegrid"))&&i.id===this.parent.rowDropSettings.targetID&&i.ej2_instances[0].rowDragAndDropModule.updateIcon(e.rows,o,e),e.target&&(0,S.closest)(e.target,"#"+t.rowDropSettings.targetID)&&((i=(0,x.parentsUntil)(e.target,"e-treegrid"))||(r.style.cursor="default"))},e.prototype.rowDropped=function(e){var t=this.parent;if(t.rowDropSettings.targetID?(e.target&&(0,S.closest)(e.target,"#"+t.rowDropSettings.targetID)||(0,x.parentsUntil)(e.target,"e-treegrid")&&(0,x.parentsUntil)(e.target,"e-treegrid").id===t.rowDropSettings.targetID||e.target&&document.getElementById(t.rowDropSettings.targetID))&&((0,S.setValue)("dropPosition",this.dropPosition,e),t.trigger(ze,e),!e.cancel&&t.rowDropSettings.targetID&&(this.dragDropGrid(e),t.isLocalData&&(t.flatData=this.orderToIndex(t.flatData)))):(0,x.parentsUntil)(e.target,"e-content")&&(this.parent.element.querySelector(".e-errorelem")&&(this.dropPosition="Invalid"),(0,S.setValue)("dropPosition",this.dropPosition,e),t.trigger(ze,e),e.cancel||(gt(this.parent)||this.dropRows(e),t.isLocalData&&(t.flatData=this.orderToIndex(t.flatData)),t.grid.refresh(),(0,S.isNullOrUndefined)(t.getHeaderContent().querySelector(".e-firstrow-border"))||t.getHeaderContent().querySelector(".e-firstrow-border").remove())),this.removetopOrBottomBorder(),this.removeChildBorder(),(0,S.isNullOrUndefined)(this.parent.element.getElementsByClassName("e-firstrow-border")[0])?(0,S.isNullOrUndefined)(this.parent.element.getElementsByClassName("e-lastrow-border")[0])||this.parent.element.getElementsByClassName("e-lastrow-border")[0].remove():this.parent.element.getElementsByClassName("e-firstrow-border")[0].remove(),this.parent.enableImmutableMode&&!this.parent.allowPaging&&!(0,S.isNullOrUndefined)(e.data[0].parentItem)){var r=this.parent.treeColumnIndex;r+=1;var i=this.parent.getPrimaryKeyFieldNames()[0],n=this.parent.grid.getRowIndexByPrimaryKey(e.data[0][""+i]),o=this.parent.getRows()[parseInt(n.toString(),10)],a=e.data[0];if("middleSegment"===this.dropPosition){var s=[],d=[];s.push(a),d.push(o),a=xt(this.parent,e.data[0].parentUniqueID),n=this.parent.grid.getRowIndexByPrimaryKey(a[""+i]);var l=this.parent.getRows()[parseInt(n.toString(),10)];s.push(a),d.push(l);for(var p=0;p<s.length;p++)this.parent.renderModule.cellRender({data:s[parseInt(p.toString(),10)],cell:d[parseInt(p.toString(),10)].cells[parseInt(r.toString(),10)],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"});var h=l.getElementsByClassName("e-treegridcollapse")[0];(0,S.isNullOrUndefined)(h)||((0,S.removeClass)([h],"e-treegridcollapse"),(0,S.addClass)([h],"e-treegridexpand"))}else this.parent.renderModule.cellRender({data:a,cell:o.cells[parseInt(r.toString(),10)],column:this.parent.grid.getColumns()[this.parent.treeColumnIndex],requestType:"rowDragAndDrop"})}},e.prototype.dragDropGrid=function(e){var t,r=this.parent,i=(0,S.closest)(e.target,"tr"),n=isNaN(this.getTargetIdx(i))?0:this.getTargetIdx(i),o=(0,x.parentsUntil)(e.target,"e-treegrid");if(o&&o.id===this.parent.rowDropSettings.targetID&&!ut(this.parent)&&!gt(this.parent)){t=o.ej2_instances[0];for(var a=r.getSelectedRecords(),s=[],d=0;d<a.length;d++)s[parseInt(d.toString(),10)]=a[parseInt(d.toString(),10)].index;var l=t.dataSource;if(null!==this.parent.idMapping&&((0,S.isNullOrUndefined)(this.dropPosition)||"bottomSegment"===this.dropPosition||"Invalid"===this.dropPosition)&&!l.length){var p=[];for(d=0;d<a.length;d++)if(a[parseInt(d.toString(),10)].hasChildRecords){p.push(a[parseInt(d.toString(),10)]);for(var h=vt(a[parseInt(d.toString(),10)]),c=0;c<h.length;c++)p.push(h[parseInt(c.toString(),10)])}p.length&&(a=p)}r.notify(He,{indexes:s,records:a}),t.notify(_e,{toIndex:n,records:a});var u=t.rowDragAndDropModule.treeGridData;if(!(0,S.isNullOrUndefined)(u))for(d=0;d<u.length;d++)if(u[parseInt(d.toString(),10)].index=d,!(0,S.isNullOrUndefined)(u[parseInt(d.toString(),10)].parentItem)){var g=(0,S.getValue)("uniqueIDCollection."+u[parseInt(d.toString(),10)].parentUniqueID+".index",t);u[parseInt(d.toString(),10)].parentItem.index=g}r.grid.refresh(),t.grid.refresh(),t.grid.dataSource.length>1&&(t.grid.refresh(),(0,S.isNullOrUndefined)(t.getHeaderContent().querySelector(".e-firstrow-border"))||t.getHeaderContent().querySelector(".e-firstrow-border").remove(),(0,S.isNullOrUndefined)(t.getContent().querySelector(".e-lastrow-border"))||t.getContent().querySelector(".e-lastrow-border").remove())}gt(this.parent)&&(t=o.ej2_instances[0],r.grid.refresh(),t.grid.refresh())},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute("data-rowindex"),10):0},e.prototype.getParentData=function(e,t){var r=e.parentItem,i=-1;if(this.parent.enableVirtualization&&-1!==this.parent.selectedRowIndex?i=this.parent.getSelectedRows()[0].rowIndex:-1!==this.parent.selectedRowIndex&&(i=this.parent.selectedRowIndex),"bottomSegment"===this.dropPosition){var n=this.parent.getPrimaryKeyFieldNames()[0],o=-1===i?this.parent.grid.getRowIndexByPrimaryKey(t[0][""+n]):this.parent.getSelectedRowIndexes()[0],a=this.parent.getCurrentViewRecords()[parseInt(o.toString(),10)];this.droppedRecord=xt(this.parent,a.parentItem.uniqueID)}"middleSegment"===this.dropPosition&&(this.parent.getCurrentViewRecords()[parseInt(i.toString(),10)].level===r.level?this.droppedRecord=xt(this.parent,r.uniqueID):this.getParentData(r))},e.prototype.dropRows=function(e,t){if("Invalid"!==this.dropPosition&&!ut(this.parent)){var r,i=this.parent,n=void 0;if((0,S.isNullOrUndefined)(e.dropIndex)){var o=this.parent.getPrimaryKeyFieldNames()[0],a=-1===i.selectedRowIndex?this.parent.grid.getRowIndexByPrimaryKey(e.data[0][""+o])-1:i.getSelectedRowIndexes()[0]-1,s=i.getCurrentViewRecords()[parseInt(a.toString(),10)];this.getParentData(s,e.data)}else if(e.dropIndex=e.dropIndex===e.fromIndex?this.getTargetIdx(e.target.parentElement):e.dropIndex,this.parent.enableVirtualization){var d=this.parent.getRowByIndex(e.dropIndex).rowIndex;this.droppedRecord=i.getCurrentViewRecords()[parseInt(d.toString(),10)]}else this.droppedRecord=i.getCurrentViewRecords()[e.dropIndex];var l=[];n=this.droppedRecord,e.data[0]?l=e.data:l.push(e.data),this.parent[this.modifiedRecords].push(e.data[0],n);var p=0,h=this.parent.rowDropSettings.targetID;this.isMultipleGrid=h,h?this.isaddtoBottom=h&&this.isDraggedWithChild:this.ensuredropPosition(l,n);var c=l.length;(0,S.isNullOrUndefined)(this.parent.idMapping)||l.reverse();for(var u=function(o){if(r=l[parseInt(o.toString(),10)],g.draggedRecord=r,"Invalid"!==g.dropPosition){if(i.rowDropSettings.targetID&&!t||g.deleteDragRow(),g.draggedRecord===g.droppedRecord){var a=g.getTargetIdx(e.target.offsetParent.parentElement);isNaN(a)&&(a=g.getTargetIdx(e.target.parentElement)),e.dropIndex=a,n=g.droppedRecord=g.parent.getCurrentViewRecords()[e.dropIndex]}(n.parentItem||"middleSegment"===g.dropPosition)&&-1!==(u=(c=i.parentData).indexOf(g.draggedRecord))&&c.splice(u,1);var s=g.treeGridData.indexOf(n);if(g.dropAtTop(s),"bottomSegment"===g.dropPosition){if(n.hasChildRecords?(p=g.getChildCount(n,0),g.parent.parentIdMapping&&g.treeData.splice(s+p+1,0,g.draggedRecord.taskData),g.treeGridData.splice(s+p+1,0,g.draggedRecord)):(g.parent.parentIdMapping&&g.treeData.splice(s+1,0,g.draggedRecord.taskData),g.treeGridData.splice(s+1,0,g.draggedRecord)),(0,S.isNullOrUndefined)(n.parentItem)&&(delete r.parentItem,delete r.parentUniqueID,r.level=0,g.parent.parentIdMapping&&(r[g.parent.parentIdMapping]=null)),n.parentItem){var d=g.getChildrecordsByParentID(n.parentUniqueID)[0].childRecords,h=d.indexOf(n)+1;d.splice(h,0,r),r.parentItem=n.parentItem,r.parentUniqueID=n.parentUniqueID,r.level=n.level,g.parent.parentIdMapping&&(r[g.parent.parentIdMapping]=n[g.parent.parentIdMapping],r.parentItem=n.parentItem,r.level=n.level)}r.hasChildRecords&&(g.updateChildRecordLevel(r,1),g.updateChildRecord(r,s+p+1))}g.dropMiddle(s)}if((0,S.isNullOrUndefined)(r.parentItem)){var c,u=(c=i.parentData).indexOf(g.droppedRecord),f=0;c.filter((function(e){r.uniqueID===e.uniqueID&&f++})),"bottomSegment"===g.dropPosition&&0===f?c.splice(u+1,0,r):"topSegment"===g.dropPosition&&0===f&&c.splice(u,0,r)}i.rowDragAndDropModule.refreshGridDataSource()},g=this,f=0;f<c;f++)u(f)}},e.prototype.dropMiddle=function(e){var t=this.parent,r=vt(this.droppedRecord),i=(0,S.isNullOrUndefined)(r)||0===r.length?e+1:r.length+e+1;"middleSegment"===this.dropPosition&&(t.parentIdMapping?(this.treeData.splice(i,0,this.draggedRecord.taskData),this.treeGridData.splice(i,0,this.draggedRecord)):this.treeGridData.splice(i,0,this.draggedRecord),this.recordLevel(),this.draggedRecord.hasChildRecords&&this.updateChildRecord(this.draggedRecord,i))},e.prototype.dropAtTop=function(e){var t=this.parent;if("topSegment"===this.dropPosition&&(t.parentIdMapping&&this.treeData.splice(e,0,this.draggedRecord.taskData),this.draggedRecord.parentItem=this.treeGridData[parseInt(e.toString(),10)].parentItem,this.draggedRecord.parentUniqueID=this.treeGridData[parseInt(e.toString(),10)].parentUniqueID,this.draggedRecord.level=this.treeGridData[parseInt(e.toString(),10)].level,this.treeGridData.splice(parseInt(e.toString(),10),0,this.draggedRecord),this.draggedRecord.hasChildRecords&&(this.updateChildRecord(this.draggedRecord,e),this.updateChildRecordLevel(this.draggedRecord,1)),this.droppedRecord.parentItem)){var r=this.getChildrecordsByParentID(this.droppedRecord.parentUniqueID)[0].childRecords,i=r.indexOf(this.droppedRecord);r.splice(i,0,this.draggedRecord)}},e.prototype.recordLevel=function(){var e=this.parent,t=this.draggedRecord,r=this.droppedRecord,i=e.childMapping;if(r.hasChildRecords||(r.hasChildRecords=!0,r.hasFilteredChildRecords=!0,((0,S.isNullOrUndefined)(r.childRecords)||0===r.childRecords.length)&&(r.childRecords=[],!e.parentIdMapping&&(0,S.isNullOrUndefined)(r.taskData[""+i])&&(r.taskData[""+i]=[]))),"middleSegment"===this.dropPosition){var n=(0,S.extend)({},r);delete n.childRecords,t.parentItem=n,t.parentUniqueID=r.uniqueID,r.childRecords.splice(r.childRecords.length,0,t),e.isSelfReference&&(r[e.childMapping]=[],r[e.childMapping].splice(r[e.childMapping].length,0,t)),(0,S.isNullOrUndefined)(t)||e.parentIdMapping||(0,S.isNullOrUndefined)(r.taskData[""+i])||r.taskData[e.childMapping].splice(r.childRecords.length,0,t.taskData),t.hasChildRecords?(t.level=r.level+1,this.updateChildRecordLevel(t,1)):t.level=r.level+1,r.expanded=!0}},e.prototype.deleteDragRow=function(){this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?(this.treeGridData=this.parent.grid.dataSource.dataSource.json,this.treeData=this.parent.dataSource.dataSource.json):(this.treeGridData=this.parent.grid.dataSource,this.treeData=this.parent.dataSource);var e=xt(this.parent,this.draggedRecord.uniqueID);!(0,S.isNullOrUndefined)(e.childRecords)&&e.childRecords.length&&(e.hasChildRecords=!0),this.removeRecords(e)},e.prototype.updateChildRecord=function(e,t){var r,i,n=this.parent;if(!e.hasChildRecords)return 0;i=e.childRecords.length;for(var o=0;o<i;o++)r=this.isMultipleGrid?e.childRecords[parseInt(o.toString(),10)]:(0,S.getValue)("uniqueIDCollection."+e.childRecords[parseInt(o.toString(),10)].uniqueID,n),t++,n.flatData.splice(t,0,r),(0,S.setValue)("uniqueIDCollection."+r.uniqueID,r,this.parent),n.parentIdMapping&&this.treeData.splice(t,0,r.taskData),r.hasChildRecords&&(t=this.updateChildRecord(r,t));return t},e.prototype.updateChildRecordLevel=function(e,t){var r,i;if(t++,!e.hasChildRecords)return 0;r=e.childRecords.length;for(var n=0;n<r;n++){i=this.isMultipleGrid?e.childRecords[parseInt(n.toString(),10)]:(0,S.getValue)("uniqueIDCollection."+e.childRecords[parseInt(n.toString(),10)].uniqueID,this.parent);var o=void 0;e.parentItem&&(o=xt(this.parent,e.parentItem.uniqueID)),(0,S.isNullOrUndefined)(o)&&!(0,S.isNullOrUndefined)(e.parentItem)&&(o=e.parentItem),i.level=e.parentItem?o.level+t:e.level+1,i.hasChildRecords&&(t--,t=this.updateChildRecordLevel(i,t))}return t},e.prototype.removeRecords=function(e){var t,r=this.parent;t=this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;var i=e,n=!(0,S.isNullOrUndefined)(r.parentIdMapping),o=this.getChildrecordsByParentID(i.parentUniqueID)[0];if(i){if(i.parentItem){var a=o?o.childRecords:[],s=0;a&&a.length>0&&(s=a.indexOf(i),o.childRecords.splice(s,1),this.parent.parentIdMapping&&!r.enableImmutableMode||$t({value:i,action:"delete"},this.parent,n,i.index,i.index))}if(r.parentIdMapping){i.hasChildRecords&&i.childRecords.length>0&&this.removeChildItem(i);for(var d=void 0,l=void 0,p=t,h=0;h<p.length;h++)p[parseInt(h.toString(),10)][this.parent.idMapping]===i.taskData[this.parent.idMapping]&&(d=h);for(h=0;h<this.treeGridData.length;h++)this.treeGridData[parseInt(h.toString(),10)][this.parent.idMapping]===i.taskData[this.parent.idMapping]&&(l=h);-1===d||(0,S.isNullOrUndefined)(d)||t.splice(d,1),-1===l||(0,S.isNullOrUndefined)(l)||this.treeGridData.splice(l,1)}var c=this.treeGridData.indexOf(i);if(!r.parentIdMapping){var u=this.parent.parentData.indexOf(i);-1!==u&&(r.parentData.splice(u,1),t.splice(u,1))}if(-1===c&&!r.parentIdMapping)for(var g=r.getPrimaryKeyFieldNames()[0],f=0;f<this.treeGridData.length;f++)this.treeGridData[parseInt(f.toString(),10)][""+g]===i[""+g]&&(c=f);if(!r.parentIdMapping){var y=this.getChildCount(i,0);this.treeGridData.splice(c,y+1)}i.parentItem&&o&&o.childRecords&&!o.childRecords.length&&(o.expanded=!1,o.hasChildRecords=!1,o.hasFilteredChildRecords=!1),-1!==this.parent[this.modifiedRecords].indexOf(o)||(0,S.isNullOrUndefined)(o)||this.parent[this.modifiedRecords].push(o),(0,S.isNullOrUndefined)(o)||this.updateModifiedRecords(o)}},e.prototype.updateModifiedRecords=function(e){var t=xt(this.parent,e.parentUniqueID);(0,S.isNullOrUndefined)(t)||(this.parent[this.modifiedRecords].push(t),this.updateModifiedRecords(t))},e.prototype.removeChildItem=function(e){var t,r,i,n;n=this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var o=0;o<e.childRecords.length;o++){t=e.childRecords[parseInt(o.toString(),10)],!(0,S.isNullOrUndefined)(t.childRecords)&&t.childRecords.length&&(t.hasChildRecords=!0);var a;a=this.parent.dataSource instanceof ct.DataManager&&wt(this.parent)?this.parent.dataSource.dataSource.json:this.parent.dataSource;for(var s=0;s<a.length;s++)a[parseInt(s.toString(),10)][this.parent.idMapping]===t.taskData[this.parent.idMapping]&&(r=s);for(var d=0;d<this.treeGridData.length;d++)if(this.treeGridData[parseInt(d.toString(),10)][this.parent.idMapping]===t.taskData[this.parent.idMapping]){i=d;break}-1===r||(0,S.isNullOrUndefined)(r)||n.splice(r,1),-1===i||(0,S.isNullOrUndefined)(i)||this.treeGridData.splice(i,1),t.hasChildRecords&&this.removeChildItem(t)}},e.prototype.getChildCount=function(e,t){var r;if(!e.hasChildRecords)return 0;for(var i=0;i<e.childRecords.length;i++)t++,(r=e.childRecords[parseInt(i.toString(),10)]).hasChildRecords&&(t=this.getChildCount(r,t));return t},e.prototype.ensuredropPosition=function(e,t){var r=this;e.filter((function(e){if(e.hasChildRecords&&!(0,S.isNullOrUndefined)(e.childRecords)){if(-1!==e.childRecords.indexOf(t))return r.dropPosition="Invalid",r.addErrorElem(),void(r.canDrop=!1);r.ensuredropPosition(e.childRecords,t)}}))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ge,this.Rowdraging),this.parent.off(Qe,this.rowDropped),this.parent.off(_e,this.rowsAdded),this.parent.off(He,this.rowsRemoved))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e}(),cr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cr(t,e),function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);o>3&&a&&Object.defineProperty(t,r,a)}([(0,S.Property)()],t.prototype,"targetID",void 0),t}(S.ChildProperty),gr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),fr=function(e){function t(t){var r=e.call(this,t)||this;return r.addEventListener(),r}return gr(t,e),t.prototype.addEventListener=function(){this.parent.on(ke,this.getDatas,this)},t.prototype.getDatas=function(e){this.visualData=e.data},t.prototype.getDataInfo=function(){return e.prototype.getData.call(this)},t.prototype.generateRows=function(t,r){!(0,S.isNullOrUndefined)(r.virtualInfo)&&r.virtualInfo.loadNext&&r.virtualInfo.nextInfo.page!==this.parent.pageSettings.currentPage?this.parent.setProperties({pageSettings:{currentPage:r.virtualInfo.nextInfo.page}},!0):(0,S.isNullOrUndefined)(r.virtualInfo)||r.virtualInfo.loadNext||r.virtualInfo.page===this.parent.pageSettings.currentPage||this.parent.setProperties({pageSettings:{currentPage:r.virtualInfo.page}},!0);var i=this.getDataInfo();if((0,S.isNullOrUndefined)(r.virtualInfo)||("right"!==r.virtualInfo.direction&&"left"!==r.virtualInfo.direction?(this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||gt(this.parent))&&1!==r.virtualInfo.blockIndexes.length||(r.virtualInfo.blockIndexes=i.blockIndexes):r.virtualInfo.blockIndexes=this.getBlockIndexes(r.virtualInfo.page)),this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||gt(this.parent))return e.prototype.generateRows.call(this,t,r);(0,S.isNullOrUndefined)(r.requestType)||"collapseAll"!==r.requestType.toString()||(r.requestType="refresh");for(var n=e.prototype.generateRows.call(this,t,r),o=0;o<n.length;o++)n[parseInt(o.toString(),10)].index=this.visualData.indexOf(n[parseInt(o.toString(),10)].data);return n},t.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","reorder","save","delete"].some((function(t){return e===t}));if(this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||gt(this.parent)){var r=this.model.currentPage;t?(this.cache={},this.data={},this.groups={}):"virtualscroll"===e&&this.cache[parseInt(r.toString(),10)]&&this.cache[parseInt(r.toString(),10)].length>this.parent.contentModule.getBlockSize()&&delete this.cache[parseInt(r.toString(),10)]}else(t||"virtualscroll"===e)&&(this.cache={},this.data={},this.groups={});return t},t}(x.VirtualRowModelGenerator),yr=function(){function e(e){x.Grid.Inject(x.Filter),this.parent=e,this.isHierarchyFilter=!1,this.filteredResult=[],this.flatFilteredData=[],this.filteredParentRecs=[],this.addEventListener()}return e.prototype.getModuleName=function(){return"filter"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.addEventListener=function(){this.parent.on("updateFilterRecs",this.updatedFilteredRecord,this),this.parent.on("clearFilters",this.clearFilterLevel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateFilterRecs",this.updatedFilteredRecord),this.parent.off("clearFilters",this.clearFilterLevel))},e.prototype.updatedFilteredRecord=function(e){(0,S.setValue)("uniqueIDFilterCollection",{},this.parent),this.flatFilteredData=e.data,this.filteredParentRecs=[],this.filteredResult=[],this.isHierarchyFilter=!1;for(var t=0;t<this.flatFilteredData.length;t++){var r=this.flatFilteredData[parseInt(t.toString(),10)];this.addParentRecord(r);var i=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;"Child"!==i&&"None"!==i||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key||(this.isHierarchyFilter=!0);var n=(0,x.getObject)("childRecords",r);!(0,S.isNullOrUndefined)(n)&&n.length&&(0,S.setValue)("hasFilteredChildRecords",this.checkChildExsist(r),r);var o=(0,x.getObject)("parentItem",r);if(!(0,S.isNullOrUndefined)(o)){var a=xt(this.parent,r.parentItem.uniqueID,!0);(0,S.setValue)("hasFilteredChildRecords",!0,a),a&&a.parentItem&&this.updateParentFilteredRecord(a)}}this.flatFilteredData.length>0&&this.isHierarchyFilter&&this.updateFilterLevel(),this.parent.notify("updateAction",{result:this.filteredResult})},e.prototype.updateParentFilteredRecord=function(e){var t=xt(this.parent,e.parentItem.uniqueID,!0),r=(0,S.getValue)("uniqueIDFilterCollection",this.parent);t&&Object.prototype.hasOwnProperty.call(r,t.uniqueID)&&(0,S.setValue)("hasFilteredChildRecords",!0,t),t&&t.parentItem&&this.updateParentFilteredRecord(t)},e.prototype.addParentRecord=function(e){var t=xt(this.parent,e.parentUniqueID);if("None"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key)(0,S.isNullOrUndefined)(t)||("Child"!==(""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode)||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key||-1!==this.flatFilteredData.indexOf(t))&&this.addParentRecord(t),-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),(0,S.setValue)("uniqueIDFilterCollection."+e.uniqueID,e,this.parent));else if((0,S.isNullOrUndefined)(t)){if(-1!==this.flatFilteredData.indexOf(e))return void(-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),(0,S.setValue)("uniqueIDFilterCollection."+e.uniqueID,e,this.parent),e.hasFilteredChildRecords=!0))}else this.addParentRecord(t),-1!==this.flatFilteredData.indexOf(t)||-1!==this.filteredResult.indexOf(t)?-1===this.filteredResult.indexOf(e)&&(this.filteredResult.push(e),(0,S.setValue)("uniqueIDFilterCollection."+e.uniqueID,e,this.parent)):-1===this.filteredResult.indexOf(e)&&-1!==this.flatFilteredData.indexOf(e)&&(this.filteredResult.push(e),(0,S.setValue)("uniqueIDFilterCollection."+e.uniqueID,e,this.parent))},e.prototype.checkChildExsist=function(e){for(var t=(0,x.getObject)("childRecords",e),r=!1,i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)].childRecords,o=""===this.parent.grid.searchSettings.key?this.parent.filterSettings.hierarchyMode:this.parent.searchSettings.hierarchyMode;if(!("Child"!==o&&"Both"!==o||0===this.parent.grid.filterSettings.columns.length&&""===this.parent.grid.searchSettings.key)){var a=(0,S.getValue)("uniqueIDFilterCollection",this.parent);Object.prototype.hasOwnProperty.call(a,t[parseInt(i.toString(),10)].uniqueID)||(this.filteredResult.push(t[parseInt(i.toString(),10)]),(0,S.setValue)("uniqueIDFilterCollection."+t[parseInt(i.toString(),10)].uniqueID,t[parseInt(i.toString(),10)],this.parent),r=!0)}if("None"===o&&(0!==this.parent.grid.filterSettings.columns.length||""!==this.parent.grid.searchSettings.key)&&-1!==this.flatFilteredData.indexOf(t[parseInt(i.toString(),10)])){r=!0;break}!(0,S.isNullOrUndefined)(n)&&n.length&&(r=this.checkChildExsist(t[parseInt(i.toString(),10)])),"Child"!==o&&"Both"!==o||!t.length||(r=!0)}return r},e.prototype.updateFilterLevel=function(){for(var e=this.filteredResult,t=this.filteredResult.length,r=0;r<t;r++){var i=xt(this.parent,e[parseInt(r.toString(),10)].parentUniqueID);if(-1!==e.indexOf(i)){var n=xt(this.parent,e[parseInt(r.toString(),10)].parentUniqueID,!0);e[parseInt(r.toString(),10)].filterLevel=n.filterLevel+1}else e[parseInt(r.toString(),10)].filterLevel=0,this.filteredParentRecs.push(e[parseInt(r.toString(),10)])}},e.prototype.clearFilterLevel=function(e){for(var t,r=0,i=e.flatData,n=i.length;r<n;r++){var o=(t=i[parseInt(r.toString(),10)]).filterLevel;!o&&0!==o&&(0,S.isNullOrUndefined)(t.hasFilteredChildRecords)||(t.hasFilteredChildRecords=null,t.filterLevel=null)}this.filteredResult=[],this.parent.notify("updateResults",{result:i,count:i.length})},e}(),mr=function(){function e(e){this.isCollapsedStatePersist=!1,x.Grid.Inject(x.ExcelExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"ExcelExport"},e.prototype.addEventListener=function(){this.parent.on("updateResults",this.updateExcelResultModel,this),this.parent.on("excelCellInfo",this.excelQueryCellInfo,this),this.parent.grid.on("export-RowDataBound",this.exportRowDataBound,this),this.parent.grid.on("finalPageSetup",this.finalPageSetup,this)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateResults",this.updateExcelResultModel),this.parent.off("excelCellInfo",this.excelQueryCellInfo),this.parent.grid.off("export-RowDataBound",this.exportRowDataBound),this.parent.grid.off("finalPageSetup",this.finalPageSetup))},e.prototype.updateExcelResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,t,r,i,n){var o=this,a=this.parent.dataSource,s=Object();return(0,S.setValue)("isCsv",n,s),(0,S.setValue)("cancel",!1,s),(0,S.isNullOrUndefined)(e)||(this.isCollapsedStatePersist=e.isCollapsedStatePersist),new Promise((function(d){var l=!o.isLocal()||a instanceof ct.DataManager?o.parent.dataSource:new ct.DataManager(a),p=new ct.Query;if(o.isLocal()||(p=o.generateQuery(p),(0,S.setValue)("query",p,s)),o.parent.trigger(X,(0,S.extend)(s,e)),(0,x.getObject)("cancel",s))return null;l.executeQuery(p).then((function(s){var l=null;return(0,S.isNullOrUndefined)(e)||(0,S.isNullOrUndefined)(e.dataSource)||(l=e.dataSource),e=o.manipulateExportProperties(e,a,s),o.parent.grid.excelExportModule.Map(o.parent.grid,e,t,r,n,i).then((function(t){null!=l?e.dataSource=l:delete e.dataSource,d(t)}))}))}))},e.prototype.generateQuery=function(e,t){return!(0,S.isNullOrUndefined)(t)&&"CurrentPage"===t.exportType&&this.parent.allowPaging&&(t.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=(0,x.getObject)("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulateExportProperties=function(e,t,r){var i=Object();if((0,S.setValue)("query",this.parent.grid.getDataModule().generateQuery(!0),i),(0,S.setValue)("isExport",!0,i),(0,S.isNullOrUndefined)(e)||(0,S.isNullOrUndefined)(e.exportType)||(0,S.setValue)("exportType",e.exportType,i),this.isLocal()||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData((0,x.getObject)("result",r)),(0,S.setValue)("expresults",this.parent.flatData,i)),this.parent.notify("dataProcessor",i),i=this.dataResults,t=(0,S.isNullOrUndefined)(i.result)?this.parent.flatData.slice(0):i.result,this.isLocal()||(this.parent.flatData=[]),e&&e.dataSource&&this.isLocal()){var n=this.parent.flatData,o=e.dataSource instanceof ct.DataManager?e.dataSource.dataSource.json:e.dataSource;this.parent.dataModule.convertToFlatData(o),t=this.parent.flatData,this.parent.flatData=n}return(e=(0,S.isNullOrUndefined)(e)?Object():e).dataSource=new ct.DataManager({json:t}),e.query=i.query,e},e.prototype.excelQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var t={},r=e.data,i=(0,S.isNullOrUndefined)(r.filterLevel)?r.level:r.filterLevel;t.indent=i,e.style=t}this.parent.notify("updateResults",e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.exportRowDataBound=function(e){if("excel"===e.type){var t=e.rowObj.data,r=this.parent.grid.filterSettings.columns.length,i=e.excelRows.length,n=t.level;if(t.parentItem&&xt(this.parent,t.parentItem.uniqueID,Boolean(r))){var o=!1,a=!1,s=St(this.parent,t,this.parent.parentData);!this.isCollapsedStatePersist||s&&this.parent.isLocalData||(o=!0,a=!t.expanded),e.excelRows[i-1].grouping={outlineLevel:n,isCollapsed:a,isHidden:o}}else t.hasChildRecords&&(0,S.isNullOrUndefined)(t.parentItem)&&(e.excelRows[i-1].grouping={outlineLevel:n})}},e.prototype.finalPageSetup=function(e){for(var t=0;t<e.worksheets.length;t++)e.worksheets[parseInt(t.toString(),10)].rows&&(e.worksheets[parseInt(t.toString(),10)].pageSetup={isSummaryRowBelow:!1})},e.prototype.isLocal=function(){return!ut(this.parent)&&wt(this.parent)},e}(),Sr=function(){function e(e){x.Grid.Inject(x.PdfExport),this.parent=e,this.dataResults={},this.addEventListener()}return e.prototype.getModuleName=function(){return"PdfExport"},e.prototype.addEventListener=function(){this.parent.on("pdfCellInfo",this.pdfQueryCellInfo,this),this.parent.on("updateResults",this.updatePdfResultModel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("pdfCellInfo",this.pdfQueryCellInfo),this.parent.off("updateResults",this.updatePdfResultModel))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.updatePdfResultModel=function(e){this.dataResults=e},e.prototype.Map=function(e,t,r,i){var n=this,o=this.parent.dataSource,a=Object(),s=!ut(this.parent)&&wt(this.parent);return(0,S.setValue)("cancel",!1,a),new Promise((function(d){var l=!s||o instanceof ct.DataManager?n.parent.dataSource:new ct.DataManager(o),p=new ct.Query;if(s||(p=n.generateQuery(p),(0,S.setValue)("query",p,a)),n.parent.trigger($,(0,S.extend)(a,e)),(0,x.getObject)("cancel",a))return null;l.executeQuery(p).then((function(a){var s=null;return(0,S.isNullOrUndefined)(e)||(0,S.isNullOrUndefined)(e.dataSource)||(s=e.dataSource),e=n.manipulatePdfProperties(e,o,a),n.parent.grid.pdfExportModule.Map(n.parent.grid,e,t,r,i).then((function(t){null!=s?e.dataSource=s:delete e.dataSource,d(t)}))}))}))},e.prototype.generateQuery=function(e,t){return!(0,S.isNullOrUndefined)(t)&&"CurrentPage"===t.exportType&&this.parent.allowPaging&&(t.exportType="AllPages",e.addParams("ExportType","CurrentPage"),e.where(this.parent.parentIdMapping,"equal",null),e=(0,x.getObject)("grid.renderModule.data.pageQuery",this.parent)(e)),e},e.prototype.manipulatePdfProperties=function(e,t,r){var i={},n=!ut(this.parent)&&wt(this.parent);if((0,S.setValue)("query",this.parent.grid.getDataModule().generateQuery(!0),i),(0,S.setValue)("isExport",!0,i),(0,S.setValue)("isPdfExport",!0,i),(0,S.isNullOrUndefined)(e)||(0,S.isNullOrUndefined)(e.isCollapsedStatePersist)||(0,S.setValue)("isCollapsedStatePersist",e.isCollapsedStatePersist,i),(0,S.isNullOrUndefined)(e)||(0,S.isNullOrUndefined)(e.exportType)||(0,S.setValue)("exportType",e.exportType,i),n||(this.parent.parentData=[],this.parent.dataModule.convertToFlatData((0,S.getValue)("result",r)),(0,S.setValue)("expresults",this.parent.flatData,i)),this.parent.notify("dataProcessor",i),i=this.dataResults,t=(0,S.isNullOrUndefined)(i.result)?this.parent.flatData.slice(0):i.result,n||(this.parent.flatData=[]),e&&e.dataSource&&n){var o=this.parent.flatData,a=e.dataSource instanceof ct.DataManager?e.dataSource.dataSource.json:e.dataSource;this.parent.dataModule.convertToFlatData(a),t=this.parent.flatData,this.parent.flatData=o}return(e=(0,S.isNullOrUndefined)(e)?{}:e).dataSource=new ct.DataManager({json:t}),e.query=i.query,e},e.prototype.pdfQueryCellInfo=function(e){if(this.parent.grid.getColumnIndexByUid(e.column.uid)===this.parent.treeColumnIndex){var t={},r=(0,x.getObject)("data",e),i=(0,S.isNullOrUndefined)(r.filterLevel)?r.level:r.filterLevel;t.paragraphIndent=3*i,e.style=t}this.parent.notify("updateResults",e),this.parent.trigger("pdfQueryCellInfo",e)},e}(),vr=function(){function e(e){x.Grid.Inject(x.Page),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(oe,this.collapseExpandPagedchilds,this),this.parent.on(ae,this.pageAction,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(oe,this.collapseExpandPagedchilds),this.parent.off(ae,this.pageAction))},e.prototype.getModuleName=function(){return"pager"},e.prototype.refresh=function(){this.parent.grid.pagerModule.refresh()},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.goToPage=function(e){this.parent.grid.pagerModule.goToPage(e)},e.prototype.updateExternalMessage=function(e){this.parent.grid.pagerModule.updateExternalMessage(e)},e.prototype.collapseExpandPagedchilds=function(e){if(e.record.expanded="collapse"!==e.action,this.parent.flatData.map((function(t){return t.expanded=t.uniqueID===e.record.uniqueID&&t.expanded!==e.record.expanded?e.record.expanded:t.expanded})),this.parent.enableImmutableMode){var t=this.parent.getPrimaryKeyFieldNames()[0],r=this.parent.flatData.filter((function(r){return r[""+t]===e.record[""+t]}));r.length&&(r[0].expanded=e.record.expanded)}var i={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};if((0,S.getValue)("grid.renderModule",this.parent).dataManagerSuccess(i),this.parent.enableImmutableMode){var n="action",o=void 0;"collapse"===i[""+n]?(o=i.row.getElementsByClassName("e-treegridexpand")[0],(0,S.isNullOrUndefined)(o)||((0,S.removeClass)([o],"e-treegridexpand"),(0,S.addClass)([o],"e-treegridcollapse"))):"expand"===i[""+n]&&(o=i.row.getElementsByClassName("e-treegridcollapse")[0],(0,S.isNullOrUndefined)(o)||((0,S.removeClass)([o],"e-treegridcollapse"),(0,S.addClass)([o],"e-treegridexpand")))}},e.prototype.pageRoot=function(e,t,r){for(var i=(0,S.isNullOrUndefined)(r)?[]:r,n=function(r){i.push(t[parseInt(r.toString(),10)]);var n=[];t[parseInt(r.toString(),10)].hasChildRecords&&(n=e.filter((function(e){return t[parseInt(r.toString(),10)].uniqueID===e.parentUniqueID})),i=o.pageRoot(e,n,i))},o=this,a=0;a<t.length;a++)n(a);return i},e.prototype.updatePageSize=function(e){var t=e.result.length,r=this.parent.grid.pagerModule;!0===this.parent.pageSettings.pageSizes&&r.pagerObj.pagerdropdownModule.dropDownListObject.value===r.pagerObj.getLocalizedLabel("All")&&(r.pagerObj.totalRecordsCount=t,this.parent.grid.pageSettings.pageSize=t)},e.prototype.pageAction=function(e){var t=this,r=new ct.DataManager(e.result);if("Root"===this.parent.pageSettings.pageSizeMode){var i=[],n=this.parent.grid.filterSettings.columns.length>0&&("Child"===this.parent.filterSettings.hierarchyMode||"None"===this.parent.filterSettings.hierarchyMode)?"filterLevel":"level",o=(new ct.Query).where(n,"equal",0);i=r.executeLocal(o),e.count=i.length;var a=(c=this.parent.grid.pageSettings.pageSize)*((u=this.parent.grid.pageSettings.currentPage)-1);o=o.skip(a).take(c),i=r.executeLocal(o);var s=this.pageRoot(e.result,i);e.result=s}else{var d,l=new ct.DataManager(e.result),p=new ct.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),h=l.executeLocal((new ct.Query).where(p));d=!yt(this.parent)||this.parent.searchSettings.key===this.parent.grid.searchSettings.key&&this.parent.filterSettings.columns.length===this.parent.grid.filterSettings.columns.length?h.filter((function(e){return St(t.parent,e,h)})):h,e.count=d.length,o=new ct.Query;var c=this.parent.grid.pageSettings.pageSize;this.updatePageSize(e);var u=this.parent.grid.pageSettings.currentPage;d.length<u*c&&(u=(u=Math.floor(d.length/c)+(d.length%c?1:0))||1,this.parent.grid.setProperties({pageSettings:{currentPage:u}},!0)),a=c*(u-1),o=o.skip(a).take(c),l.dataSource.json=d,e.result=l.executeLocal(o)}this.parent.notify("updateAction",e)},e}(),wr=function(){function e(e){x.Grid.Inject(x.Toolbar),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.addEventListener=function(){this.parent.on(K,this.refreshToolbar,this),this.parent.on(Y,this.refreshToolbar,this),this.parent.on(J,this.toolbarClickHandler,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(K,this.refreshToolbar),this.parent.off(Y,this.refreshToolbar),this.parent.off(J,this.toolbarClickHandler))},e.prototype.refreshToolbar=function(e){var t=this.parent.grid.toolbarModule.getToolbar();if(!(0,S.isNullOrUndefined)(t)){var r=this.parent,i=void 0,n=void 0,o=r.element.id+"_gridcontrol_indent",a=r.element.id+"_gridcontrol_outdent",s=t.querySelector("#"+o),d=t.querySelector("#"+a),l=e.row,p=r.getSelectedRows()[0];if((0,S.isNullOrUndefined)(l[0])||(l=l[0]),l=(0,S.isNullOrUndefined)(p)||p.rowIndex===l.rowIndex?l:p,null!==s&&null!==d){if(i=t.querySelector("#"+o).parentElement,n=t.querySelector("#"+a).parentElement,0===l.rowIndex||r.getSelectedRowIndexes().length>1)i.classList.add("e-hidden"),n.classList.add("e-hidden");else if("rowDeselected"!==e.name||!(0,S.isNullOrUndefined)(p)&&r.grid.isCheckBoxSelection){var h=r.getCurrentViewRecords()[l.rowIndex];(0,S.isNullOrUndefined)(h)||(h.level>r.getCurrentViewRecords()[l.rowIndex-1].level?i.classList.add("e-hidden"):i.classList.remove("e-hidden"),h.level===r.getCurrentViewRecords()[l.rowIndex-1].level&&i.classList.remove("e-hidden"),0===h.level&&n.classList.add("e-hidden"),0!==h.level&&n.classList.remove("e-hidden"))}"rowDeselected"===e.name&&(0,S.isNullOrUndefined)(p)&&!r.grid.isCheckBoxSelection&&(this.parent.toolbar.includes("Indent")&&i.classList.add("e-hidden"),this.parent.toolbar.includes("Outdent")&&n.classList.add("e-hidden"))}}},e.prototype.toolbarClickHandler=function(e){var t=this.parent,r="indentOutdentAction";"Cell"===this.parent.editSettings.mode&&"Batch"===this.parent.grid.editSettings.mode&&e.item.id===this.parent.grid.element.id+"_update"&&(e.cancel=!0,this.parent.grid.editModule.saveCell()),e.item.id===this.parent.grid.element.id+"_expandall"&&this.parent.expandAll(),e.item.id===this.parent.grid.element.id+"_collapseall"&&this.parent.collapseAll(),e.item.id===t.grid.element.id+"_indent"&&t.getSelectedRecords().length&&!(0,S.isNullOrUndefined)(t.rowDragAndDropModule)&&this.parent.rowDragAndDropModule[""+r](null,"indent"),e.item.id===t.grid.element.id+"_outdent"&&t.getSelectedRecords().length&&!(0,S.isNullOrUndefined)(t.rowDragAndDropModule)&&this.parent.rowDragAndDropModule[""+r](null,"outdent")},e.prototype.getToolbar=function(){return this.parent.grid.toolbarModule.getToolbar()},e.prototype.enableItems=function(e,t){this.parent.grid.toolbarModule.enableItems(e,t)},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ir=function(){function e(e){x.Grid.Inject(x.Aggregate),this.parent=e,this.flatChildRecords=[],this.summaryQuery=[]}return e.prototype.getModuleName=function(){return"summary"},e.prototype.removeEventListener=function(){this.parent.isDestroyed},e.prototype.calculateSummaryValue=function(e,t,r){var i;this.summaryQuery=e;for(var n=[],o=0,a=Object.keys(t).length;o<a;o++)(0,x.getObject)("isSummaryRow",t[parseInt(o.toString(),10)])||n.push(t[parseInt(o.toString(),10)]);var s,d=mt(n),l=n.slice(),p=Object.keys(this.parent.aggregates).length,h=Object.keys(d).length,c=this.parent.getColumns();if(this.parent.aggregates.filter((function(e){return e.showChildSummary})).length){var u=0;for(a=h;u<a;u++)if(i=d[parseInt(u.toString(),10)],s=this.getChildRecordsLength(i,l)){for(var g=function(e,t){var n,o=void 0;o={};for(var a=0;a<c.length;a++)o[""+((0,S.isNullOrUndefined)((0,x.getObject)("field",c[parseInt(a.toString(),10)]))?c[parseInt(a.toString(),10)]:(0,x.getObject)("field",c[parseInt(a.toString(),10)]))]=null;if(o=f.createSummaryItem(o,f.parent.aggregates[e-1]),!f.parent.aggregates[e-1].showChildSummary)return"continue";l.map((function(e,t){e.uniqueID!==i.uniqueID||(n=t)}));var d=n+s+e,p=(0,S.extend)({},i);delete p.childRecords,delete p[f.parent.childMapping],(0,S.setValue)("parentItem",p,o);var h=(0,x.getObject)("level",p);if((0,S.setValue)("level",h+1,o),(0,S.setValue)("isSummaryRow",!0,o),(0,S.setValue)("parentUniqueID",p.uniqueID,o),r){var u=(0,x.getObject)("childRecords",i);u.length&&u.push(o)}l.splice(d,0,o)},f=this,y=1,m=p;y<=m;y++)g(y);this.flatChildRecords=[]}}else{for(var v={},w=0,I=c.length;w<I;w++)v[""+((0,S.isNullOrUndefined)((0,x.getObject)("field",c[parseInt(w.toString(),10)]))?c[parseInt(w.toString(),10)]:(0,x.getObject)("field",c[parseInt(w.toString(),10)]))]=null;y=1;for(var R=p;y<=R;y++)this.createSummaryItem(v,this.parent.aggregates[y-1])}return l},e.prototype.getChildRecordsLength=function(e,t){for(var r,i=0,n=Object.keys(t).length;i<n;i++)if(r=t[parseInt(i.toString(),10)],e===((0,S.isNullOrUndefined)(r.parentItem)?null:t.filter((function(e){return e.uniqueID===r.parentItem.uniqueID}))[0])){if(this.flatChildRecords.push(r),!(0,x.getObject)("hasChildRecords",r))continue;this.getChildRecordsLength(r,t)}return this.flatChildRecords.length},e.prototype.createSummaryItem=function(e,t){for(var r=0,i=Object.keys(t.columns).length;r<i;r++)for(var n=(0,S.isNullOrUndefined)(t.columns[parseInt(r.toString(),10)].columnName)?t.columns[parseInt(r.toString(),10)].field:t.columns[parseInt(r.toString(),10)].columnName,o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(s===n)if(this.flatChildRecords.length)e[""+s]=this.getSummaryValues(t.columns[parseInt(r.toString(),10)],this.flatChildRecords);else if(this.parent.isLocalData){var d=this.parent.dataSource instanceof ct.DataManager?this.parent.dataSource.dataSource.json:this.parent.flatData;e[""+s]=this.getSummaryValues(t.columns[parseInt(r.toString(),10)],d)}}return e},e.prototype.getSummaryValues=function(e,t){var r=new ct.Query,i={},n={},o=(0,S.isNullOrUndefined)(e.field)?void 0:this.parent.getColumnByField(e.field).type;e.setPropertiesSilent({format:this.getFormatFromType(e.format,o)}),e.setFormatter(this.parent.grid.locale);var a=e.getFormatter()||function(e){return e};e.setTemplate(n);var s=e.getTemplate(2);r.queries=this.summaryQuery,r.requiresCount();var d,l=new ct.DataManager(t).executeLocal(r),p=e.type;p=[e.type];for(var h=0;h<p.length;h++){d=p[parseInt(h.toString(),10)];var c=e.field+" - "+p[parseInt(h.toString(),10)].toLowerCase(),u="Custom"!==p[parseInt(h.toString(),10)]?(0,x.getObject)("aggregates",l):(0,x.calculateAggregate)(p[parseInt(h.toString(),10)],l,e,this.parent),g=e.columnName,f="Custom"!==p[parseInt(h.toString(),10)]?u[""+c]:u;i[""+g]=i[""+g]||{},i[""+g][""+c]=f,i[""+g][p[parseInt(h.toString(),10)]]=(0,S.isNullOrUndefined)(u)?" ":a(f)}n.format=e.getFormatter();var y=(0,S.createElement)("td",{className:"e-summary"});if(this.parent.isReact){s.fn(i[e.columnName],this.parent,s.property,"",null,null,y);var m=this;m.parent.renderReactTemplates((function(){m.parent.trigger(z,m.parent.args)}))}else(0,x.appendChildren)(y,s.fn(i[e.columnName],this.parent,s.property));var v=i[""+e.columnName][""+d];return-1===y.innerHTML.indexOf(v)?y.innerHTML+v:y.innerHTML},e.prototype.getFormatFromType=function(e,t){if((0,S.isNullOrUndefined)(t)||"string"!=typeof e)return e;var r;switch(t){case"number":r={format:e};break;case"datetime":r={type:"dateTime",skeleton:e};break;case"date":r={type:t,skeleton:e}}return r},e.prototype.destroy=function(){this.removeEventListener()},e}(),Rr=function(){function e(e){x.Grid.Inject(x.Sort),this.parent=e,this.taskIds=[],this.flatSortedData=[],this.storedIndex=-1,this.isSelfReference=!(0,S.isNullOrUndefined)(this.parent.parentIdMapping),this.addEventListener()}return e.prototype.getModuleName=function(){return"sort"},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("createSort",this.createdSortedRecords,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("createSort",this.createdSortedRecords))},e.prototype.createdSortedRecords=function(e){var t=e.modifiedData,r=e.srtQry;this.iterateSort(t,r),this.storedIndex=-1,e.modifiedData=this.flatSortedData,this.flatSortedData=[]},e.prototype.iterateSort=function(e,t){for(var r=0;r<e.length;r++)if((this.parent.grid.filterSettings.columns.length>0||""!==this.parent.grid.searchSettings.key)&&(0,S.isNullOrUndefined)(xt(this.parent,e[parseInt(r.toString(),10)].uniqueID,!0))||(this.storedIndex++,this.flatSortedData[this.storedIndex]=e[parseInt(r.toString(),10)]),e[parseInt(r.toString(),10)].hasChildRecords){var i=new ct.DataManager(e[parseInt(r.toString(),10)].childRecords).executeLocal(t);if(this.parent.allowRowDragAndDrop&&-1!==e[parseInt(r.toString(),10)].childRecords.indexOf(this.parent.rowDragAndDropModule.draggedRecord)&&"middleSegment"!==this.parent.rowDragAndDropModule.dropPosition){var n=i.indexOf(this.parent.rowDragAndDropModule.draggedRecord);i.splice(n,1);var o=i.indexOf(this.parent.rowDragAndDropModule.droppedRecord);"topSegment"===this.parent.rowDragAndDropModule.dropPosition?i.splice(o,0,this.parent.rowDragAndDropModule.draggedRecord):"bottomSegment"===this.parent.rowDragAndDropModule.dropPosition&&i.splice(o+1,0,this.parent.rowDragAndDropModule.draggedRecord)}this.iterateSort(i,t)}},e.prototype.sortColumn=function(e,t,r){this.parent.grid.sortColumn(e,t,r)},e.prototype.removeSortColumn=function(e){this.parent.grid.removeSortColumn(e)},e.prototype.updateModel=function(){this.parent.setProperties({sortSettings:(0,x.getActualProperties)(this.parent.grid.sortSettings)},!0)},e.prototype.clearSorting=function(){this.parent.grid.clearSorting(),this.updateModel()},e.prototype.destroy=function(){this.removeEventListener()},e}(),xr=function(){function e(e){x.Grid.Inject(x.ColumnMenu),this.parent=e}return e.prototype.getColumnMenu=function(){return this.parent.grid.columnMenuModule.getColumnMenu()},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"columnMenu"},e}(),Cr=function(){function e(e){x.Grid.Inject(x.ContextMenu),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("contextMenuOpen",this.contextMenuOpen,this),this.parent.on("contextMenuClick",this.contextMenuClick,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("contextMenuOpen",this.contextMenuOpen),this.parent.off("contextMenuClick",this.contextMenuClick))},e.prototype.contextMenuOpen=function(e){var t=(0,S.select)("#"+this.parent.element.id+"_gridcontrol_cmenu_AddRow",e.element),r=(0,S.select)("#"+this.parent.element.id+"_gridcontrol_cmenu_Edit",e.element),i=(0,S.select)("#"+this.parent.element.id+"_gridcontrol_cmenu_Indent",e.element),n=(0,S.select)("#"+this.parent.element.id+"_gridcontrol_cmenu_Outdent",e.element);t&&(!1===this.parent.grid.editSettings.allowAdding||this.parent.grid.isEdit?t.style.display="none":t.style.display="block"),"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||(0,S.isNullOrUndefined)(r)||r.classList.contains("e-menu-hide")||(r.style.display="none");var o=this.parent,a=o.getSelectedRows()[0];if(!i&&!n||(0,S.isNullOrUndefined)(a)){if((i||n||o.grid.isEdit)&&(0,S.isNullOrUndefined)(a)){for(var s=0,d=e.items;s<d.length;s++)"Outdent"!==(u=d[s]).text&&"Indent"!==u.text||o.grid.contextMenuModule.hiddenItems.push(u.text);o.grid.contextMenuModule.contextMenu.hideItems(o.grid.contextMenuModule.hiddenItems)}}else{var l=e.event.target.closest("td");if(!(0,S.isNullOrUndefined)(l)&&((0,S.isNullOrUndefined)(l)||l.classList.contains("e-rowcell")&&0===l.querySelectorAll(".e-gridform").length)){if(0===a.rowIndex||o.getSelectedRowIndexes().length>1)i.style.display=n.style.display="none";else if("rowDeselected"!==e.name||!(0,S.isNullOrUndefined)(a)&&o.grid.isCheckBoxSelection){var p=o.getCurrentViewRecords()[a.rowIndex];(0,S.isNullOrUndefined)(p)||(p.level>o.getCurrentViewRecords()[a.rowIndex-1].level?i.style.display="none":i.style.display="block",p.level===o.getCurrentViewRecords()[a.rowIndex-1].level&&(i.style.display="block"),0===p.level?n.style.display="none":n.style.display="block")}}else{for(var h=0,c=e.items;h<c.length;h++){var u;"Outdent"!==(u=c[h]).text&&"Indent"!==u.text||o.grid.contextMenuModule.hiddenItems.push(u.text)}o.grid.contextMenuModule.contextMenu.hideItems(o.grid.contextMenuModule.hiddenItems),i.style.display=n.style.display="none"}}},e.prototype.contextMenuClick=function(e){if("Above"!==e.item.id&&"Below"!==e.item.id&&"Child"!==e.item.id||(this.parent.notify("savePreviousRowPosition",e),this.parent.setProperties({editSettings:{newRowPosition:e.item.id}},!0),this.parent.editModule.isAddedRowByContextMenu=!0,this.parent.addRecord()),(e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"||e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Outdent")&&!(0,S.isNullOrUndefined)(this.parent.rowDragAndDropModule)){var t=e.item.id===this.parent.element.id+"_gridcontrol_cmenu_Indent"?"indent":"outdent";this.parent.rowDragAndDropModule.indentOutdentAction(null,t)}},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getContextMenu=function(){return this.parent.grid.contextMenuModule.getContextMenu()},e}(),br=function(){function e(e){this.batchChildCount=0,this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.batchAddedRecords=[],this.batchDeletedRecords=[],this.batchAddRowRecord=[],this.parent=e,this.isSelfReference=!(0,S.isNullOrUndefined)(e.parentIdMapping),this.batchRecords=[],this.currentViewRecords=[],this.isAdd=!1,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on(Se,this.cellSaved,this),this.parent.on(Re,this.batchAdd,this),this.parent.on(Ce,this.beforeBatchAdd,this),this.parent.on(De,this.batchSave,this),this.parent.on(xe,this.beforeBatchDelete,this),this.parent.on(be,this.beforeBatchSave,this),this.parent.on("batchPageAction",this.batchPageAction,this),this.parent.on("batchCancelAction",this.batchCancelAction,this),this.parent.grid.on("immutable-batch-cancel",this.immutableBatchAction,this),this.parent.grid.on("next-cell-index",this.nextCellIndex,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Se,this.cellSaved),this.parent.off(Re,this.batchAdd),this.parent.off(De,this.batchSave),this.parent.off(Ce,this.beforeBatchAdd),this.parent.off(xe,this.beforeBatchDelete),this.parent.off(be,this.beforeBatchSave),this.parent.off("batchPageAction",this.batchPageAction),this.parent.off("batchCancelAction",this.batchCancelAction),this.parent.grid.off("immutable-batch-cancel",this.immutableBatchAction),this.parent.grid.off("next-cell-index",this.nextCellIndex))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getBatchRecords=function(){return this.batchRecords},e.prototype.getAddRowIndex=function(){return this.addRowIndex},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.getBatchChildCount=function(){return this.batchChildCount},e.prototype.batchPageAction=function(){var e,t=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,r=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!(0,S.isNullOrUndefined)(this.batchAddedRecords)&&this.batchAddedRecords.length)for(var i=0;i<this.batchAddedRecords.length;i++)e=t.map((function(e){return e[""+r]})).indexOf(this.batchAddedRecords[parseInt(i.toString(),10)][""+r]),t.splice(e,1);this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.batchDeletedRecords=this.currentViewRecords=[]},e.prototype.cellSaved=function(e){if(e.column.index===this.parent.treeColumnIndex&&this.parent.renderModule.cellRender({data:e.rowData,cell:e.cell,column:this.parent.grid.getColumnByIndex(e.column.index)}),this.isAdd&&"Batch"===this.parent.editSettings.mode&&"Bottom"!==this.parent.editSettings.newRowPosition){var t=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,r=void 0,i=this.parent.grid.getPrimaryKeyFieldNames()[0],n=void 0,o=void 0,a="parentItem",s=this.selectedIndex>-1?this.batchRecords[parseInt(this.addRowIndex.toString(),10)][""+a]:null,d=void 0,l=void 0,p=void 0,h="Top"===this.parent.editSettings.newRowPosition||-1===this.selectedIndex?0:"Above"===this.parent.editSettings.newRowPosition?this.addRowIndex:this.addRowIndex+1;if(h=this.getActualRowObjectIndex(h),this.newBatchRowAdded){if(this.batchRecords.length&&(d=this.batchRecords[this.addRowIndex][this.parent.idMapping],p=this.batchRecords[this.addRowIndex][this.parent.parentIdMapping],this.batchRecords[parseInt(this.addRowIndex.toString(),10)][""+a]&&(l=this.batchRecords[parseInt(this.addRowIndex.toString(),10)][""+a].uniqueID)),this.batchAddedRecords=It(this.batchAddedRecords),this.batchAddRowRecord=It(this.batchAddRowRecord),this.batchAddRowRecord.push(this.batchRecords[this.addRowIndex]),(r=this.parent.grid.getRowsObject()[parseInt(h.toString(),10)].changes).uniqueID=(0,x.getUid)(this.parent.element.id+"_data_"),(0,S.setValue)("uniqueIDCollection."+r.uniqueID,r,this.parent),!Object.prototype.hasOwnProperty.call(r,"level")){if(this.batchIndex=-1===this.selectedIndex?0:this.batchIndex,"Child"===this.parent.editSettings.newRowPosition){if(r.primaryParent=s,this.selectedIndex>-1){r.parentItem=(0,S.extend)({},this.batchRecords[this.addRowIndex]),r.parentUniqueID=r.parentItem.uniqueID,delete r.parentItem.childRecords,delete r.parentItem[this.parent.childMapping],r.level=r.parentItem.level+1,r.index=this.batchIndex;var c=vt(this.batchRecords[this.addRowIndex]).length,u=vt(this.batchRecords[this.addRowIndex])[c-1];u=(0,S.isNullOrUndefined)(u)?this.batchRecords[this.addRowIndex]:u,n=t.map((function(e){return e[""+i]})).indexOf(u[""+i]),this.isSelfReference&&(r[this.parent.parentIdMapping]=d),er(i,r.parentItem,"add",this.parent,this.isSelfReference,r)}}else"Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||(0,S.isNullOrUndefined)(this.batchRecords[this.addRowIndex])||(r.level=this.batchRecords[parseInt(this.addRowIndex.toString(),10)].level,r.level&&this.selectedIndex>-1&&(r.parentItem=s,r.parentUniqueID=l,delete r.parentItem.childRecords,delete r.parentItem[this.parent.childMapping]),r.index="Below"===this.parent.editSettings.newRowPosition?this.batchIndex:this.batchIndex-1,"Below"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1&&(c=vt(this.batchRecords[this.addRowIndex]).length,u=vt(this.batchRecords[this.addRowIndex])[c-1],u=(0,S.isNullOrUndefined)(u)?this.batchRecords[this.addRowIndex]:u,n=t.map((function(e){return e[""+i]})).indexOf(u[""+i])),"Above"===this.parent.editSettings.newRowPosition&&this.selectedIndex>-1&&(u=this.batchRecords[this.addRowIndex],n=t.map((function(e){return e[""+i]})).indexOf(u[""+i])),this.isSelfReference&&(r[this.parent.parentIdMapping]=p));r.index=-1===r.index?0:r.index,r.hasChildRecords=!1,r.childRecords=[],this.batchRecords.splice(r.index,0,r),this.currentViewRecords.splice(r.index,0,r),o=n||r.index,"Above"!==this.parent.editSettings.newRowPosition&&(o=0===r.index?o:o+1),t.splice(o,0,r),this.batchAddedRecords.push(r)}this.parent.grid.getRowsObject()[parseInt(h.toString(),10)].data=r,this.newBatchRowAdded=!1}}},e.prototype.beforeBatchAdd=function(e){var t="isTabLastRow";if("Cell"===this.parent.editSettings.mode&&this.parent.editModule[""+t])return e.cancel=!0,void(this.parent.editModule[""+t]=!1);!this.parent.editModule.isAddedRowByMethod||(0,S.isNullOrUndefined)(this.parent.editModule.addRowIndex)||this.parent.editModule.isAddedRowByContextMenu||-1!==this.parent.grid.selectedRowIndex&&!this.parent.editModule.batchEditModule.isAdd?(this.selectedIndex=this.parent.grid.selectedRowIndex,this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.parent.editModule.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0,this.addRowRecord=this.parent.getSelectedRecords()[0]):(this.selectedIndex=this.parent.editModule.selectedIndex,this.addRowIndex=this.parent.editModule.addRowIndex,this.addRowRecord=this.batchRecords.length?this.batchRecords[this.selectedIndex]:this.parent.getCurrentViewRecords()[this.selectedIndex])},e.prototype.batchAdd=function(e){if("Bottom"!==this.parent.editSettings.newRowPosition){this.isAdd=!0,this.newBatchRowAdded=!0;var t=0;if(this.batchRecords.length||(this.batchAddedRecords=[],this.batchRecords=It(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=It(this.parent.grid.getCurrentViewRecords())),this.parent.editModule.isAddedRowByMethod&&!(0,S.isNullOrUndefined)(this.parent.editModule.addRowIndex)&&(0,S.classList)(this.parent.grid.getDataRows()[0],["e-batchrow"],[]),"Top"!==this.parent.editSettings.newRowPosition){var r=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(r=this.batchRecords),this.updateChildCount(r),this.parent.notify(fe,{}),this.batchChildCount=0}this.updateRowIndex();var i=(0,S.getValue)("focusModule",this.parent.grid),n=this.parent.getContentTable();if(this.parent.getBatchChanges()[this.deletedRecords].length&&"Above"===this.parent.editSettings.newRowPosition?(t=e.row.rowIndex,i.getContent().matrix.matrix=this.matrix):t=n.getElementsByClassName("e-batchrow")[0].rowIndex,i.getContent().matrix.current=[t,i.getContent().matrix.current[1]],this.parent.editModule.isAddedRowByMethod&&!(0,S.isNullOrUndefined)(this.parent.editModule.addRowIndex)&&!this.parent.editModule.isAddedRowByContextMenu){var o=this.parent.getBatchChanges().addedRecords,a=parseInt(this.parent.getContentTable().getElementsByClassName("e-insertedrow")[o.length-1].getAttribute("data-rowindex"),10);this.batchRecords.splice(a,0,o[o.length-1])}}},e.prototype.beforeBatchDelete=function(e){this.batchRecords.length||(this.batchRecords=It(this.parent.grid.getCurrentViewRecords()),this.currentViewRecords=It(this.parent.grid.getCurrentViewRecords()));var t=(0,S.getValue)("focusModule",this.parent.grid);this.matrix=t.getContent().matrix.matrix;var r,i,n,o,a=[],s=this.parent.grid.getPrimaryKeyFieldNames()[0];(0,S.isNullOrUndefined)(e.row)||-1!==this.parent.getSelectedRows().indexOf(e.row)?(n=vt(i=this.parent.grid.getSelectedRecords()[this.parent.grid.getSelectedRecords().length-1]),o=this.parent.getSelectedRows()[0].getAttribute("data-uid")):(n=vt(i=e.rowData),o=e.row.getAttribute("data-uid"));var d=parseInt(this.parent.grid.getRowElementByUID(o).getAttribute("data-rowindex"),10);if(n.length)for(var l=d+n.length,p=d+1;p<=l;p++)a.push(this.parent.grid.getDataRows()[parseInt(p.toString(),10)]),(this.parent.frozenRows||this.parent.frozenColumns||this.parent.getFrozenColumns())&&a.push(this.parent.grid.getHeaderContent()[parseInt(p.toString(),10)]);if(!(0,S.isNullOrUndefined)(i.parentItem)){var h=xt(this.parent,i.parentItem.uniqueID);if(!(0,S.isNullOrUndefined)(h)&&h.hasChildRecords){var c=h.childRecords.indexOf(i);h.childRecords.splice(c,1)}this.batchDeletedRecords=It(this.batchDeletedRecords),this.batchDeletedRecords.push(i)}for(n.push(i),r=n,p=0;p<r.length;p++){var u=this.batchRecords.map((function(e){return e[""+s]})).indexOf(r[parseInt(p.toString(),10)][""+s]);-1!==u&&this.batchRecords.splice(u,1)}for(p=0;p<a.length;p++)(0,S.isNullOrUndefined)(a[parseInt(p.toString(),10)])||this.parent.grid.selectionModule.selectedRecords.push(a[parseInt(p.toString(),10)])},e.prototype.updateRowIndex=function(){for(var e=this.parent.grid.getDataRows(),t=0;t<e.length;t++)e[parseInt(t.toString(),10)].setAttribute("data-rowindex",t.toString())},e.prototype.updateChildCount=function(e){for(var t=this.parent.grid.getPrimaryKeyFieldNames()[0],r="addedRecords",i="Child"===this.parent.editSettings.newRowPosition?"primaryParent":"parentItem",n=0;n<this.parent.getBatchChanges()[""+r].length;n++)(0,S.isNullOrUndefined)(this.parent.getBatchChanges()[""+r][parseInt(n.toString(),10)][""+i])||this.parent.getBatchChanges()[""+r][parseInt(n.toString(),10)][""+i][""+t]===e[parseInt(this.addRowIndex.toString(),10)][""+t]&&(this.batchChildCount=this.batchChildCount+1)},e.prototype.beforeBatchSave=function(e){var t="changedRecords",r="deletedRecords",i=e.batchChanges[""+t];if(e.batchChanges[""+t].length)for(var n=0;n<i.length;n++)$t({value:i[parseInt(n.toString(),10)],action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,void 0);if(e.batchChanges[""+r].length){var o=e.batchChanges[""+r];for(n=0;n<o.length;n++){this.deleteUniqueID(o[parseInt(n.toString(),10)].uniqueID);for(var a=vt(o[parseInt(n.toString(),10)]),s=0;s<a.length;s++)this.deleteUniqueID(a[parseInt(s.toString(),10)].uniqueID);e.batchChanges[""+r]=e.batchChanges[""+r].concat(a)}}this.isAdd=!1},e.prototype.deleteUniqueID=function(e){delete this.parent.uniqueIDFilterCollection[""+e],delete this.parent.uniqueIDCollection[""+e]},e.prototype.batchCancelAction=function(){var e,t="targetElement",r="parentItem",i="index",n=this.parent.grid.getCurrentViewRecords(),o="childRecords",a=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,s=this.parent.grid.getPrimaryKeyFieldNames()[0];if(!(0,S.isNullOrUndefined)(this.batchAddedRecords))for(var d=0;d<this.batchAddedRecords.length;d++)if(-1!==(e=a.map((function(e){return e[""+s]})).indexOf(this.batchAddedRecords[parseInt(d.toString(),10)][""+s]))&&a.splice(e,1),"Child"===this.parent.editSettings.newRowPosition&&(e=n.map((function(e){return e[""+s]})).indexOf(this.batchAddedRecords[parseInt(d.toString(),10)][""+r]?this.batchAddedRecords[parseInt(d.toString(),10)][""+r][""+s]:this.batchAddedRecords[parseInt(d.toString(),10)][""+s]),!(0,S.isNullOrUndefined)(n[parseInt(e.toString(),10)])))for(var l=n[parseInt(e.toString(),10)][""+o],p=0;l&&p<l.length;p++)l[parseInt(p.toString(),10)][""+s]===this.batchAddedRecords[parseInt(d.toString(),10)][""+s]&&n[parseInt(e.toString(),10)][""+o].splice(p,1);if(!(0,S.isNullOrUndefined)(this.parent[""+t])){var h=this.parent[""+t].closest("tr");this.parent.collapseRow(h),this.parent[""+t]=null}if(!(0,S.isNullOrUndefined)(this.batchDeletedRecords))for(d=0;d<this.batchDeletedRecords.length;d++)if(!(0,S.isNullOrUndefined)(this.batchDeletedRecords[parseInt(d.toString(),10)][""+r])){e=n.map((function(e){return e[""+s]})).indexOf(this.batchDeletedRecords[parseInt(d.toString(),10)][""+r][""+s]);var c=0===this.batchDeletedRecords[parseInt(d.toString(),10)][""+i]?this.batchDeletedRecords[parseInt(d.toString(),10)][""+i]:this.batchDeletedRecords[parseInt(d.toString(),10)][""+i]-1;(0,S.isNullOrUndefined)(n[parseInt(e.toString(),10)])||n[parseInt(e.toString(),10)][""+o].splice(c,0,this.batchDeletedRecords[parseInt(d.toString(),10)])}this.batchAddedRecords=this.batchRecords=this.batchAddRowRecord=this.currentViewRecords=[],this.batchRecords=It(this.parent.grid.getCurrentViewRecords()),this.batchIndex=0,this.currentViewRecords=It(this.parent.grid.getCurrentViewRecords()),this.batchDeletedRecords=[],this.parent.grid.renderModule.refresh()},e.prototype.batchSave=function(e){if("Batch"===this.parent.editSettings.mode){var t=void 0,r=Object.hasOwnProperty.call(e,"updatedRecords")?e.updatedRecords:this.parent.getBatchChanges(),i="deletedRecords",n=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,o=this.parent.grid.getCurrentViewRecords(),a=this.parent.grid.getPrimaryKeyFieldNames()[0],s=r.addedRecords,d="parentItem",l=void 0,p=void 0,h=void 0,c=void 0,u="childRecords";if(s.length>1&&"Bottom"!==this.parent.editSettings.newRowPosition&&s.reverse(),"Bottom"!==this.parent.editSettings.newRowPosition&&!Object.hasOwnProperty.call(e,"updatedRecords")){if(n.splice(n.length-s.length,s.length),this.parent.editModule.isAddedRowByMethod&&s.length&&!(0,S.isNullOrUndefined)(this.parent.editModule.addRowIndex)&&!this.parent.editModule.isAddedRowByContextMenu){s.reverse();for(var g=0;g<s.length;g++){var f=parseInt(this.parent.getContentTable().getElementsByClassName("e-insertedrow")[parseInt(g.toString(),10)].getAttribute("data-rowindex"),10);n.splice(f,0,s[parseInt(g.toString(),10)])}}if(this.parent.allowPaging||n.length===o.length){var y=It(n);if(y.length){var m=y.map((function(e){return e[""+a]})).indexOf(o[0][""+a]),v=m+this.parent.grid.pageSettings.pageSize;o=y.splice(m,v)}}else o.length>s.length&&o.splice(o.length-s.length,s.length)}for(0===this.batchAddRowRecord.length&&this.batchAddRowRecord.push(this.parent.flatData[e.index]),this.parent.editModule.isAddedRowByContextMenu&&s.reverse(),t=0;t<s.length;t++){var w=(0,S.extend)({},s[parseInt(t.toString(),10)]);if(delete w.parentItem,delete w.uniqueID,delete w.index,delete w.level,delete w.hasChildRecords,delete w.childRecords,delete w.parentUniqueID,(0,S.isNullOrUndefined)(w.primaryParent)||delete w.primaryParent,s.length>1&&this.parent.editModule.isAddedRowByContextMenu){var I=this.parent.editSettings.newRowPosition;this.parent.editSettings.newRowPosition=this.parent.editModule.previousNewRowPosition,this.parent.editModule.previousNewRowPosition=I}if(s[parseInt(t.toString(),10)].taskData=w,c=this.batchAddRowRecord[parseInt(t.toString(),10)],(0,S.isNullOrUndefined)(c)&&(c=this.batchAddRowRecord[t-1]),this.isSelfReference&&((0,S.isNullOrUndefined)(s[parseInt(t.toString(),10)].parentItem)||er(a,s[parseInt(t.toString(),10)].parentItem,"add",this.parent,this.isSelfReference,s[parseInt(t.toString(),10)])),(0,S.isNullOrUndefined)(c)||(p=c.index),"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition&&(0,S.isNullOrUndefined)(s[parseInt(t.toString(),10)].parentItem)&&-1===this.selectedIndex&&(l=-1,c=null),$t({value:s[parseInt(t.toString(),10)],action:"add"},this.parent,this.isSelfReference,p,l,h,c),l=null,"Child"===this.parent.editSettings.newRowPosition&&!(0,S.isNullOrUndefined)(s[parseInt(t.toString(),10)][""+d])&&((0,S.isNullOrUndefined)(this.parent.editModule.addRowIndex)||this.isSelfReference))for(var R=o.map((function(e){return e[""+a]})).indexOf(s[parseInt(t.toString(),10)][""+d][""+a]),x=o[parseInt(R.toString(),10)][""+u],C=0;C<x.length;C++)x[parseInt(C.toString(),10)][""+a]===s[parseInt(t.toString(),10)][""+a]&&o[parseInt(R.toString(),10)][""+u].splice(C,1)}if(r[""+i].length)for(t=0;t<r[""+i].length;t++)$t({value:r[""+i][parseInt(t.toString(),10)],action:"delete"},this.parent,this.isSelfReference,p,l,h,c);this.parent.parentData=[];for(var b=0;b<n.length;b++)n[parseInt(b.toString(),10)].index=b,(0,S.setValue)("uniqueIDCollection."+n[parseInt(b.toString(),10)].uniqueID+".index",b,this.parent),n[parseInt(b.toString(),10)].level||this.parent.parentData.push(n[parseInt(b.toString(),10)])}this.batchAddRowRecord=this.batchAddedRecords=this.batchRecords=this.batchDeletedRecords=this.currentViewRecords=[],this.parent.editModule.isAddedRowByContextMenu&&(this.parent.editModule.isAddedRowByContextMenu=!1)},e.prototype.getActualRowObjectIndex=function(e){var t=this.parent.grid.getDataRows();return("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&this.selectedIndex>-1&&(!(0,S.isNullOrUndefined)(this.batchRecords[this.addRowIndex])&&this.batchRecords[this.addRowIndex].expanded&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length?(e+=vt(this.batchRecords[this.addRowIndex]).length,"Child"!==this.parent.editSettings.newRowPosition&&(e+=this.getBatchChildCount())):e+=vt(this.batchRecords[this.addRowIndex]).length),e>=t.length&&(e=t.length-1),this.updateChildCount(this.parent.grid.getCurrentViewRecords()),this.batchChildCount&&(e+=this.batchChildCount),this.batchChildCount=0),e},e.prototype.immutableBatchAction=function(e){e.args.cancel=!0;var t=this.parent.grid.getBatchChanges(),r=[];Object.keys(t).length&&(r=t.addedRecords);for(var i=0;i<r.length;i++)e.rows.splice(r[parseInt(i.toString(),10)].index,1)},e.prototype.nextCellIndex=function(e){var t="index";this.parent.getSelectedRows().length?e[""+t]=this.parent.getSelectedRows()[0].rowIndex:e[""+t]=this.batchIndex},e}(),Dr=function(){function e(e){this.addedRecords="addedRecords",this.deletedRecords="deletedRecords",this.prevAriaRowIndex="-1",this.isAddedRowByMethod=!1,this.isAddedRowByContextMenu=!1,x.Grid.Inject(x.Edit),this.parent=e,this.isSelfReference=!(0,S.isNullOrUndefined)(e.parentIdMapping),this.previousNewRowPosition=null,this.internalProperties={},this.batchEditModule=new br(this.parent),this.addEventListener()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.addEventListener=function(){this.parent.on(ue,this.crudAction,this),this.parent.on(ge,this.beginEdit,this),this.parent.on(fe,this.beginAdd,this),this.parent.on(ye,this.recordDoubleClick,this),this.parent.on(me,this.cellSave,this),this.parent.on(Ie,this.batchCancel,this),this.parent.grid.on(Me,this.keyPressed,this),this.parent.grid.on("batchedit-form",this.lastCellTab,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on(ve,this.cellEdit,this),this.parent.on("actionBegin",this.editActionEvents,this),this.parent.on("actionComplete",this.editActionEvents,this),this.parent.grid.on(Pe,this.recordDoubleClick,this),this.parent.grid.on("dblclick",this.gridDblClick,this),this.parent.grid.on("recordAdded",this.customCellSave,this),this.parent.on("savePreviousRowPosition",this.savePreviousRowPosition,this),this.parent.grid.on(qe,this.beforeStartEdit,this),this.parent.grid.on(Ve,this.beforeBatchCancel,this),this.parent.grid.on("reset-edit-props",this.resetIsOnBatch,this),this.parent.grid.on("get-row-position",this.getRowPosition,this)},e.prototype.gridDblClick=function(e){if(this.doubleClickTarget=e.target,e.target.classList.contains("e-frame")&&0===this.parent.getCurrentViewRecords().length&&(this.doubleClickTarget=null),e.target.classList.contains("e-treegridcollapse")||e.target.classList.contains("e-treegridexpand")){var t=(0,x.parentsUntil)(e.target,"e-row"),r=t&&parseInt(t.getAttribute("data-rowindex"),10);!(0,S.isNullOrUndefined)(r)&&r>=0&&this.parent.allowPaging&&(this.parent.grid.getDataRows()[r].dataset.uid=this.parent.grid.contentModule.getRows()[r].uid)}},e.prototype.getRowPosition=function(e){e.newRowPosition=this.parent.editSettings.newRowPosition,e.addRowIndex=this.addRowIndex,e.dataRowIndex=+this.prevAriaRowIndex},e.prototype.beforeStartEdit=function(e){"Cell"===this.parent.editSettings.mode&&this.parent.trigger(_,e)},e.prototype.beforeBatchCancel=function(e){"Cell"===this.parent.editSettings.mode&&this.parent.trigger(G,e)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ue,this.crudAction),this.parent.off(ge,this.beginEdit),this.parent.off(fe,this.beginAdd),this.parent.off(ye,this.recordDoubleClick),this.parent.off(Ie,this.batchCancel),this.parent.grid.off(Me,this.keyPressed),this.parent.grid.off("batchedit-form",this.lastCellTab),this.parent.grid.off("content-ready",this.contentready),this.parent.off(ve,this.cellEdit),this.parent.off("actionBegin",this.editActionEvents),this.parent.off("actionComplete",this.editActionEvents),this.parent.grid.off("recordAdded",this.customCellSave),this.parent.grid.off(Pe,this.recordDoubleClick),this.parent.off("savePreviousRowPosition",this.savePreviousRowPosition),this.parent.grid.off(qe,this.beforeStartEdit),this.parent.grid.off(Ve,this.beforeBatchCancel),this.parent.grid.off("dblclick",this.gridDblClick),this.parent.grid.off("reset-edit-props",this.resetIsOnBatch),this.parent.grid.off("get-row-position",this.getRowPosition))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.applyFormValidation=function(e){this.parent.grid.editModule.applyFormValidation(e)},e.prototype.editActionEvents=function(e){var t=(0,x.getObject)("editAction",e),r=(0,x.getObject)("name",t),i=this.parent,n=i.dataSource.adaptor;if((ut(i)||n instanceof ct.RemoteSaveAdaptor)&&"save"===t.requestType&&"add"===t.action&&("Child"===i.editSettings.newRowPosition||"Below"===i.editSettings.newRowPosition||"Above"===i.editSettings.newRowPosition))if("actionBegin"===r){var o=(0,S.isNullOrUndefined)(t.row)||!Object.keys(t.row).length?this.selectedIndex:t.row.rowIndex-1,a=(0,S.isNullOrUndefined)(o)||-1===o?-1:i.getCurrentViewRecords()[parseInt(o.toString(),10)][i.getPrimaryKeyFieldNames()[0]];i.grid.query.addParams("relationalKey",a)}else if("actionComplete"===r)for(var s=i.grid.query.params.length,d=0;d<s;d++)"relationalKey"===i.grid.query.params[parseInt(d.toString(),10)].key&&i.grid.query.params.splice(d);this.parent.enableInfiniteScrolling&&"actionComplete"===r&&this.infiniteAddAction(t),"Batch"===this.parent.editSettings.mode&&"paging"===t.requestType&&this.parent.notify("batchPageAction",{})},e.prototype.infiniteAddAction=function(e){if("save"===e.requestType&&"add"===e.action||"delete"===e.requestType){if("Top"!==this.parent.editSettings.newRowPosition&&-1!==this.selectedIndex&&"save"===e.requestType&&"add"===e.action){var t=this.parent.grid.getRowsObject(),r=t.splice(0,1)[0],i=this.addRowIndex,n=this.parent.getCurrentViewRecords();"Below"!==this.parent.editSettings.newRowPosition&&"Child"!==this.parent.editSettings.newRowPosition||(i+=vt(n[i+1]).length),i="Below"===this.parent.editSettings.newRowPosition?i+1:i,t.splice(i,0,r);var o=n.splice(0,1)[0];n.splice(i,0,o),this.updateInfiniteCurrentViewData(o,this.addRowIndex)}var a=this.parent.grid.getRows(),s=this.parent.grid.getRowsObject(),d=this.parent.infiniteScrollSettings.enableCache;d||((0,x.resetRowIndex)(this.parent.grid,this.parent.grid.getRowsObject(),this.parent.grid.getRows(),0),this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords())),!d&&this.parent.getFrozenColumns()>0&&((0,x.resetRowIndex)(this.parent.grid,s,a,0),this.updateIndex(this.parent.grid.dataSource,a,this.parent.getCurrentViewRecords()))}},e.prototype.updateInfiniteCurrentViewData=function(e,t){var r=this,i=Math.ceil(t/this.parent.grid.pageSettings.pageSize),n=i>0?i:1,o=t-(n-1)*this.parent.pageSettings.pageSize,a=this.parent.grid.infiniteScrollModule.infiniteCurrentViewData;a[1].splice(0,1);var s=a[parseInt(n.toString(),10)];(0,S.isNullOrUndefined)(this.addRowRecord)||(s.filter((function(e,t){e.uniqueID===r.addRowRecord.uniqueID&&(o=t)})),(this.addRowRecord.hasChildRecords&&this.addRowRecord.childRecords.length&&"Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(o+=vt(this.addRowRecord).length)),o>=this.parent.pageSettings.pageSize&&(n+=1,s=a[parseInt(n.toString(),10)],o=o-this.parent.pageSettings.pageSize>=0?o-this.parent.pageSettings.pageSize:0),o="Below"===this.parent.editSettings.newRowPosition?o+1:o,s.splice(o,0,e),this.parent.grid.infiniteScrollModule.updateCurrentViewData()},e.prototype.recordDoubleClick=function(e){var t=e.target;if(!(0,S.isNullOrUndefined)(t.closest("td.e-rowcell"))&&this.parent.grid.editSettings.allowEditing&&!this.parent.grid.isEdit){var r=this.parent.grid.getColumnByIndex(+t.closest("td.e-rowcell").getAttribute("data-colindex"));if("Cell"===this.parent.editSettings.mode&&!this.isOnBatch&&r&&!r.isPrimaryKey&&this.parent.editSettings.allowEditing&&r.allowEditing&&!t.classList.contains("e-treegridexpand")&&!t.classList.contains("e-treegridcollapse")&&this.parent.editSettings.allowEditOnDblClick){if(this.isOnBatch=!0,this.parent.grid.setProperties({selectedRowIndex:e.rowIndex},!0),this.parent.enableVirtualization){var i=(0,x.parentsUntil)(e.target,"e-row");this.prevAriaRowIndex=i.getAttribute("data-rowindex"),i.setAttribute("data-rowindex",i.rowIndex+"")}this.updateGridEditMode("Batch")}else"Cell"!==this.parent.editSettings.mode||r.allowEditing&&!r.isPrimaryKey||(this.isOnBatch=!0,this.updateGridEditMode("Batch"))}},e.prototype.updateGridEditMode=function(e){this.parent.grid.setProperties({editSettings:{mode:e}},!0),(0,x.getObject)("updateEditObj",this.parent.grid.editModule).apply(this.parent.grid.editModule),this.parent.grid.isEdit=!1},e.prototype.resetIsOnBatch=function(){this.parent.enableVirtualization&&"Cell"===this.parent.editSettings.mode&&(this.isOnBatch=!1,this.updateGridEditMode("Normal"))},e.prototype.keyPressed=function(e){this.isOnBatch&&(this.keyPress=e.action),"f2"===e.action&&this.recordDoubleClick(e),"escape"===e.action&&this.parent.closeEdit()},e.prototype.deleteUniqueID=function(e){delete this.parent.uniqueIDFilterCollection[""+e],delete this.parent.uniqueIDCollection[""+e]},e.prototype.cellEdit=function(e){var t=this,r="promise",i=e[""+r];if(delete e[""+r],this.parent.enableVirtualization&&!(0,S.isNullOrUndefined)(this.prevAriaRowIndex)&&"-1"!==this.prevAriaRowIndex&&(e.row.setAttribute("data-rowindex",this.prevAriaRowIndex),this.prevAriaRowIndex=void 0),"enter"!==this.keyPress&&this.parent.trigger(ve,e,(function(e){e.cancel||"Cell"!==t.parent.editSettings.mode?e.cancel&&"Cell"===t.parent.editSettings.mode&&(t.isOnBatch=!1,t.updateGridEditMode("Normal")):t.enableToolbarItems("edit"),(0,S.isNullOrUndefined)(i)||i.resolve(e)})),this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-summarycell")))return e.cancel=!0,void(this.doubleClickTarget=null);"Cell"===this.parent.editSettings.mode&&("tab"===this.keyPress||"shiftTab"===this.keyPress?this.keyPress=null:"enter"===this.keyPress&&(e.cancel=!0,this.keyPress=null,(0,S.setValue)("isEditCollapse",!1,this.parent)),e.columnObject.allowEditing||(e.cancel=!0)),this.parent.enableVirtualization&&(this.parent.grid.contentModule.editedRowIndex=this.parent.grid.editModule.editModule.index)},e.prototype.enableToolbarItems=function(e){if(!(0,S.isNullOrUndefined)(this.parent.grid.toolbarModule)){var t=this.parent.element.id+"_gridcontrol_";this.parent.grid.toolbarModule.enableItems([t+"add",t+"edit",t+"delete"],"save"===e),this.parent.grid.toolbarModule.enableItems([t+"update",t+"cancel"],"edit"===e)}},e.prototype.batchCancel=function(){if("Cell"===this.parent.editSettings.mode){var e=(0,S.getValue)("editModule.cellDetails",this.parent.grid.editModule),t=this.parent.getCellFromIndex(e.rowIndex,this.parent.treeColumnIndex);this.parent.renderModule.cellRender({data:e.rowData,cell:t,column:this.parent.grid.getColumns()[this.parent.treeColumnIndex]}),this.updateGridEditMode("Normal"),this.isOnBatch=!1}"Batch"===this.parent.editSettings.mode&&this.parent.notify("batchCancelAction",{})},e.prototype.customCellSave=function(e){gt(this.parent)&&"Cell"===this.parent.editSettings.mode&&"edit"===e.action&&(this.updateCell(e,e.rowIndex),this.afterCellSave(e,e.row,e.rowIndex))},e.prototype.cellSave=function(e){var t=this;if("Cell"===this.parent.editSettings.mode&&this.parent.element.querySelector("form")){var r,i;e.cancel=!0,(0,S.setValue)("isEditCollapse",!0,this.parent),e.rowData[e.columnName]=e.value,r=(0,S.isNullOrUndefined)(e.cell)?this.parent.grid.editModule.editModule.form.parentElement.parentNode:e.cell.parentNode;var n=this.parent.getPrimaryKeyFieldNames();if((0,S.isNullOrUndefined)(r))this.parent.grid.getCurrentViewRecords().filter((function(t,r){t[n[0]]!==e.rowData[n[0]]||(i=r)}));else{var o=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;i=o?(this.parent.getRows().indexOf(r),this.parent.getRows().indexOf(r)):-1===this.parent.getRows().indexOf(r)&&this.parent.getFrozenColumns()>0?this.parent.grid.getRows().indexOf(r):this.parent.getRows().indexOf(r)}var a={};if((0,S.extend)(a,e),a.cancel=!1,a.type="save",r=this.parent.grid.getRows()[r.rowIndex],this.parent.trigger(_,a),a.cancel)this.parent.grid.isEdit=!0;else if(r.rowIndex===this.parent.getCurrentViewRecords().length-1&&"tab"===this.keyPress&&(this.isTabLastRow=!0),ut(this.parent)||this.parent.dataSource instanceof ct.DataManager&&this.parent.dataSource.adaptor instanceof ct.RemoteSaveAdaptor){if(ut(this.parent)||this.parent.dataSource instanceof ct.DataManager&&this.parent.dataSource.adaptor instanceof ct.RemoteSaveAdaptor){var s=this.parent.grid.query;this.parent.isGantt&&!this.parent.loadChildOnDemand?(this.updateCell(e,i),(0,S.setValue)("isEdit",!1,this.parent.grid),this.afterCellSave(e,r,i)):this.parent.grid.dataSource.update(n[0],e.rowData,s.fromTable,s,e.previousValue).then((function(n){(0,S.isNullOrUndefined)(n)||(e.rowData[e.columnName]=n[e.columnName]),t.updateCell(e,i),(0,S.setValue)("isEdit",!1,t.parent.grid),t.afterCellSave(e,r,i)}))}}else if(gt(this.parent)){var d={requestType:"save",data:e.rowData,action:"edit",row:r,rowIndex:i,rowData:e.rowData,columnName:e.columnName,filterChoiceCount:null,excelSearchOperator:null};this.parent.grid.getDataModule().eventPromise(d,this.parent.grid.query)}else this.updateCell(e,i),(0,S.setValue)("isEdit",!1,this.parent.grid),this.afterCellSave(e,r,i)}this.parent.enableVirtualization&&(this.parent.grid.contentModule.virtualData={})},e.prototype.afterCellSave=function(e,t,r){this.parent.grid.aggregateModule&&this.parent.grid.aggregateModule.refresh(e.rowData),this.parent.grid.editModule.destroyWidgets([this.parent.grid.getColumnByField(e.columnName)]),this.parent.grid.editModule.formObj.destroy(),"tab"!==this.keyPress&&"shiftTab"!==this.keyPress&&(this.updateGridEditMode("Normal"),this.isOnBatch=!1),this.enableToolbarItems("save"),(0,S.removeClass)([t],["e-editedrow","e-batchrow"]),(0,S.removeClass)(t.querySelectorAll(".e-rowcell"),["e-editedbatchcell","e-updatedtd"]),!1!==this.parent.isCellSaveFocus&&this.parent.grid.focusModule.restoreFocus(),$t({value:e.rowData,action:"edit"},this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,e.columnName),t.rowIndex===this.parent.getCurrentViewRecords().length-1&&"enter"===this.keyPress&&(this.keyPress=null);var i={type:"save",column:this.parent.getColumnByField(e.columnName),data:e.rowData,previousData:e.previousValue,row:t,target:e.cell};this.parent.aggregates.map((function(e){return!0===e.showChildSummary})).length&&this.parent.grid.refresh(),this.parent.trigger(G,i)},e.prototype.lastCellTab=function(){!this.parent.grid.isEdit&&this.isOnBatch&&"tab"===this.keyPress&&"Cell"===this.parent.editSettings.mode&&(this.parent.editSettings.allowNextRowEdit?this.enableToolbarItems("edit"):(this.updateGridEditMode("Normal"),this.isOnBatch=!1,this.keyPress=null))},e.prototype.updateCell=function(e,t){this.parent.grid.editModule.updateCell(t,e.columnName,e.rowData[e.columnName]),this.parent.grid.getRowsObject()[parseInt(t.toString(),10)].data=e.rowData},e.prototype.crudAction=function(e,t){$t(e,this.parent,this.isSelfReference,this.addRowIndex,this.selectedIndex,t,this.addRowRecord),this.parent.parentData=[];for(var r=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource,i=0;i<r.length;i++){r[parseInt(i.toString(),10)].index=i;var n=this.parent.grid.getPrimaryKeyFieldNames()[0];e.value[""+n]===r[parseInt(i.toString(),10)][""+n]&&"add"===e.action&&(r[parseInt(i.toString(),10)].level=this.internalProperties.level,r[parseInt(i.toString(),10)].taskData=this.internalProperties.taskData,r[parseInt(i.toString(),10)].uniqueID=this.internalProperties.uniqueID,(0,S.isNullOrUndefined)(this.internalProperties.parentItem)||(r[parseInt(i.toString(),10)].parentItem=this.internalProperties.parentItem,r[parseInt(i.toString(),10)].parentUniqueID=this.internalProperties.parentUniqueID),r[parseInt(i.toString(),10)].childRecords=this.internalProperties.childRecords),(0,S.setValue)("uniqueIDCollection."+r[parseInt(i.toString(),10)].uniqueID+".index",i,this.parent);var o=this.parent.dataSource.adaptor;(ut(this.parent)||o instanceof ct.RemoteSaveAdaptor)&&(0,S.setValue)("uniqueIDCollection."+r[parseInt(i.toString(),10)].uniqueID,r[parseInt(i.toString(),10)],this.parent),r[parseInt(i.toString(),10)].level||this.parent.parentData.push(r[parseInt(i.toString(),10)])}this.parent.enableInfiniteScrolling||"add"===e.action&&null!=this.previousNewRowPosition&&(this.parent.setProperties({editSettings:{newRowPosition:this.previousNewRowPosition}},!0),this.previousNewRowPosition=null)},e.prototype.updateIndex=function(e,t,r){for(var i=0;i<this.parent.getDataRows().length;i++){var n=r[parseInt(i.toString(),10)];if(!(0,S.isNullOrUndefined)(n)){var o=(0,S.getValue)("uniqueIDCollection."+n.uniqueID+".index",this.parent);if(n.index=o,!(0,S.isNullOrUndefined)(n.parentItem)){var a=(0,S.getValue)("uniqueIDCollection."+n.parentItem.uniqueID+".index",this.parent);n.parentItem.index=a}}}var s=-1,d=this.parent.treeColumnIndex;if(this.parent.getFrozenColumns()>0)for(var l=t[0].querySelectorAll(".e-rowcell"),p=0;p<l.length;p++)if(l[parseInt(p.toString(),10)].classList.contains("e-gridrowindex0level0")){d=p;break}for(var h=0;h<this.parent.getRows().length;h++){t[parseInt(h.toString(),10)].classList.contains("e-detailrow")||s++;var c=r[parseInt(s.toString(),10)];if(!(0,S.isNullOrUndefined)(c)){o=c.index;var u=c.level,g=t[parseInt(h.toString(),10)];(0,S.isNullOrUndefined)(c.parentItem)||(o=(0,S.getValue)("uniqueIDCollection."+c.parentItem.uniqueID+".index",this.parent));var f=g.cells[parseInt(d.toString(),10)];if(!(0,S.isNullOrUndefined)(f)){for(p=0;p<f.classList.length;p++){var y=f.classList[parseInt(p.toString(),10)],m=y.match(/e-gridrowindex/i),v=y.match(/e-griddetailrowindex/i);null!=m&&(0,S.removeClass)([f],y),null!=v&&(0,S.removeClass)([f],y)}t[parseInt(h.toString(),10)].classList.contains("e-detailrow")?(0,S.addClass)([f],"e-griddetailrowindex"+o+"level"+u):(0,S.addClass)([f],"e-gridrowindex"+o+"level"+u)}}}},e.prototype.beginAdd=function(){var e,t=this.addRowIndex,r=this.parent.grid.getCurrentViewRecords();"Batch"===this.parent.editSettings.mode&&(t=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex(),(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)&&(r=this.batchEditModule.getBatchRecords()));var i=this.parent.grid.getDataRows(),n=i.length?+i[0].getAttribute("data-rowindex"):0,o=i.length?+i[i.length-1].getAttribute("data-rowindex"):0,a=this.selectedIndex>=n&&this.selectedIndex<=o,s=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex;if("Dialog"!==this.parent.editSettings.mode&&("Above"===this.parent.editSettings.newRowPosition?e="before":("Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition)&&(this.selectedIndex>-1||s)&&a&&(e="after",!(0,S.isNullOrUndefined)(r[parseInt(t.toString(),10)])&&r[parseInt(t.toString(),10)].expanded&&("Batch"===this.parent.editSettings.mode&&(this.parent.getBatchChanges()[this.addedRecords].length>1||this.parent.getBatchChanges()[this.deletedRecords].length)?(t+=vt(r[parseInt(t.toString(),10)]).length,"Child"!==this.parent.editSettings.newRowPosition&&(t+=this.batchEditModule.getBatchChildCount())):this.parent.enableVirtualization||(t+=vt(r[parseInt(t.toString(),10)]).length))),(this.selectedIndex>-1||s)&&a&&(t||"Child"===this.parent.editSettings.newRowPosition||"Below"===this.parent.editSettings.newRowPosition))){t>=i.length-1&&(t=i.length-2);var d="rows",l=this.parent.grid.contentModule[""+d][0],p=document.activeElement;i[t+1][""+e](i[0]),(0,S.setValue)("batchIndex",t+1,this.batchEditModule);var h="Above"===this.parent.editSettings.newRowPosition?t:t+1;if("Batch"===this.parent.editSettings.mode&&(this.parent.grid.contentModule[""+d].splice(0,1),this.parent.grid.contentModule[""+d].splice(h,0,l)),"Row"===this.parent.editSettings.mode||"Cell"===this.parent.editSettings.mode){for(var c=this.parent.grid.getContentTable().querySelectorAll(".e-griderror"),u=0;u<c.length;u++)c[parseInt(u.toString(),10)].remove();(0,S.setValue)("errorRules",[],this.parent.grid.editModule.formObj)}s&&(this.prevAriaRowIndex="-1"),(!this.parent.enableVirtualization||this.parent.enableVirtualization&&!Object.keys(this.parent.grid.contentModule.emptyRowData).length)&&p.focus(),this.parent.enableVirtualization&&!Object.keys(this.parent.grid.contentModule.emptyRowData).length&&this.parent.grid.contentModule.createEmptyRowdata()}if("Batch"===this.parent.editSettings.mode&&!(0,S.isNullOrUndefined)(this.addRowIndex)&&-1!==this.addRowIndex&&this.isAddedRowByMethod&&!this.isAddedRowByContextMenu){t=this.batchEditModule.getAddRowIndex(),this.selectedIndex=this.batchEditModule.getSelectedIndex();var g=this.parent.getBatchChanges().addedRecords,f=void 0;if(g.length)for(u=0;u<g.length;u++)(0,S.isNullOrUndefined)(g[parseInt(u.toString(),10)].uniqueID)&&(f=g[parseInt(u.toString(),10)]);var y={action:"add",data:f,index:t,seletedRow:0};this.beginAddEdit(y),this.batchEditModule.batchAddRowRecord.push(this.batchEditModule.addRowRecord),this.batchEditModule.batchAddedRecords.push(y.data)}},e.prototype.beginEdit=function(e){if("refresh"===e.requestType&&this.isOnBatch)e.cancel=!0;else if("Cell"!==this.parent.editSettings.mode||"beginEdit"!==e.requestType){if(this.doubleClickTarget&&(this.doubleClickTarget.classList.contains("e-treegridexpand")||this.doubleClickTarget.classList.contains("e-treegridcollapse")||this.doubleClickTarget.classList.contains("e-frame")))return e.cancel=!0,void(this.doubleClickTarget=null);if("delete"===e.requestType){var t=e.data;if((0,S.isNullOrUndefined)(e.data[0].uniqueID))for(var r=this.parent.getPrimaryKeyFieldNames(),i=function(i){n.parent.flatData.filter((function(n){n[""+r[0]]===e.data[parseInt(i.toString(),10)][r[0]]&&(t[parseInt(i.toString(),10)]=n)}))},n=this,o=0;o<t.length;o++)i(o);for(o=0;o<t.length;o++){this.deleteUniqueID(t[parseInt(o.toString(),10)].uniqueID);for(var a=vt(t[parseInt(o.toString(),10)]),s=0;s<a.length;s++)this.deleteUniqueID(a[parseInt(s.toString(),10)].uniqueID);e.data=e.data.concat(a)}}if("add"===e.requestType||this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)){if((-1===this.parent.grid.selectedRowIndex&&this.isAddedRowByMethod||e.index!==this.parent.grid.selectedRowIndex)&&0!==e.index||(this.selectedIndex=this.parent.grid.selectedRowIndex),this.parent.enableVirtualization){var d='.e-row[data-rowindex="'+this.selectedIndex+'"]',l=void 0;this.selectedIndex>-1&&"Top"!==this.parent.editSettings.newRowPosition&&"Bottom"!==this.parent.editSettings.newRowPosition?(this.prevAriaRowIndex=this.selectedIndex.toString(),l=this.parent.getContent().querySelector(d),this.addRowIndex=l?l.rowIndex:0):this.prevAriaRowIndex&&"-1"!==this.prevAriaRowIndex?(d='.e-row[data-rowindex="'+this.prevAriaRowIndex+'"]',l=this.parent.getContent().querySelector(d),this.addRowIndex=l?l.rowIndex:0):this.addRowIndex=0}else this.isAddedRowByMethod&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?0!==e.index?this.addRowIndex=e.index:this.addRowIndex=this.parent.grid.selectedRowIndex:this.addRowIndex=this.parent.grid.selectedRowIndex>-1?this.parent.grid.selectedRowIndex:0;(this.isAddedRowByMethod||this.isAddedRowByContextMenu&&-1!==this.parent.grid.selectedRowIndex)&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?(this.addRowRecord=this.parent.flatData[this.parent.grid.selectedRowIndex],this.parent.enableVirtualization&&this.isAddedRowByContextMenu&&(this.addRowRecord=this.parent.getCurrentViewRecords()[this.addRowIndex])):this.addRowRecord=this.parent.getSelectedRecords()[0]}this.isAddedRowByMethod&&0!==e.index&&(this.addRowRecord=this.parent.flatData[e.index],this.addRowIndex=e.index),"Child"===this.parent.editSettings.newRowPosition&&(0,S.isNullOrUndefined)(this.addRowRecord)&&!(0,S.isNullOrUndefined)(this.parent.getSelectedRecords()[0])&&(this.addRowRecord=this.parent.getSelectedRecords()[0]),(0,S.isNullOrUndefined)(this.addRowRecord)&&this.parent.getCurrentViewRecords().length>this.addRowIndex&&"save"===e.requestType&&0!==this.parent.getSelectedRecords().length&&(this.addRowRecord=this.parent.getCurrentViewRecords()[this.addRowIndex]),this.isAddedRowByMethod=!1,e=this.beginAddEdit(e)}else e.cancel=!0},e.prototype.savePreviousRowPosition=function(){null===this.previousNewRowPosition&&(this.previousNewRowPosition=this.parent.editSettings.newRowPosition)},e.prototype.beginAddEdit=function(e){var t=e.data;if("add"===e.action){var r=this.parent.grid.getPrimaryKeyFieldNames()[0],i=null;t.taskData=(0,S.isNullOrUndefined)(t.taskData)?(0,S.extend)({},e.data):t.taskData;var n=void 0;n=this.parent.enableVirtualization&&0!==e.index?this.parent.flatData:"Batch"===this.parent.editSettings.mode&&this.isAddedRowByMethod&&!(0,S.isNullOrUndefined)(this.addRowIndex)?this.batchEditModule.batchRecords:this.parent.grid.getCurrentViewRecords(),this.parent.enableVirtualization&&0!==e.index&&(this.addRowIndex=this.parent.flatData.indexOf(this.addRowRecord),this.selectedIndex=this.addRowIndex);var o=this.addRowIndex;t.uniqueID=(0,x.getUid)(this.parent.element.id+"_data_"),(0,S.setValue)("uniqueIDCollection."+t.uniqueID,t,this.parent);var a=0,s=void 0,d=void 0,l=void 0,p=void 0,h=this.parent.enableVirtualization&&this.addRowIndex>-1&&"-1"!==this.prevAriaRowIndex,c=this.parent.getRows(),u=c.length?n.indexOf(n[0]):0,g=c.length?+c[c.length-1].getAttribute("data-rowindex"):0,f=!(!this.parent.enableVirtualization||0===e.index)||this.selectedIndex>=u&&this.selectedIndex<=g;if(n.length&&(s=n[this.addRowIndex][this.parent.idMapping],p=n[this.addRowIndex][this.parent.parentIdMapping],n[this.addRowIndex].parentItem&&(d=n[this.addRowIndex].parentItem.uniqueID),l=n[this.addRowIndex].parentItem),"Top"!==this.parent.editSettings.newRowPosition&&n.length){if(a=n[this.addRowIndex].level,"Above"===this.parent.editSettings.newRowPosition)i="before",o=n[this.addRowIndex].index;else if("Below"===this.parent.editSettings.newRowPosition){i="after";var y=vt(n[this.addRowIndex]).length,m=n[this.addRowIndex].index;o=y>0?m+y:m}else if("Child"===this.parent.editSettings.newRowPosition){i="after",(this.selectedIndex>-1||h)&&f&&(t.parentItem=(0,S.extend)({},n[this.addRowIndex]),t.parentUniqueID=t.parentItem.uniqueID,delete t.parentItem.childRecords,delete t.parentItem[this.parent.childMapping]);var v=vt(n[this.addRowIndex]).length,w=n[this.addRowIndex].index;this.selectedIndex>=0&&(t.level=a+1),o=v>0?w+v:w,this.isSelfReference&&(this.parent.isLocalData||-1!==this.parent.editModule.selectedIndex?t.taskData[this.parent.parentIdMapping]=t[this.parent.parentIdMapping]=s:t.taskData[this.parent.parentIdMapping]=t[this.parent.parentIdMapping]=null,(0,S.isNullOrUndefined)(t.parentItem)||er(r,t.parentItem,"add",this.parent,this.isSelfReference,t))}if("Above"!==this.parent.editSettings.newRowPosition&&"Below"!==this.parent.editSettings.newRowPosition||((this.selectedIndex>-1||h)&&a&&f&&(t.parentUniqueID=d,t.parentItem=(0,S.extend)({},l),delete t.parentItem.childRecords,delete t.parentItem[this.parent.childMapping]),t.level=a,this.isSelfReference&&(t.taskData[this.parent.parentIdMapping]=t[this.parent.parentIdMapping]=p,(0,S.isNullOrUndefined)(t.parentItem)||er(r,t.parentItem,"add",this.parent,this.isSelfReference,t))),null!=i&&(this.selectedIndex>-1||h)&&f&&(e.index="before"===i?o:o+1),"Bottom"===this.parent.editSettings.newRowPosition){var I=this.parent.grid.dataSource instanceof ct.DataManager?this.parent.grid.dataSource.dataSource.json:this.parent.grid.dataSource;e.index=I.length}}(0,S.isNullOrUndefined)(t.level)&&(t.level=a),t.hasChildRecords=!1,t.childRecords=[],t.index=0}if("add"===e.action&&(this.internalProperties={level:t.level,parentItem:t.parentItem,uniqueID:t.uniqueID,taskData:t.taskData,parentUniqueID:(0,S.isNullOrUndefined)(t.parentItem)?void 0:t.parentItem.uniqueID,childRecords:t.childRecords}),"delete"===e.requestType)for(var R=e.data,C=0;C<R.length;C++)if(R[parseInt(C.toString(),10)].parentItem&&(l=xt(this.parent,R[parseInt(C.toString(),10)].parentItem.uniqueID),!(0,S.isNullOrUndefined)(l)&&l.hasChildRecords)){var b=l.childRecords.indexOf(R[parseInt(C.toString(),10)]);l.childRecords.splice(b,1)}return e},e.prototype.addRecord=function(e,t,r){if(this.parent.editSettings.newRowPosition!==this.previousNewRowPosition&&null!==this.previousNewRowPosition||(this.previousNewRowPosition=this.parent.editSettings.newRowPosition),this.isSelfReference||(0,S.isNullOrUndefined)(e)||!Object.hasOwnProperty.call(e,this.parent.childMapping))e?(t>-1?(this.selectedIndex=t,this.addRowIndex=t):(this.selectedIndex=this.parent.selectedRowIndex,this.addRowIndex=this.parent.selectedRowIndex),r&&this.parent.setProperties({editSettings:{newRowPosition:r}},!0),this.parent.grid.editModule.addRecord(e,t)):this.parent.grid.editModule.addRecord(e,t);else{var i=[],n=this.parent.editSettings.mode,o=this.parent.grid.editSettings.mode;i.push(e),this.parent.setProperties({editSettings:{mode:"Batch"}},!0),this.parent.grid.setProperties({editSettings:{mode:"Batch"}},!0),(0,S.isNullOrUndefined)(r)||this.parent.setProperties({editSettings:{newRowPosition:r}},!0);var a={addedRecords:i,changedRecords:[],deletedRecords:[]};this.parent.notify(De,{updatedRecords:a,index:t}),this.parent.setProperties({editSettings:{mode:n}},!0),this.parent.grid.setProperties({editSettings:{mode:o}},!0),this.parent.refresh()}},e.prototype.editFormValidate=function(){return this.parent.grid.editModule.editFormValidate()},e.prototype.destroyForm=function(){this.parent.grid.editModule.destroyForm()},e.prototype.contentready=function(e){(0,S.isNullOrUndefined)(e.args.requestType)||"delete"!==e.args.requestType.toString()&&"save"!==e.args.requestType.toString()&&("Batch"!==this.parent.editSettings.mode||"batchsave"!==e.args.requestType.toString())||(this.updateIndex(this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords()),(this.parent.frozenRows||this.parent.getFrozenColumns()||this.parent.frozenColumns)&&this.parent.grid.dataSource.length===this.parent.getDataRows().length&&this.updateIndex(this.parent.grid.dataSource,this.parent.getDataRows(),this.parent.getCurrentViewRecords()))},e.prototype.editCell=function(e,t){"Cell"!==this.parent.editSettings.mode&&"Batch"!==this.parent.editSettings.mode||("Batch"!==this.parent.editSettings.mode&&(this.isOnBatch=!0,this.updateGridEditMode("Batch")),this.parent.grid.editModule.editCell(e,t))},e}(),Mr=function(){function e(e){x.Grid.Inject(x.CommandColumn),this.parent=e}return e.prototype.getModuleName=function(){return"commandColumn"},e.prototype.destroy=function(){},e}(),Or=function(){function e(e){x.Grid.Inject(x.DetailRow),this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"detailRow"},e.prototype.addEventListener=function(){this.parent.on("dataBoundArg",this.dataBoundArg,this),this.parent.on("detaildataBound",this.detaildataBound,this),this.parent.grid.on("detail-indentcell-info",this.setIndentVisibility,this),this.parent.on("childRowExpand",this.childRowExpand,this),this.parent.on("rowExpandCollapse",this.rowExpandCollapse,this),this.parent.on("actioncomplete",this.actioncomplete,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("dataBoundArg",this.dataBoundArg),this.parent.off("detaildataBound",this.detaildataBound),this.parent.off("childRowExpand",this.childRowExpand),this.parent.off("rowExpandCollapse",this.rowExpandCollapse),this.parent.off("actioncomplete",this.actioncomplete),this.parent.grid.off("detail-indentcell-info",this.setIndentVisibility))},e.prototype.setIndentVisibility=function(e){e.visible=!1},e.prototype.dataBoundArg=function(){for(var e=this.parent.getRows().filter((function(e){return!e.classList.contains("e-detailrow")})),t=0;t<e.length;t++){var r=e[parseInt(t.toString(),10)].getElementsByClassName("e-detailrowcollapse"),i=this.parent.grid.getRowObjectFromUID(e[parseInt(t.toString(),10)].getAttribute("data-Uid")),n=(0,x.getObject)("parentItem",this.parent.grid.getCurrentViewRecords()[parseInt(t.toString(),10)]);((0,S.isNullOrUndefined)(n)||!(0,S.isNullOrUndefined)(n)&&St(this.parent,i.data,this.parent.grid.getCurrentViewRecords()))&&this.parent.grid.detailRowModule.expand(r[0])}},e.prototype.childRowExpand=function(e){var t=e.row.getElementsByClassName("e-detailrowcollapse");(0,S.isNullOrUndefined)(t[0])||this.parent.grid.detailRowModule.expand(t[0])},e.prototype.rowExpandCollapse=function(e){if(!ut(this.parent))for(var t=0;t<e.detailrows.length;t++)e.detailrows[parseInt(t.toString(),10)].style.display=e.action},e.prototype.detaildataBound=function(e){var t=e.data,r=e.detailElement.parentElement.previousSibling,i="e-gridrowindex"+((0,S.isNullOrUndefined)(t.parentItem)?t.index:t.parentItem.index)+"level"+t.level,n=r.querySelector("."+i).classList,o=[].slice.call(n).filter((function(e){return e===i})),a=o[0].length,s="e-griddetail"+o.toString().slice(6,a);(0,S.addClass)([e.detailElement.parentElement],s)},e.prototype.actioncomplete=function(e){if("beginEdit"===e.requestType||"add"===e.requestType){var t=e.row.querySelectorAll(".e-editcell")[0].getAttribute("colSpan"),r=(parseInt(t,10)-1).toString();e.row.querySelectorAll(".e-editcell")[0].setAttribute("colSpan",r)}for(var i=this.parent.grid.contentModule.getRows(),n=0;n<i.length;n++)i[parseInt(n.toString(),10)].cells[0].visible=!1;(0,x.getObject)("focusModule",this.parent.grid).refreshMatrix(!0)({rows:this.parent.grid.contentModule.getRows()})},e.prototype.destroy=function(){this.removeEventListener()},e}(),Pr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Er=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.isExpandCollapse=!1,i.translateY=0,i.maxiPage=0,i.recordAdded=!1,i.startIndex=-1,i.endIndex=-1,i.preTranslate=0,i.isRemoteExpand=!1,i.isDataSourceChanged=!1,i.addEventListener(),i}return Pr(t,e),t.prototype.getModelGenerator=function(){return new fr(this.parent)},t.prototype.getRowByIndex=function(e){return this.parent.enableVirtualization&&this.parent.isFrozenGrid()?this.getRowCollection(e,!0):this.parent.getDataRows().filter((function(t){return parseInt(t.getAttribute("data-rowindex"),10)===e}))[0]},t.prototype.getFrozenRightVirtualRowByIndex=function(e){return this.getRowCollection(e,!1,!1,!0)},t.prototype.getRowCollection=function(e,t,r,i){var n=parseInt(this.parent.getRows()[0].getAttribute(st),10),o=this.parent.getDataRows(),a=(r?this.parent.getCurrentViewRecords():o)[e-n];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(a=r?e<=this.parent.frozenRows?this.parent.getRowsObject()[parseInt(e.toString(),10)].data:a:e<=this.parent.frozenRows?o[parseInt(e.toString(),10)]:o[e-n+this.parent.frozenRows]),a},t.prototype.addEventListener=function(){this.parent.on(Ae,this.virtualOtherAction,this),this.parent.on(Ue,this.indexModifier,this)},t.prototype.virtualOtherAction=function(e){e.setTop?(this.translateY=0,this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1):e.isExpandCollapse&&(this.isExpandCollapse=!0)},t.prototype.indexModifier=function(e){var t=this.parent.getContent().querySelector(".e-content");if((this.recordAdded||"delete"===e.requestType&&this.endIndex>e.count-this.parent.pageSettings.pageSize)&&this.startIndex>-1&&this.endIndex>-1){if(this.endIndex>e.count-this.parent.pageSettings.pageSize){var r=~~(t.scrollTop/this.parent.getRowHeight()),i=r+this.parent.getRows().length;i>e.count&&(i=r+(e.count-r)),this.startIndex=i-this.parent.getRows().length,this.endIndex=i}else("Top"!==this.parent.root.editSettings.newRowPosition&&-1!==this.parent.root.editModule.selectedIndex||-1!==this.parent.root.editModule.selectedIndex)&&(this.startIndex+=1,this.endIndex+=1);this.recordAdded=!1}this.isDataSourceChanged&&(this.startIndex=0,this.endIndex=this.parent.pageSettings.pageSize-1),this.endIndex-this.startIndex!==this.parent.pageSettings.pageSize&&this.totalRecords>this.parent.pageSettings.pageSize&&this.endIndex===this.totalRecords?(e.startIndex=this.endIndex-this.parent.pageSettings.pageSize,e.endIndex=this.endIndex):(e.startIndex=this.startIndex,e.endIndex=this.endIndex)},t.prototype.eventListener=function(t){var r=this;this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&gt(this.parent)?e.prototype.eventListener.call(this,"on"):(this.parent[""+t]("data-ready",this.onDataReady,this),this.parent[""+t]("refresh-virtual-block",this.refreshContentRows,this),this.fn=function(){r.observers.observes((function(e){return r.scrollListeners(e)}),r.onEnteredAction(),r.parent),r.parent.off("content-ready",r.fn)},this.parent.addEventListener("dataBound",this.dataBoundEvent.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelectedEvent.bind(this)),this.parent[""+t]("select-virtual-Row",this.toSelectVirtualRow,this),this.parent.on("content-ready",this.fn,this),this.parent.addEventListener(G,this.onActionComplete.bind(this)),this.parent[""+t]("virtual-scroll-edit-action-begin",this.beginEdit,this),this.parent[""+t]("virtual-scroll-add-action-begin",this.beginAdd,this),this.parent[""+t]("virtual-scroll-edit-success",this.virtualEditSuccess,this),this.parent[""+t]("edit-reset",this.resetIseditValue,this),this.parent[""+t]("get-virtual-data",this.getData,this),this.parent[""+t]("virtual-scroll-edit-cancel",this.cancelEdit,this),this.parent[""+t]("select-row-on-context-open",this.toSelectRowOnContextOpen,this),this.parent[""+t]("refresh-virtual-editform-cells",this.refreshCell,this),this.parent[""+t]("virtaul-cell-focus",this.cellFocus,this))},t.prototype.cellFocus=function(t){e.prototype.virtualCellFocus.call(this,t)},t.prototype.onDataReady=function(t){if(e.prototype.onDataReady.call(this,t),!(this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&gt(this.parent))){if(!(0,S.isNullOrUndefined)(t.count)){if(this.totalRecords=t.count,this.parent.isFrozenGrid()&&t.count<Object.keys(this.parent.dataSource).length){var r=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length-1)+"px":"100%",i=this.parent.getRowHeight()*t.count-this.parent.getRowHeight()*this.parent.pageSettings.pageSize;(0,S.getValue)("virtualEle",this).setVirtualHeight(i,r)}this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()||(0,S.getValue)("virtualEle",this).setVirtualHeight(this.parent.getRowHeight()*t.count,"100%")}(!(0,S.isNullOrUndefined)(t.requestType)&&"collapseAll"===t.requestType.toString()||this.isDataSourceChanged&&(-1===this.startIndex||0===this.startIndex&&0===this.preStartIndex))&&(this.contents.scrollTop=0,this.isDataSourceChanged=!1)}},t.prototype.renderTable=function(){e.prototype.renderTable.call(this),this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&gt(this.parent)||((0,S.getValue)("observer",this).options.debounceEvent=!1,this.observers=new Ar((0,S.getValue)("observer",this).element,(0,S.getValue)("observer",this).options),this.contents=this.getPanel().firstChild)},t.prototype.getTranslateY=function(t,r,i,n){return this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||gt(this.parent)?this.isRemoteExpand?(this.isRemoteExpand=!1,this.preTranslate):(this.preTranslate=e.prototype.getTranslateY.call(this,t,r,i,n),e.prototype.getTranslateY.call(this,t,r,i,n)):e.prototype.getTranslateY.call(this,t,r,i,n)},t.prototype.dataBoundEvent=function(){var t="initialRowTop";if(!(0,S.isNullOrUndefined)(this.parent.getRowByIndex(0))&&this.parent.getRows().length&&!this[""+t]){var r=this.parent.getRowByIndex(0).getBoundingClientRect().top,i=this.parent.element.getBoundingClientRect().top;this[""+t]=r>0?this.parent.getRowByIndex(0).getBoundingClientRect().top-i:this.content.getBoundingClientRect().top-this.parent.getRowByIndex(0).getBoundingClientRect().height}e.prototype.dataBound.call(this)},t.prototype.rowSelectedEvent=function(t){e.prototype.rowSelected.call(this,t)},t.prototype.toSelectVirtualRow=function(t){if(!this.parent.isEdit){var r="containerRect";(0,S.isNullOrUndefined)(this.observer[""+r])&&(this.observer[""+r]=this.observers[""+r]),((0,S.isNullOrUndefined)(this.parent.clipboardModule.treeGridParent.editModule)||0!==t.selectedIndex||(0,S.isNullOrUndefined)(this.parent.clipboardModule.treeGridParent.editModule.addRowIndex))&&e.prototype.selectVirtualRow.call(this,t)}},t.prototype.refreshCell=function(e){e.cells=this.generateCells()},t.prototype.generateCells=function(){for(var e=[],t=0;t<this.parent.columns.length;t++)e.push(this.generateCell(this.parent.columns[parseInt(t.toString(),10)]));return e},t.prototype.generateCell=function(e,t,r,i,n,o){var a={visible:e.visible,isDataCell:!(0,S.isNullOrUndefined)(e.field||e.template),isTemplate:!(0,S.isNullOrUndefined)(e.template),rowID:t,column:e,cellType:(0,S.isNullOrUndefined)(r)?x.CellType.Data:r,colSpan:i,commands:e.commands,isForeignKey:e.isForeignColumn&&e.isForeignColumn(),foreignKeyData:e.isForeignColumn&&e.isForeignColumn()&&(0,S.getValue)(e.field,o)};return(a.isDataCell||"checkbox"===a.column.type||a.commands)&&(a.index=n),new x.Cell(a)},t.prototype.beginEdit=function(e){this.editedRowIndex=e.index;var t='.e-row[data-rowindex="'+e.index+'"]',r=this.parent.getContent().querySelector(t).rowIndex,i=this.parent.getCurrentViewRecords()[parseInt(r.toString(),10)];e.data=i},t.prototype.beginAdd=function(t){var r={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,dataRowIndex:this.dataRowIndex};this.parent.notify("get-row-position",r),this.rowPosition=r.newRowPosition,this.addRowIndex=r.addRowIndex,this.dataRowIndex=r.dataRowIndex;var i=this.parent.getRows(),n=i.length?+i[0].getAttribute("data-rowindex"):0,o=i.length?+i[i.length-1].getAttribute("data-rowindex"):0,a=this.parent.selectedRowIndex>=n&&this.parent.selectedRowIndex<=o;"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.isAdd=!0),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.addRowIndex&&-1!==this.addRowIndex||-1!==this.parent.selectedRowIndex&&a)||e.prototype.addActionBegin.call(this,t)},t.prototype.restoreEditState=function(){e.prototype.restoreEdit.call(this)},t.prototype.resetIseditValue=function(){this.parent.notify("reset-edit-props",{}),"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition||!this.isAdd||e.prototype.resetIsedit.call(this)},t.prototype.virtualEditSuccess=function(){var e=this.parent.getContent().querySelector(".e-content");this.isAdd&&e.querySelector(".e-addedrow")&&(this.recordAdded=!0)},t.prototype.cancelEdit=function(t){e.prototype.editCancel.call(this,t)},t.prototype.toSelectRowOnContextOpen=function(t){e.prototype.selectRowOnContextOpen.call(this,t)},t.prototype.restoreNewRow=function(){var e=this.parent.getContent().querySelector(".e-content");this.isAdd&&!e.querySelector(".e-addedrow")&&(this.parent.isEdit=!1,this.parent.editModule.addRecord(null,this.parent.root.editModule.selectedIndex))},t.prototype.getData=function(t){e.prototype.getVirtualData.call(this,t)},t.prototype.onActionComplete=function(t){if("add"===t.requestType){var r={newRowPosition:this.rowPosition,addRowIndex:this.addRowIndex,dataRowIndex:this.dataRowIndex};this.parent.notify("get-row-position",r),this.rowPosition=r.newRowPosition,this.addRowIndex=r.addRowIndex,this.dataRowIndex=this.parent.root.editModule.selectedIndex}e.prototype.actionComplete.call(this,t)},t.prototype.onEnteredAction=function(){var e=this;return function(t,r,i,n,o,a){if(!e.parent.directVirtualRender){var s="preventEvent";!S.Browser.isIE||o||!a||e[""+s]||e.parent.enableVirtualMaskRow||e.parent.showSpinner(),e.parent.enableVirtualMaskRow&&!e[""+s]&&setTimeout((function(){e.parent.showMaskRow(r.axis),e.parent.notify("showGanttShimmer",{requestType:"showShimmer"})}),0);var d=e.content.getBoundingClientRect().height,l=e.prevInfo.offsets?e.prevInfo.offsets.top:null,p="X"===r.axis,h=e.getColumnOffset(p?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(p){var c=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,u=e.vgenerator.cOffsets[c-1];h=h>u?u:h}var g=e.getTranslateY(n.top,d,p&&l===n.top?e.prevInfo:void 0,!0);if(!e.parent.isFrozenGrid()||e.parent.enableVirtualMaskRow){if(e.parent.enableVirtualMaskRow){var f=n.top-e.translateY<0;g=Math.round(e.translateY)>g&&!f?Math.round(e.translateY):g,e.virtualEle.adjustTable(h,g)}else e.virtualEle.adjustTable(h,e.translateY);e.parent.enableColumnVirtualization&&e.header.virtualEle.adjustTable(h,0)}}}},t.prototype.scrollListeners=function(e){this.scrollAfterEdit();var t=e.sentinel,r=this.parent.getRowHeight(),i=this.parent.pageSettings.pageSize-Math.ceil(this.parent.pageSettings.pageSize/2),n=this.parent.getContent().querySelector(".e-content"),o=i*r,a=e.offset.top-this.translateY<0,s=Math.ceil(e.offset.top-this.translateY)+r>=o,d="selectedRowIndex",l=this.parent.currentViewData,p="index";if(a&&"right"!==e.direction&&"left"!==e.direction){var h=+(this.parent.height.toString().indexOf("%")<0?parseInt(this.parent.height.toString(),10):this.parent.element.getBoundingClientRect().height),c=~~(n.scrollTop/r)+Math.ceil(h/r)-this.parent.pageSettings.pageSize;if(c=c>0?c:0,(0,S.isNullOrUndefined)(this[""+d])||-1===this[""+d]||c===this[""+d]||(c=this[""+d]),this.startIndex=c,this.endIndex=c+this.parent.pageSettings.pageSize,this.endIndex>this.totalRecords){var u=this.totalRecords-1,g=this.endIndex%u;this.endIndex=u,this.startIndex=this.startIndex-g<0?0:this.startIndex-g}l.length&&l[0][""+p]>=this.parent.pageSettings.pageSize/2&&l[0][""+p]-this.startIndex<this.parent.pageSettings.pageSize/2&&this.parent.selectionModule.isRowSelected&&(this.startIndex=l[0][""+p]-this.parent.pageSettings.pageSize/2,this.endIndex=this.startIndex+this.parent.pageSettings.pageSize);var f=Math.ceil(e.offset.top/r);f%=this.parent.pageSettings.pageSize;var y=0;(0,S.isNullOrUndefined)(this.parent.getRows()[parseInt(f.toString(),10)])||(0,S.isNullOrUndefined)(this.parent.getContent().querySelectorAll(".e-content tr")[parseInt(f.toString(),10)])||(y=+this.parent.getContent().querySelectorAll(".e-content tr")[parseInt(f.toString(),10)].querySelector("td").getAttribute("index")),0===y?(e.offset.top=n.scrollTop,this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*r:this.translateY=e.offset.top):this.translateY=e.offset.top-i*r>0?e.offset.top-i*r+10:0}else if(s&&"right"!==e.direction&&"left"!==e.direction){var m=~~(n.scrollTop/r),v=!(this[""+d]+this.parent.pageSettings.pageSize<this.totalRecords);(0,S.isNullOrUndefined)(this[""+d])||-1===this[""+d]||m===this[""+d]||v||(m=this[""+d]);var w=m+this.parent.pageSettings.pageSize;w>this.totalRecords&&(w=m+(this.totalRecords-m)),this.startIndex=!v||(0,S.isNullOrUndefined)(this[""+d])?w-this.parent.pageSettings.pageSize:m,this.endIndex=w,m+this.parent.pageSettings.pageSize>this.totalRecords&&this.endIndex-this.startIndex<this.parent.pageSettings.pageSize/2&&this.endIndex-m<this.parent.pageSettings.pageSize/2&&(this.startIndex=w-this.parent.pageSettings.pageSize/2),l.length&&this.startIndex>l[0][""+p]&&this.startIndex-l[0][""+p]<this.parent.pageSettings.pageSize/2&&this.parent.selectionModule.isRowSelected&&(this.startIndex=l[0][""+p]+this.parent.pageSettings.pageSize/2),e.offset.top>r*this.totalRecords?this.translateY=this.getTranslateY(e.offset.top,n.getBoundingClientRect().height):this.totalRecords===this.endIndex?this.translateY=this.totalRecords*r-(this.endIndex-this.startIndex)*r:this.parent.allowRowDragAndDrop?this.translateY=e.offset.top-2*r:this.translateY=e.offset.top}if(s&&e.offset.top<r*this.totalRecords||a||"right"===e.direction||"left"===e.direction||this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url&&(s||a)||gt(this.parent)){var I=this.currentInfo=(0,S.getValue)("getInfoFromView",this).apply(this,[e.direction,t,e.offset]);this.previousInfo=I,this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?I.columnIndexes:[]);var R=I.loadNext&&!I.loadSelf?I.nextInfo.page:I.page;this.parent.setProperties({pageSettings:{currentPage:R}},!0),this.requestType="virtualscroll","right"!==e.direction&&"left"!==e.direction&&(I.event="refresh-virtual-block"===I.event?"model-changed":I.event),this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(t.axis),this.parent.addShimmerEffect(),this.parent.notify("showGanttShimmer",{requestType:"showShimmer"})),this.parent.notify(I.event,{requestType:"virtualscroll",virtualInfo:I,focusElement:e.focusElement})}else this.parent.enableVirtualMaskRow&&(this.parent.removeMaskRow(),this.parent.notify("removeGanttShimmer",{requestType:"hideShimmer"}))},t.prototype.appendContent=function(t,r,i){if(this.parent.dataSource instanceof ct.DataManager&&void 0!==this.parent.dataSource.dataSource.url&&!this.parent.dataSource.dataSource.offline&&""!==this.parent.dataSource.dataSource.url||gt(this.parent)||this.parent.isFrozenGrid())(0,S.getValue)("isExpandCollapse",i)&&(this.isRemoteExpand=!0),e.prototype.appendContent.call(this,t,r,i),-1!==(0,S.getValue)("requestTypes",this).indexOf("isFrozen")&&((0,S.getValue)("requestTypes",this).splice((0,S.getValue)("requestTypes",this).indexOf("isFrozen"),1),this.requestType="isFrozen"===this.requestType?void 0:this.requestType);else{var n=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&(0,S.getValue)("currentInfo",this).page&&(0,S.getValue)("currentInfo",this).page!==i.virtualInfo.page?(0,S.getValue)("currentInfo",this):i.virtualInfo,o=n.columnIndexes[0]-1,a=this.getColumnOffset(o),s=void 0;if(this.parent.enableColumnVirtualization){this.header.virtualEle.adjustTable(a,0);var d=n.columnIndexes;s=this.getColumnOffset(d[d.length-1])-this.getColumnOffset(d[0]-1)+"",this.header.virtualEle.setWrapperWidth(s)}this.virtualEle.setWrapperWidth(s,S.Browser.isIE||"edge"===S.Browser.info.name),(t=this.parent.createElement("tbody")).appendChild(r),this.getTable().querySelector("tbody").replaceWith(t),this.isExpandCollapse&&0!==this.translateY?this.isExpandCollapse=!1:(this.translateY=this.translateY<0?0:this.translateY,(0,S.getValue)("virtualEle",this).adjustTable(a,this.translateY)),(0,S.setValue)("prevInfo",this.previousInfo?this.previousInfo:n,this),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(Ke,{}),e.prototype.focusCell.call(this,i);var l="isAdd";this[""+l]&&!this.parent.getContent().querySelector(".e-content").querySelector(".e-addedrow")&&"Top"!==this.rowPosition&&"Bottom"!==this.rowPosition&&(this.dataRowIndex>=this.startIndex?this.restoreNewRow():this.addRowIndex&&this.addRowIndex>-1&&(this[""+l]=!1,this.parent.isEdit=!1)),this.restoreEditState(),e.prototype.restoreAdd.call(this),e.prototype.ensureSelectedRowPosition.call(this)}},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("data-ready",this.onDataReady),this.parent.off("content-ready",this.fn),this.parent.off("select-virtual-Row",this.toSelectVirtualRow),this.parent.off("dataBound",this.dataBoundEvent),this.parent.off("rowSelected",this.rowSelectedEvent),this.parent.off(Ae,this.virtualOtherAction),this.parent.off(Ue,this.indexModifier),this.parent.off("virtual-scroll-edit-action-begin",this.beginEdit),this.parent.off("virtual-scroll-add-action-begin",this.beginAdd),this.parent.off("virtual-scroll-edit-success",this.virtualEditSuccess),this.parent.off("edit-reset",this.resetIseditValue),this.parent.off("get-virtual-data",this.getData),this.parent.off("virtual-scroll-edit-cancel",this.cancelEdit),this.parent.off("select-row-on-context-open",this.toSelectRowOnContextOpen),this.parent.off("refresh-virtual-editform-cells",this.refreshCell),this.parent.off("virtaul-cell-focus",this.cellFocus))},t}(x.VirtualContentRenderer),Ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isWheeling=!1,t.newPos=0,t.lastPos=0,t.timer=0,t}return Pr(t,e),t.prototype.observes=function(t,r,i){e.prototype.containerRect=(0,S.getValue)("options",this).container.getBoundingClientRect(),S.EventHandler.add((0,S.getValue)("options",this).container,"scroll",this.virtualScrollHandlers(t,r,i),this),(0,S.getValue)("options",this).movableContainer&&(e.prototype.movableContainerRect=(0,S.getValue)("options",this).movableContainer.getBoundingClientRect(),S.EventHandler.add((0,S.getValue)("options",this).movableContainer,"scroll",this.virtualScrollHandlers(t,r,i),this))},t.prototype.clear=function(){this.lastPos=null},t.prototype.virtualScrollHandlers=function(e,t,r){var i=this,n="chrome"===S.Browser.info.name?200:100,o="options",a="movableEle",s="fromWheel",d=(0,S.debounce)(e,n),l=(0,S.debounce)(e,50);return this[""+o].prevTop=this[""+o].prevLeft=0,function(n){var p=i[""+o].movableContainer?i[""+o].container.scrollTop:n.target.scrollTop,h=i[""+o].movableContainer?i[""+o].scrollbar.scrollLeft:n.target.scrollLeft,c=i[""+o].prevTop<p?"down":"up";c=i[""+o].prevLeft===h?c:i[""+o].prevLeft<h?"right":"left",i[""+o].prevTop=p,i[""+o].prevLeft=h;var u=i.sentinelInfo[""+c],g=0;if(i.newPos=p,null!=i.lastPos&&(g=i.newPos-i.lastPos),i.lastPos=i.newPos,i.timer&&clearTimeout(i.timer),i.timer=setTimeout(i.clear,0),(g>100||g<-100)&&n&&n.preventDefault&&(n.returnValue=!1,n.preventDefault()),-1!==i[""+o].axes.indexOf(u.axis)){i.containerRect=i[""+o].container.getBoundingClientRect();var f=i.check(c);if(u.entered&&("X"===u.axis||r.enableVirtualMaskRow)&&(!i[""+a]||"right"!==c&&"left"!==c?t(i.element,u,c,{top:p,left:h},i[""+s],f):t(i[""+a],u,c,{top:p,left:h},i[""+s],f)),f){var y=l;"X"===u.axis?y({direction:c,sentinel:u,offset:{top:p,left:h},focusElement:document.activeElement}):r.dataSource instanceof ct.DataManager&&void 0!==r.dataSource.dataSource.url&&!r.dataSource.dataSource.offline&&""!==r.dataSource.dataSource.url||gt(r)||r.enableVirtualMaskRow?(y=r.enableVirtualMaskRow?d:y)({direction:c,sentinel:u,offset:{top:p,left:h},focusElement:document.activeElement}):e({direction:c,sentinel:u,offset:{top:p,left:h},focusElement:document.activeElement})}i[""+s]=!1}}},t}(x.InterSectionObserver),Nr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),kr=function(){function e(e){this.prevstartIndex=-1,this.prevendIndex=-1,this.parent=e,x.Grid.Inject(Ur),this.addEventListener()}return e.prototype.returnVisualData=function(e){e.data=this.visualData},e.prototype.getModuleName=function(){return"virtualScroll"},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(oe,this.collapseExpandVirtualchilds,this),this.parent.on(ae,this.virtualPageAction,this),this.parent.on(Ne,this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(oe,this.collapseExpandVirtualchilds),this.parent.off(ae,this.virtualPageAction),this.parent.off(Ne,this.destroy))},e.prototype.collapseExpandVirtualchilds=function(e){this.parent.grid.notify(Ae,{isExpandCollapse:!0}),this.expandCollapseRec=e.record,e.record.expanded="collapse"!==e.action;var t={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length};(this.parent.enableVirtualization&&"Cell"===this.parent.selectionSettings.mode||"Row"===this.parent.selectionSettings.mode&&!this.parent.selectionSettings.persistSelection)&&this.parent.grid.clearSelection();var r=(0,S.getValue)("isCollapseAll",this.parent)?"collapseAll":"refresh";(0,S.getValue)("grid.renderModule",this.parent).dataManagerSuccess(t,{requestType:r})},e.prototype.virtualPageAction=function(e){var t=this,r=new ct.DataManager(e.result),i=new ct.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),n=r.executeLocal((new ct.Query).where(i)),o=n.filter((function(e){return St(t.parent,e,n)}));this.visualData=o,e.count=o.length,this.parent.grid.notify(ke,{data:o});var a={startIndex:-1,endIndex:-1,count:e.count,requestType:e.actionArgs.requestType};this.parent.grid.notify(Ue,a);var s=a.startIndex,d=a.endIndex;if(e.count=o.length,-1===s&&-1===d){var l=new ct.Query,p=this.parent.grid.pageSettings.pageSize,h=p*(this.parent.grid.pageSettings.currentPage-1);l=l.skip(h).take(p),r.dataSource.json=o,e.result=r.executeLocal(l)}else{var c=e.actionArgs.requestType;("filtering"===c||"collapseAll"===c||"searching"===c||"refresh"===c&&this.parent.enableCollapseAll&&d>o.length&&(0,S.isNullOrUndefined)(this.expandCollapseRec))&&(s=0,d=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.getContent().firstElementChild.scrollTop=0,this.parent.grid.notify(Ae,{setTop:!0})),("save"===c&&e.actionArgs.index>=a.count-this.parent.grid.pageSettings.pageSize||"refresh"===c&&this.parent.isGantt&&this.parent.isAddedFromGantt&&this.parent.grid.pageSettings.currentPage===this.parent.grid.contentModule.maxPage)&&(s=a.startIndex+(a.count-a.endIndex),d=a.count,this.parent.isAddedFromGantt=!1);var u=this.parent.grid.contentModule.virtualEle.wrapper,g=(0,x.getTransformValues)(u).height;if(!(0,S.isNullOrUndefined)(this.expandCollapseRec)&&("virtualscroll"===e.actionArgs.requestType||"refresh"===e.actionArgs.requestType&&s!==this.prevstartIndex)&&s<this.parent.getRows().length&&d<=s+this.parent.getRows().length&&0===g&&(s=0),!(0,S.isNullOrUndefined)(this.expandCollapseRec)){var f=this.parent.getRows(),y=o.indexOf(this.expandCollapseRec);o.slice(y,y+f.length).length<f.length&&y>=0&&0!==s?(s=y=(y=o.length-f.length)>0?y:0,d=o.length):(0,S.getValue)("isCollapseAll",this.parent)&&(s=0,d=this.parent.grid.pageSettings.pageSize-1,this.parent.grid.notify(Ae,{setTop:!0}))}!this.parent.enableCollapseAll&&!this.parent.expandStateMapping||(0,S.isNullOrUndefined)(this.expandCollapseRec)||(e.count<this.parent.getRows()[0].getBoundingClientRect().height?s=0:this.parent.isExpandAll||(s=-1===this.prevstartIndex?0:this.prevstartIndex)),this.expandCollapseRec=null,s=s<0?0:s,0===d&&o.length>0?e.result=o:e.result=o.slice(s,d),this.prevstartIndex=s,this.prevendIndex=d}this.parent.notify("updateAction",e)},e.prototype.destroy=function(){this.removeEventListener()},e}(),Ur=function(e){function t(t,r){var i=e.call(this,t,r)||this;return(0,S.getValue)("parent",i).off("initial-load",(0,S.getValue)("instantiateRenderer",i),i),(0,S.getValue)("parent",i).on("initial-load",i.instantiateRenderers,i),i}return Nr(t,e),t.prototype.getModuleName=function(){return"treeVirtualScroll"},t.prototype.instantiateRenderers=function(){var e=(0,S.getValue)("parent",this);(0,S.getValue)("parent",this).log(["limitation","virtual_height"],"virtualization");var t=(0,S.getValue)("locator",this).getService("rendererFactory");e.enableColumnVirtualization&&(0,S.getValue)("addRenderer",t).apply(t,[x.RenderType.Header,new x.VirtualHeaderRenderer((0,S.getValue)("parent",this),(0,S.getValue)("locator",this))]),(0,S.getValue)("addRenderer",t).apply(t,[x.RenderType.Content,new Er((0,S.getValue)("parent",this),(0,S.getValue)("locator",this))]),this.ensurePageSize()},t.prototype.ensurePageSize=function(){var e=(0,S.getValue)("parent",this),t=e.getRowHeight();(0,S.isNullOrUndefined)(e.height)||"string"!=typeof e.height||-1===e.height.indexOf("%")||(e.element.style.height=e.height);var r=2*~~((e.height.toString().indexOf("%")<0?parseInt(e.height.toString(),10):e.element.getBoundingClientRect().height)/t),i=e.pageSettings.pageSize;e.setProperties({pageSettings:{pageSize:i<r?r:i}},!0)},t}(x.VirtualScroll),qr=function(){function e(e){x.Grid.Inject(x.Freeze),this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("rowExpandCollapse",this.rowExpandCollapse,this),this.parent.on("dataBoundArg",this.dataBoundArg,this),this.parent.grid.on("dblclick",this.dblClickHandler,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("rowExpandCollapse",this.rowExpandCollapse),this.parent.off("dataBoundArg",this.dataBoundArg),this.parent.grid.off("dblclick",this.dblClickHandler))},e.prototype.rowExpandCollapse=function(e){var t,r,i=this.parent.getDataRows(),n=this.parent.getRows(),o=this.parent.getFrozenLeftColumnsCount()>0||this.parent.getFrozenRightColumnsCount()>0;o&&(r=this.parent.getRows().filter((function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))}))),t=e.detailrows.length?e.detailrows:i.filter((function(t){return t.querySelector(".e-gridrowindex"+e.record.index+"level"+(e.record.level+1))}));for(var a=0;a<t.length;a++){var s=t[parseInt(a.toString(),10)],d=this.parent.grid.getRowObjectFromUID(s.getAttribute("data-Uid")).data;!(0,S.isNullOrUndefined)(i)&&s.parentElement.firstElementChild.clientHeight>0&&(s.style.height=s.parentElement.firstElementChild.clientHeight+"px"),s.style.display=e.action,o&&r.length&&(r[parseInt(a.toString(),10)].style.display=e.action);var l="none"===e.action?".e-treecolumn-container .e-treegridcollapse":".e-treecolumn-container .e-treegridexpand";if(n[s.rowIndex].querySelector(l)){for(var p=[],h=0;h<i.length;h++)i[parseInt(h.toString(),10)].querySelector(".e-gridrowindex"+d.index+"level"+(d.level+1))&&p.push(i[parseInt(h.toString(),10)]);if(p.length){var c=this.parent.getCurrentViewRecords()[p[0].rowIndex];this.rowExpandCollapse({detailrows:p,action:e.action,record:c})}}}},e.prototype.dblClickHandler=function(e){(0,x.parentsUntil)(e.target,"e-rowcell")&&this.parent.grid.editSettings.allowEditOnDblClick&&"Cell"!==this.parent.editSettings.mode&&!e.target.classList.contains("e-treegridcollapse")&&!e.target.classList.contains("e-treegridexpand")&&this.parent.startEdit((0,x.parentsUntil)(e.target,"e-row"))},e.prototype.dataBoundArg=function(){this.parent.getColumns().filter((function(e){return e.showCheckbox})).length&&this.parent.freezeModule&&this.parent.initialRender&&(0,S.addClass)([this.parent.element.getElementsByClassName("e-grid")[0]],"e-checkselection")},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.getModuleName=function(){return"freeze"},e}(),Vr=function(){function e(e){x.Grid.Inject(x.ColumnChooser),this.parent=e}return e.prototype.openColumnChooser=function(e,t){return this.parent.grid.columnChooserModule.openColumnChooser(e,t)},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"ColumnChooser"},e}(),Br=function(){function e(e){this.parent=e,x.Grid.Inject(x.InfiniteScroll),this.addEventListener()}return e.prototype.getModuleName=function(){return"infiniteScroll"},e.prototype.addEventListener=function(){this.parent.on(ae,this.infinitePageAction,this),this.parent.on("infinite-remote-expand",this.infiniteRemoteExpand,this),this.parent.grid.on("delete-complete",this.infiniteDeleteHandler,this),this.parent.grid.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.grid.on("infinite-crud-cancel",this.createRows,this),this.parent.grid.on("content-ready",this.contentready,this),this.parent.on(oe,this.collapseExpandInfinitechilds,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("infinite-remote-expand",this.infiniteRemoteExpand),this.parent.grid.off("delete-complete",this.infiniteDeleteHandler),this.parent.grid.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off(ae,this.infinitePageAction),this.parent.grid.off("infinite-crud-cancel",this.createRows),this.parent.grid.off("content-ready",this.contentready),this.parent.off(oe,this.collapseExpandInfinitechilds))},e.prototype.infiniteRemoteExpand=function(e){for(var t=this.parent.grid.getRowsObject(),r=this.parent.grid.infiniteScrollModule.serviceLocator,i=new x.RowRenderer(r,null,this.parent.grid),n=this.parent.getRows(),o=e.index===n.length-1?"after":"before",a=this.parent.grid.getColumns(),s=this.parent.grid.infiniteScrollModule.generateRows(e.childData,e),d=[],l=0;l<s.length;l++)d.push(i.render(s[parseInt(l.toString(),10)],a));for(t.splice.apply(t,[e.index+1,0].concat(s)),l=0;l<d.length;l++)"after"===o?n[e.index+l][""+o](d[parseInt(l.toString(),10)]):n[e.index+l+1][""+o](d[parseInt(l.toString(),10)]),n.splice(e.index+1+l,0,d[parseInt(l.toString(),10)]);(0,x.resetRowIndex)(this.parent.grid,this.parent.grid.getRowsObject(),this.parent.grid.getRows(),0)},e.prototype.contentready=function(){if(this.parent.infiniteScrollSettings.enableCache&&!(0,S.isNullOrUndefined)(this.parent.editModule)){var e="updateIndex";this.parent.editModule[""+e](this.parent.grid.dataSource,this.parent.getRows(),this.parent.getCurrentViewRecords()),this.parent.getFrozenColumns()&&this.parent.editModule[""+e](this.parent.grid.dataSource,this.parent.getDataRows(),this.parent.getCurrentViewRecords())}},e.prototype.collapseExpandInfinitechilds=function(e){e.record.expanded="collapse"!==e.action;var t={result:this.parent.flatData,row:e.row,action:e.action,record:e.record,count:this.parent.flatData.length},r=(0,S.getValue)("isCollapseAll",this.parent)?"collapseAll":"refresh";(0,S.getValue)("grid.renderModule",this.parent).dataManagerSuccess(t,{requestType:r})},e.prototype.infinitePageAction=function(e){var t=this,r=new ct.DataManager(e.result),i=new ct.Predicate("expanded","notequal",null).or("expanded","notequal",void 0),n=r.executeLocal((new ct.Query).where(i)),o=n.filter((function(e){return St(t.parent,e,n)})),a=(0,S.getValue)("actionArgs",e.actionArgs),s=(0,S.getValue)("actions",this.parent.grid.infiniteScrollModule);this.parent.grid.infiniteScrollModule.isInitialRender&&!this.parent.initialRender&&(this.parent.grid.pageSettings.currentPage=1);var d=!!s.some((function(e){return e===a.requestType}))||!!this.parent.initialRender;if(this.visualData=o,e.count=o.length,(0,S.getValue)("isPrinting",e.actionArgs))e.result=o;else{var l=new ct.Query,p=this.parent.infiniteScrollSettings.enableCache;p&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var h=d?this.parent.grid.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks:this.parent.grid.pageSettings.pageSize,c=this.parent.grid.pageSettings.currentPage;if((0,S.isNullOrUndefined)(a))l=l.page(c,h);else{var u=(0,S.getValue)("lastIndex",this.parent.grid.infiniteScrollModule),g=(0,S.getValue)("firstIndex",this.parent.grid.infiniteScrollModule);if(p||"delete"!==a.requestType)p&&"delete"===a.requestType||"save"===a.requestType&&"add"===a.action?l=(l=l.skip(g)).take(this.parent.infiniteScrollSettings.initialBlocks*this.parent.pageSettings.pageSize):("expand"!==e.actionArgs.action&&"collapse"!==e.actionArgs.action||1===this.parent.grid.pageSettings.currentPage||(c=1,h=this.parent.grid.pageSettings.pageSize*this.parent.grid.pageSettings.currentPage),l=l.page(c,h));else{var f=u-a.data.length+1,y=a.data.length;l=l.skip(f).take(y)}}r.dataSource.json=o,p||(0,S.isNullOrUndefined)(a)||"save"!==a.requestType||"add"!==a.action?e.result=r.executeLocal(l):e.result=[a.data]}this.parent.notify("updateAction",e)},e.prototype.infiniteEditHandler=function(e){var t=this.parent.grid.infiniteScrollModule.infiniteCurrentViewData,r=Object.keys(t);if("delete"===e.e.requestType&&e.result.length>1)for(var i=1;i<e.result.length;i++)t[r[r.length-1]].push(e.result[parseInt(i.toString(),10)])},e.prototype.infiniteDeleteHandler=function(e){if("delete"===e.requestType){var t=this.parent.grid.getRowsObject(),r=this.parent.getRows(),i=e.data instanceof Array?e.data:[e.data],n=this.parent.grid.getPrimaryKeyFieldNames()[0];if(this.removeRows(r,t,i,n,!0),this.parent.getFrozenColumns()>0){var o=this.parent.grid.getRowsObject(),a=this.parent.grid.getRows();this.removeRows(a,o,i,n)}}},e.prototype.removeRows=function(e,t,r,i,n){for(var o=this,a=function(a){t.filter((function(s,d){if(s.data[""+i]===r[parseInt(a.toString(),10)][""+i]){if(n){var l=Math.ceil((d+1)/o.parent.grid.pageSettings.pageSize);o.parent.grid.infiniteScrollModule.resetInfiniteCurrentViewData(l,d)}t.splice(d,1),(0,S.remove)(e[parseInt(d.toString(),10)]),e.splice(d,1)}}))},s=0;s<r.length;s++)a(s)},e.prototype.createRows=function(e){var t,r,i=e.args.e,n=e.row,o=this.parent.grid.infiniteScrollModule.serviceLocator,a=new x.RowRenderer(o,null,this.parent.grid),s=this.parent.getCurrentViewRecords(),d=e.isMovable?this.parent.grid.getRows():this.parent.grid.getDataRows();t=e.isFrozenRight?this.parent.element.querySelector(".e-frozen-right-content").querySelector("tbody"):this.parent.grid.isFrozenGrid()?(e.isMovable,this.parent.grid.getContent().querySelector("tbody")):this.parent.getContent().querySelector("tbody"),this.parent.frozenRows&&(t=e.isFrozenRows&&"add"!==this.parent.grid.infiniteScrollModule.requestType||!e.isFrozenRows&&"add"===this.parent.grid.infiniteScrollModule.requestType?this.parent.grid.isFrozenGrid()?e.isMovable?this.parent.grid.getHeaderContent().querySelector("tbody"):e.isFrozenRight?this.parent.element.querySelector(".e-frozen-right-header").querySelector("tbody"):this.parent.grid.getHeaderContent().querySelector("tbody"):this.parent.getHeaderContent().querySelector("tbody"):t);for(var l="addRowIndex",p=this.parent.editModule[""+l],h=0;h<n.length;h++){var c=a.render(n[parseInt(h.toString(),10)],this.parent.grid.getColumns());"save"===i.requestType&&"add"===i.action?-1!==(0,S.getValue)("selectedIndex",this.parent.editModule)&&"Top"!==this.parent.editSettings.newRowPosition?"Below"===this.parent.editSettings.newRowPosition||"Child"===this.parent.editSettings.newRowPosition?(r="after",p+=vt(s[parseInt(p.toString(),10)]).length,"Child"===this.parent.editSettings.newRowPosition&&(p-=1),d[parseInt(p.toString(),10)][""+r](c)):"Above"===this.parent.editSettings.newRowPosition&&(r="before",d[this.parent.editModule[""+l]][""+r](c)):"Bottom"===this.parent.editSettings.newRowPosition?t.appendChild(c):t.insertBefore(c,t.firstElementChild):"delete"===i.requestType&&t.appendChild(c)}e.cancel=!0},e.prototype.destroy=function(){this.removeEventListener()},e}()}}]);
//# sourceMappingURL=1986.js.map